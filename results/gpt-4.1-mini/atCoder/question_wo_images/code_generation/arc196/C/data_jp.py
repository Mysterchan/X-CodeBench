import sys
sys.setrecursionlimit(10**7)
MOD = 998244353

N = int(sys.stdin.readline())
S = sys.stdin.readline().strip()

# Sは長さ2Nで、N個のWとN個のBがある
# 頂点は1から2Nまで
# 辺は i -> i+1 (1 <= i < 2N)
# 追加で、白頂点から黒頂点への辺をN組のペアで追加する
# そのとき、最終的に強連結になるペアの組み合わせ数を求める

# 強連結になる条件を考える
# もとの辺は1->2->3->...->2Nの一本鎖
# 追加の辺は白->黒のペアでN本追加
# 強連結になるためには、任意の頂点から任意の頂点に行ける必要がある
# つまり、逆方向にもパスが存在する必要がある

# 追加の辺は白->黒のみ
# もとの辺は昇順の辺のみ
# 逆方向のパスを作るには、追加の辺で黒->白の逆方向の流れを作る必要がある
# つまり、追加の辺の組み合わせで、白黒の頂点をうまくマッチングし、
# 逆方向のパスを作る必要がある

# 重要な点は、強連結になるためには、
# 追加の辺で白->黒のマッチングが「逆方向の辺の役割」を果たし、
# 1->2->...->2Nの辺と合わせて強連結になること

# 解析:
# 1->2->3->...->2Nの辺は昇順の辺のみ
# 追加の辺は白->黒
# 強連結になるためには、追加の辺の白->黒の辺で
# 黒->白の逆方向のパスを作る必要がある
# つまり、追加の辺のマッチングは「白黒の頂点を順序を考慮してペアにする」必要がある

# ここで、Sの文字列を見て、
# 頂点を白と黒に分けると、白の頂点の番号の列と黒の頂点の番号の列がある
# 追加の辺は白->黒のペアで、N組のペアを作る

# 強連結になる条件は、
# 追加の辺のマッチングが「白の頂点の番号の昇順」と「黒の頂点の番号の昇順」を保つこと
# つまり、白の頂点を昇順に並べたものと、黒の頂点を昇順に並べたものを
# 1対1で対応させる必要がある

# そうでないと、逆方向のパスが作れず強連結にならない

# したがって、強連結になるペアの組み合わせ数は、
# 白の頂点の番号列と黒の頂点の番号列の「順序を保ったマッチング」の数

# これは、Sの文字列を左から見て、
# Wが出たら白の頂点が増え、Bが出たら黒の頂点が増える
# このとき、強連結になるマッチングは、
# 「白の頂点と黒の頂点を順序を保ってペアにする」方法の数

# これは「括弧列の正当な対応」の数に似ている
# Wを '('、Bを ')' と見て、
# WとBの数は同じなので、
# 強連結になるマッチングの数は、
# Sを '('と')'に置き換えたときの「正しい括弧列の数」

# しかし、Sは任意の順序でWとBが並んでいる
# そのままでは正しい括弧列とは限らない

# そこで、Sを左から見て、
# Wを +1、Bを -1 として累積和を取る
# この累積和が負になることがあれば、
# 強連結になるマッチングは0

# なぜなら、途中で黒の頂点が白の頂点より多いと、
# 順序を保ったマッチングは不可能だから

# 逆に、累積和が0以上で最後に0になるなら、
# 強連結になるマッチングの数は、
# この文字列の「白黒の順序を保ったマッチング」の数であり、
# それは「カタラン数」に対応する

# しかし、Sは任意の順序でWとBが並んでいるので、
# そのままではカタラン数は使えない

# ここで、問題の構造をよく考えると、
# 強連結になるマッチングは、
# 「Sの中でWとBの順序を保ちつつ、白の頂点と黒の頂点をペアにする」
# つまり、Sの中でWとBの位置を使って、
# 白の頂点の順序と黒の頂点の順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」
# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# つまり、Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数

# これは「Sの中でWとBの位置を使って、白黒の頂点をペアにする順序を保ったマッチングの数」

# これは「Sの中でWとBの位置を