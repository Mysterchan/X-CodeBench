def main():
    import sys
    input = sys.stdin.readline

    N = int(input())
    A = list(map(int, input().split()))

    # The operation: choose L,R and replace A_L,...,A_R with A_L.
    # We want to count how many distinct sequences can result.

    # Key insight:
    # After the operation, the sequence differs from the original only in the segment [L,R],
    # which is replaced by A_L.
    #
    # So the resulting sequence is:
    # prefix (unchanged) + [A_L repeated (R-L+1) times] + suffix (unchanged)
    #
    # Different sequences arise from different choices of (L,R).
    #
    # We want to count distinct sequences after the operation.
    #
    # Let's analyze:
    #
    # For fixed L, the replaced segment is from L to R, all equal to A_L.
    # The suffix after R remains unchanged.
    #
    # So the resulting sequence is:
    # A[0..L-2], then A_L repeated (R-L+1) times, then A[R..N-1]
    #
    # Different R values for fixed L produce different sequences if the suffix A[R..N-1] differs.
    #
    # So for fixed L, the number of distinct sequences is the number of distinct suffixes starting at positions R >= L.
    #
    # But since the replaced segment is all A_L, the only difference in sequences for fixed L is the suffix starting at R.
    #
    # So for each L, the number of distinct sequences is equal to the number of distinct suffixes starting at positions >= L.
    #
    # But suffixes starting at different positions can be the same sequence if the suffixes are equal.
    #
    # To count distinct sequences, we can consider all pairs (L,R) with 1 <= L <= R <= N.
    #
    # The total number of sequences is the number of distinct sequences generated by all such pairs.
    #
    # Another approach:
    #
    # Let's consider the set of all sequences generated by the operation.
    #
    # For each pair (L,R), the resulting sequence is:
    # prefix: A[0..L-2]
    # replaced segment: A_L repeated (R-L+1) times
    # suffix: A[R..N-1]
    #
    # So the sequence is uniquely determined by (L,R).
    #
    # But some pairs (L,R) may produce the same sequence.
    #
    # When do two pairs (L1,R1) and (L2,R2) produce the same sequence?
    #
    # They produce the same sequence if:
    # - prefix up to L1-1 equals prefix up to L2-1 (which is only possible if L1=L2)
    # - replaced segment is the same (A_{L1} = A_{L2})
    # - suffix from R1+1 equals suffix from R2+1
    #
    # Since prefix depends on L, sequences with different L differ in prefix.
    #
    # So sequences with different L are always different.
    #
    # For fixed L, sequences differ only by suffix starting at R+1.
    #
    # So for fixed L, the number of distinct sequences is the number of distinct suffixes starting at positions R+1 >= L+1.
    #
    # For R from L to N, suffix start positions are from L+1 to N+1 (N+1 means empty suffix).
    #
    # So for fixed L, the number of distinct suffixes starting at positions from L+1 to N+1.
    #
    # The empty suffix (position N+1) is always the same (empty).
    #
    # So for fixed L, number of distinct suffixes starting at positions >= L+1.
    #
    # We can precompute the number of distinct suffixes starting at each position.
    #
    # Then sum over L the number of distinct suffixes starting at positions >= L+1.
    #
    # But we must also consider the replaced segment: it is A_L repeated.
    #
    # The replaced segment is always uniform with value A_L.
    #
    # So sequences with different L are different because prefix differs.
    #
    # So total distinct sequences = sum over L of (number of distinct suffixes starting at positions >= L+1)
    #
    # plus the sequences where L=R (segment length 1), which is included in above.
    #
    # Also, the operation must be performed exactly once, so the original sequence is included when L=R=N (replace last element with itself).
    #
    # So total distinct sequences = sum over L=1 to N of (number of distinct suffixes starting at positions >= L+1)
    #
    # plus the sequences where replaced segment length is 1 (which is included).
    #
    # Wait, the suffix starting at N+1 is empty suffix, which is one distinct suffix.
    #
    # So for L=N, suffix starting at N+1 is empty suffix, count=1.
    #
    # So for each L, number of distinct suffixes starting at positions >= L+1 is equal to the number of distinct suffixes starting at positions from L+1 to N+1.
    #
    # We can precompute the number of distinct suffixes starting at each position using a suffix automaton or suffix array.
    #
    # But N can be up to 10^6, so suffix automaton or suffix array is feasible.
    #
    # Let's use suffix array and LCP to count distinct suffixes.
    #
    # Number of distinct substrings = N*(N+1)/2 - sum of LCP array
    #
    # Number of distinct suffixes = N (all suffixes are distinct)
    #
    # But we want number of distinct suffixes starting at positions >= p.
    #
    # So we want to count distinct suffixes starting at positions >= p.
    #
    # Since suffixes are all distinct, the number of distinct suffixes starting at positions >= p is N - p + 1.
    #
    # So for each L, number of distinct suffixes starting at positions >= L+1 is N - (L+1) + 1 = N - L.
    #
    # So total distinct sequences = sum_{L=1}^N (N - L) = sum_{k=0}^{N-1} k = (N-1)*N/2
    #
    # But this contradicts the sample input 1:
    # N=4
    # Output=4
    # Our formula gives (4-1)*4/2=3*4/2=6
    #
    # So our assumption that all suffixes are distinct is wrong.
    #
    # Because the suffixes can be equal if the sequence has repeated patterns.
    #
    # So we need to count distinct suffixes starting at positions >= p.
    #
    # Let's try a different approach:
    #
    # The problem is that sequences differ by prefix, replaced segment, and suffix.
    #
    # But the replaced segment is uniform with value A_L.
    #
    # So sequences differ if:
    # - L differs (prefix differs)
    # - or suffix differs
    #
    # So total distinct sequences = number of pairs (L,R) with distinct resulting sequences.
    #
    # Since prefix depends on L, sequences with different L are different.
    #
    # For fixed L, sequences differ by suffix starting at R+1.
    #
    # So for fixed L, number of distinct sequences = number of distinct suffixes starting at positions >= L+1.
    #
    # So total distinct sequences = sum over L=1 to N of (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length is 1 (R=L), suffix starting at L+1.
    #
    # The suffix starting at N+1 is empty suffix, which is one distinct suffix.
    #
    # So we need to count distinct suffixes starting at positions >= p for all p.
    #
    # Let's build suffix array and LCP array.
    #
    # Number of distinct suffixes starting at position p is 1 (the suffix itself).
    #
    # But suffixes can be equal if the sequence has repeated suffixes.
    #
    # Actually, suffixes are always distinct because suffixes start at different positions.
    #
    # So number of distinct suffixes starting at positions >= p is N - p + 1.
    #
    # So total distinct sequences = sum_{L=1}^N (N - (L+1) + 1) = sum_{L=1}^N (N - L) = (N-1)*N/2
    #
    # But sample input 1 gives 4, not 6.
    #
    # So our assumption that sequences with different L are always different is wrong.
    #
    # Because the replaced segment is A_L repeated, and prefix is A[0..L-2].
    #
    # If prefix is the same and replaced segment is the same and suffix is the same, sequences are same.
    #
    # So sequences with different L can be same if prefix and replaced segment and suffix are same.
    #
    # So sequences are uniquely identified by:
    # - prefix A[0..L-2]
    # - replaced segment: A_L repeated
    # - suffix A[R..N-1]
    #
    # So sequences are uniquely identified by (prefix, replaced segment value, suffix).
    #
    # So sequences with different L can be same if prefix is same and replaced segment value is same and suffix is same.
    #
    # But prefix depends on L, so prefix is different for different L.
    #
    # So sequences with different L are different.
    #
    # So total distinct sequences = sum over L of number of distinct suffixes starting at positions >= L.
    #
    # Wait, suffix starts at R+1, R >= L, so suffix start positions >= L+1.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), suffix starting at L+1.
    #
    # The suffix starting at N+1 is empty suffix.
    #
    # So for L=N, suffix starting at N+1 is empty suffix.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L).
    #
    # But R=L means suffix starting at L+1, which is included in above sum.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R=L), which is included.
    #
    # So total distinct sequences = sum_{L=1}^N (number of distinct suffixes starting at positions >= L+1)
    #
    # plus sequences where replaced segment length = 1 (R