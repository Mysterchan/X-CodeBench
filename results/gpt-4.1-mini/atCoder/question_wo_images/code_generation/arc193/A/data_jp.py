import sys
sys.setrecursionlimit(10**7)
input = sys.stdin.readline

N = int(input())
W = list(map(int, input().split()))
LR = [tuple(map(int, input().split())) for _ in range(N)]
Q = int(input())
queries = [tuple(map(int, input().split())) for _ in range(Q)]

# 頂点 i の区間 [L_i, R_i]
# グラフの辺は区間が共通部分を持たない頂点間に張られる
# つまり、区間が重ならない頂点同士が隣接

# ここで重要なのは、区間が重ならない頂点同士が隣接するということ。
# 逆に言うと、区間が重なる頂点同士は辺がない。

# したがって、グラフの連結成分は区間の重なりによって決まる。
# 区間の重なりで連結成分を作ると、同じ連結成分内の頂点は区間が重なっているか、
# それを介して重なっている区間が連結している。

# つまり、区間の重なりで連結成分を作ると、
# その連結成分内の頂点は互いにパスが存在し、
# 連結成分間はパスが存在しない。

# したがって、まず区間の重なりで連結成分を求める。

# 連結成分ごとに頂点の重みの合計を求める。
# 連結成分内の任意の2頂点間のパスの重みの最小値は、
# その連結成分内の頂点全ての重みの合計になる。

# なぜなら、辺は区間が重ならない頂点間に張られるので、
# パス上の頂点は区間が重ならない頂点の集合である。
# しかし、連結成分は区間が重なる頂点の集合であるため、
# 連結成分内の頂点は区間が重なっている。
# つまり、パス上の頂点は区間が重ならない頂点の集合であるが、
# 連結成分は区間が重なる頂点の集合なので、
# 連結成分内のパスは存在しない？ 矛盾？

# 問題文をよく読むと、
# 辺は区間が共通部分を持たない頂点間に張られる。
# つまり、区間が重ならない頂点同士が隣接。
# 連結成分は区間が重ならない頂点の集合で構成される。

# つまり、区間が重ならない頂点同士が辺で繋がるので、
# 連結成分は区間が重ならない頂点の集合である。

# したがって、区間が重なる頂点は同じ連結成分にはならない。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# ここで区間が重ならない頂点同士が辺で繋がるので、
# 連結成分は区間が重ならない頂点の集合であり、
# その中でパスが存在する。

# つまり、連結成分は区間が重ならない頂点の集合で、
# その中でパスが存在する。

# したがって、連結成分は区間が重ならない頂点の集合で、
# その中でパスが存在する。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# ここで区間が重ならない頂点同士が辺で繋がるので、
# 連結成分は区間が重ならない頂点の集合である。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# したがって、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重ならない頂点同士が連結成分を作る。

# つまり、区間が重なら