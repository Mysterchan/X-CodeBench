import sys
import threading
from collections import deque

def main():
    input = sys.stdin.readline
    T = int(input())
    # 合計nが10^6を超えるので高速化のためsys.setrecursionlimitも設定
    sys.setrecursionlimit(10**7)

    for _ in range(T):
        n, st = map(int, input().split())
        w = list(map(int, input().split()))
        g = [[] for __ in range(n)]
        for __ in range(n-1):
            u,v = map(int, input().split())
            u -= 1
            v -= 1
            g[u].append(v)
            g[v].append(u)

        # 根1は頂点0
        # 根からの距離を求める
        dist_root = [-1]*n
        dist_root[0] = 0
        q = deque([0])
        while q:
            u = q.popleft()
            for nx in g[u]:
                if dist_root[nx] == -1:
                    dist_root[nx] = dist_root[u] + 1
                    q.append(nx)

        # 各頂点uについて、uが溶岩に浸水するのは時間 t >= dist_root[u]
        # 時間tにいる頂点uはt <= dist_root[u]-1でなければならない

        # BFSで距離を求める（移動回数を状態に含める）
        # 状態: (頂点, 時間)
        # 時間は移動回数に等しい（0スタートで移動回数=0の時点でstにいる）
        # 各時刻tに頂点uにいるとき、Sは初期1にw[st]を含めてt+1回w[u]を加算したもの
        # ただし、Sは移動前に加算されるので、t=0の時点でS=1 + w[st]
        # 以降、t回移動した時点でS = 1 + sum of w along path of length t+1 (頂点数はt+1)
        # しかし、経路は自由に選べるので、Sの最大値を求める問題ではない
        # ここで重要なのは、Sが0にならず、かつ溶岩に浸水していない頂点にいること

        # つまり、時間tに頂点uにいるとき、
        # 1) t <= dist_root[u]-1 (溶岩に浸水していない)
        # 2) S > 0
        # Sは初期1、時間0でw[st]を加算し、以降毎回w[u]を加算
        # つまり、S = 1 + sum of w along visited vertices (t+1個)
        # ここで、移動は必須なので、t回移動でt+1個の頂点を訪問

        # 問題は、最大移動回数を求めること
        # これは、時間tに頂点uにいる状態でS>0かつt <= dist_root[u]-1を満たす最大tを求める問題

        # BFSで状態管理は無理（nが大きい）
        # DP的に、各頂点uで最大のtを求めるのは難しい

        # ここで、重要なことは、Sは1から始まり、各頂点でw[u]を加算
        # つまり、Sは訪問した頂点のwの和 + 1
        # 0になったら死ぬ

        # つまり、訪問した頂点のwの和は常に >= 0でなければならない

        # さらに、時間tに頂点uにいるとき、t <= dist_root[u]-1
        # つまり、頂点uの距離が根からdなら、t <= d-1

        # これを満たす経路を探す問題

        # ここで、根からの距離dist_root[u]は固定
        # 時間tは移動回数なので、t+1は訪問頂点数

        # つまり、頂点uにt回目の移動で到達したとき、
        # t <= dist_root[u]-1
        # S = 1 + sum(w along path) > 0

        # これらを満たす最大tを求める

        # ここで、根からの距離がdの頂点は時間t <= d-1でなければならない
        # つまり、t+1 <= d

        # つまり、訪問頂点数 <= d

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離がdの頂点は、時間t <= d-1でなければならない
        # つまり、t+1 <= d

        # つまり、訪問頂点数 <= d

        # つまり、訪問頂点数 <= dist_root[u]

        # ここで、訪問頂点数はt+1なので、t+1 <= dist_root[u]

        # つまり、t <= dist_root[u]-1

        # これを満たす頂点uにt回目の移動で到達し、S>0を保つ最大tを求める

        # ここで、Sは1 + sum(w along path)

        # つまり、訪問頂点のwの和 >= 0

        # これを満たす経路を探す

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす経路で、S>0を保つ最大のtを求める

        # ここで、根からの距離dist_root[u]は固定

        # つまり、訪問頂点数 <= dist_root[u]

        # これを満たす