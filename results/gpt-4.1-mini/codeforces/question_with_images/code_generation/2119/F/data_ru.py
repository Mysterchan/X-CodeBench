import sys
import threading
sys.setrecursionlimit(10**7)

def main():
    input = sys.stdin.readline
    T = int(input())
    
    # Для каждого теста:
    # 1) Считаем расстояния до корня (1) - dist[]
    # 2) Запускаем DFS из st, учитывая время t, жизни S, веса w, и лаву (dist[u] <= t)
    #    - В момент t: S += w[u]
    #    - Если S == 0 или dist[u] <= t (затоплена), умираем
    #    - Идем в соседей (t+1)
    # Максимизируем количество перемещений (глубину пути)
    #
    # Чтобы не повторять вычисления, используем мемоизацию по (u, t, S) невозможно из-за S.
    # Но S может быть максимум t+1 (т.к. w_i = ±1, и S начинается с 1).
    # Однако t может быть до n, и S может быть до n, что слишком много.
    #
    # Оптимизация:
    # - S зависит от пути, но мы можем хранить только максимальное количество ходов из u при текущем времени и S.
    # - Но это слишком много.
    #
    # Рассмотрим, что S не может быть меньше 1 (иначе смерть).
    # При каждом шаге S += w[u], w[u] = ±1.
    # Максимальное S не может превышать t+1 (начинается с 1, +1 или -1 каждый шаг).
    #
    # Можно сделать DFS с параметрами (u, t, S), но это слишком дорого.
    #
    # Другой подход:
    # - В момент t вершина u затоплена, если dist[u] <= t.
    # - Значит, максимальное время жизни в вершине u - dist[u]-1.
    # - Мы не можем находиться в вершине u в момент времени >= dist[u].
    #
    # Значит, для вершины u максимальное время, когда мы можем в ней находиться: dist[u]-1.
    #
    # В момент t в вершине u:
    #   S += w[u]
    #   Если S == 0 или t >= dist[u], смерть.
    #
    # Значит, для вершины u мы можем находиться в ней в моменты времени t < dist[u].
    #
    # Начинаем в st в момент 0, S=1.
    #
    # Задача сводится к поиску максимальной длины пути (число перемещений),
    # где в момент t в вершине u: S(t) > 0, t < dist[u].
    #
    # Можно сделать DFS с параметрами (u, t, S), но это дорого.
    #
    # Попробуем сделать DFS с параметрами (u, S), где t = dist[u] - 1 (максимальное время в u).
    #
    # Но мы можем попасть в u раньше, чем dist[u]-1.
    #
    # Попробуем сделать DFS с параметрами (u, S), где t - время, когда мы пришли в u.
    #
    # Но t растет на 1 при каждом переходе.
    #
    # Можно сделать DFS с параметрами (u, S), где t = dist[u] - 1 (максимальное время в u).
    #
    # Но это не учитывает, что мы можем прийти в u раньше.
    #
    # Попробуем сделать DFS с параметрами (u, S), где t - время, когда мы пришли в u.
    #
    # Но t может быть до n, S может быть до n, слишком много состояний.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни.
    #
    # Но S зависит от пути.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS с параметрами (u, S), где S - текущие жизни, но будем хранить только максимальное количество ходов.
    #
    # Но это тоже слишком много.
    #
    # Попробуем сделать DFS