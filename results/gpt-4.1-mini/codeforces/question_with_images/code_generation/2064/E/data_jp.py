import sys
input = sys.stdin.readline
MOD = 998244353

# 階乗の事前計算
MAX = 2 * 10**5
fact = [1] * (MAX + 1)
for i in range(1, MAX + 1):
    fact[i] = fact[i-1] * i % MOD

t = int(input())
for _ in range(t):
    n = int(input())
    p = list(map(int, input().split()))
    c = list(map(int, input().split()))

    # 重力ソート後の砂の配置は、各列に色が下から詰まる形になる。
    # つまり、p_iの値は列の高さを示し、c_iはその列の色。
    # 重力ソート後の配置は、列ごとに高さp_iの色c_iのブロックが下に詰まった状態。

    # これと同じ配置を作る(p', c')の組み合わせは、
    # 「同じ高さの列は色の並び順を入れ替えても同じ配置になる」ことから、
    # 同じ高さの列の色の並び替えが自由にできる。

    # よって、p_iの高さごとにc_iの色のマルチセットが決まっている。
    # そのため、p_iの高さごとにc_iの色のグループを作り、
    # そのグループ内での色の並び替えが自由にできる。

    # しかしpは順列なので、各高さは1つだけ存在する。
    # よって高さごとに1つの色が対応する。
    # つまり高さごとに色は1つだけ。

    # したがって、重力ソート後の配置は高さごとに色が決まっている。
    # これと同じ配置を作るには、同じ高さの列に同じ色を割り当てる必要がある。

    # つまり、pの高さごとに色の集合が決まっている。
    # これと同じ配置を作る(p', c')は、
    # p'は順列なので、p'の高さごとに色を割り当てる。
    # 同じ高さの列の色の並び替えはできない（高さは一意なので）。

    # したがって、重力ソート後の配置を決めるのは、
    # 高さごとの色の集合の並び順を変えたもの。
    # つまり、cの色の並び順を変えても、
    # 高さごとに色が同じなら同じ配置になる。

    # つまり、cの色の並び順を変えても同じ配置になるのは、
    # cの色の並び順を変えてもcの色の並びが同じになる場合のみ。

    # つまり、cの色の並び順を変えても同じ配置になるのは、
    # cの色の並び順を変えてもcの色の並びが同じ場合のみ。

    # これはつまり、cの色の並び順を変えても同じ配置になるのは、
    # cの色の並び順を変えてもcの色の並びが同じ場合のみ。

    # つまり、cの色の並び順を変えても同じ配置になるのは、
    # cの色の並び順を変えてもcの色の並びが同じ場合のみ。

    # つまり、cの色の並び順を変えても同じ配置になるのは、
    # cの色の並び順を変えてもcの色の並びが同じ場合のみ。

    # つまり、cの色の並び順を変えても同じ配置になるのは、
    # cの色の並び順を変えてもcの色の並びが同じ場合のみ。

    # つまり、cの色の並び順を変えても同じ配置になるのは、
    # cの色の並び順を変えてもcの色の並びが同じ場合のみ。

    # つまり、cの色の並び順を変えても同じ配置になるのは、
    # cの色の並び順を変えてもcの色の並びが同じ場合のみ。

    # つまり、cの色の並び順を変えても同じ配置になるのは、
    # cの色の並び順を変えてもcの色の並びが同じ場合のみ。

    # つまり、cの色の並び順を変えても同じ配置になるのは、
    # cの色の並び順を変えてもcの色の並びが同じ場合のみ。

    # つまり、cの色の並び順を変えても同じ配置になるのは、
    # cの色の並び順を変えてもcの色の並びが同じ場合のみ。

    # つまり、cの色の並び順を変えても同じ配置になるのは、
    # cの色の並び順を変えてもcの色の並びが同じ場合のみ。

    # つまり、cの色の並び順を変えても同じ配置になるのは、
    # cの色の並び順を変えてもcの色の並びが同じ場合のみ。

    # つまり、cの色の並び順を変えても同じ配置になるのは、
    # cの色の並び順を変えてもcの色の並びが同じ場合のみ。

    # ここで、pは順列なので、p_iは1からnまでの異なる値。
    # 重力ソート後の配置は、列jに高さh_jのブロックが積まれ、
    # その高さh_jの色はc_iである（iはp_i = jの位置）。

    # つまり、重力ソート後の配置は、列jの高さh_j = p_iで、
    # その列の色はc_i。

    # これを逆に考えると、重力ソート後の配置は、
    # 高さhの列の色はc_iである（iはp_i = hの位置）。

    # したがって、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]である（posはpの逆写像）。

    # つまり、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置を作る(p', c')は、
    # p'は順列なので、p'_iは1からnまでの異なる値。
    # 重力ソート後の配置は、
    # 高さhの列の色はc'[pos'[h]]。

    # これが同じ配置になるためには、
    # 高さhの列の色はc[pos[h]] = c'[pos'[h]]。

    # つまり、c'[pos'[h]] = c[pos[h]]。

    # ここで、p'の逆写像pos'はp'の位置を高さで示す。

    # つまり、c'はcの並び替えである。

    # したがって、c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替え（順列）で、
    # c'はcの並び替え（配列）である。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び替えなので、
    # cの色の頻度ごとに並び替えが制限される。

    # しかし、重力ソート後の配置は、
    # 高さhの列の色はc[pos[h]]。

    # これと同じ配置になるためには、
    # c'はcの並び替えであり、
    # p'はpの並び替えである。

    # つまり、p'とc'の組み合わせは、
    # p'はpの並び替えで、
    # c'はcの並び替えである。

    # しかし、p'は順列なので、
    # p'の並び替えはn!通り。

    # c'はcの並び