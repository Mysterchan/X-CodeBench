ll z=sqrt(M/p[i]);  // Should be sqrt(x/p[i]), not sqrt(M/p[i])