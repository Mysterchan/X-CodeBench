import sys
sys.setrecursionlimit(10**7)
MOD = 998244353

N = int(sys.stdin.readline())
A = list(map(int, sys.stdin.readline().split()))

# 問題の条件を満たす良い数列B=(B_1,...,B_N)は、
# 任意の区間[l,r]に対して、あるx (l ≤ x ≤ r) が存在し、
# 頂点l,...,rのうちx以外の頂点iとB_iの間に辺を張るとき、
# 頂点l,...,rが木（連結かつ辺数=頂点数-1）になる。

# 解析:
# B_iは1以上N以下の整数。
# 条件から、区間[l,r]でxを根とした木ができる。
# つまり、区間[l,r]の頂点のうちx以外の頂点iはB_iが区間内の頂点で、
# かつB_iはxを根とする木の親である。

# これは「区間ごとに根が1つ存在し、その根以外は根に向かう木構造を作る」ことを意味する。
# さらに、B_iは区間内の頂点を指す必要がある。

# 重要な性質:
# - B_xは区間外でもよい（xは辺を張らないのでB_xは無視）
# - 区間内の他の頂点iはB_iが区間内の頂点である必要がある。

# これを満たすBは「区間ごとに根が1つあり、他は根に向かう木構造」。
# つまり、Bは「区間ごとに根を持つ木の親配列」である。

# さらに、区間が1つの頂点だけのときは自明に良い。

# ここで、B_iは1以上N以下の整数かつB_i != i（i以外の頂点は親を持つ）。
# ただし、xは親を持たない（辺を張らない）のでB_xは無視。

# これを満たすBは「区間ごとに根が1つ存在し、他は根に向かう木構造」。
# つまり、Bは「区間ごとに根を持つ木の親配列」である。

# さらに、A_iは-1か1以上N以下の整数で与えられ、
# -1の部分を1以上N以下の整数に置き換える。

# ここで、B_iは区間内の頂点を指す必要があるため、
# B_iはiの属する区間の根か、区間内の他の頂点でなければならない。

# しかし、区間は任意の[l,r]で条件を満たす必要があるため、
# B_iはiより小さいか同じか、またはiより大きいか同じかの制約がある。

# 解析を簡単にするために、問題の解説や既知の解法を参考にすると、
# この問題は「B_iがiより小さいか同じか、またはiより大きいか同じかの制約を満たす」
# という条件を満たす「良い数列」の数を求める問題である。

# 実は、この問題は「B_iがiより小さいか同じか、またはiより大きいか同じかの制約を満たす」
# という条件を満たす数列の数を求める問題であり、
# それは「B_iがiより小さいか同じか、またはiより大きいか同じかの制約を満たす」
# という条件を満たす数列の数を求める問題である。

# ここで、B_iはiより小さいか同じか、またはiより大きいか同じかの制約を満たす。
# つまり、B_iはi以下かi以上のどちらかである。

# これを満たす数列の数を求める。

# さらに、A_iが-1のところは1..Nのどれかに置き換える。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iはi以下の値かi以上の値のどちらか。

# これを満たす数列の数を求める。

# これを満たす数列の数を求める。

# ここで、B_iはi以下かi以上のどちらかである。
# つまり、B_iは