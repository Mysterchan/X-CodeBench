import sys
input = sys.stdin.readline

T = int(input())
for _ in range(T):
    N = int(input())
    A = list(map(int, input().split()))
    B = list(map(int, input().split()))

    # Быстрая проверка: если суммы не равны, ответ No
    if sum(A) != sum(B):
        print("No")
        continue

    # Если A == B, ответ Yes
    if A == B:
        print("Yes")
        continue

    # Если сумма == 0, то все нули, A == B уже проверено, значит No
    if sum(A) == 0:
        print("No")
        continue

    # Если сумма == N, то все единицы, A == B уже проверено, значит No
    if sum(A) == N:
        print("No")
        continue

    # Теперь рассмотрим случай, когда 0 < sum(A) < N
    # В этом случае можно переставлять блоки с равным количеством единиц.
    # Операция позволяет менять местами любые два подотрезка с одинаковым количеством единиц.
    # Это значит, что мы можем переставлять блоки с одинаковым количеством единиц в любом порядке.

    # Рассмотрим разбиение A и B на блоки, разделённые нулями:
    # Но проще: так как мы можем менять местами подотрезки с равным количеством единиц,
    # то можно переставлять блоки с одинаковым количеством единиц в любом порядке.
    # Значит, можно переставлять любые подотрезки с одинаковым количеством единиц.

    # Следовательно, можно добиться любой перестановки, если:
    # - количество единиц в A и B совпадает (уже проверено)
    # - и в A и B есть хотя бы одна 0 и хотя бы одна 1 (уже проверено)
    # Тогда ответ Yes.

    print("Yes")