{
    "Title": "ユニークビジョンプログラミングコンテスト2025 夏（AtCoder Beginner Contest 411）",
    "Source": "atcoder",
    "Name": "Contraction",
    "Time Limit": "4 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "N 頂点 M 辺の無向グラフ G_0 が与えられます。\nG_0 の頂点および辺は、それぞれ頂点 1, 頂点 2, ..., 頂点 N および辺 1, 辺 2, ..., 辺 M と番号づけられており、\n辺 i (1≤ i≤ M) は頂点 U_i と頂点 V_i を結んでいます。\n高橋君はグラフ G と、駒 1, 駒 2, ..., 駒 N と番号づけられた N 個の駒を持っています。\n最初、G=G_0 であり、さらに G の頂点 i (1≤ i≤ N) には駒 i が置かれています。\n高橋君はこれから Q 回の操作を順に行います。\ni 回目 (1≤ i≤ Q) の操作では 1 以上 M 以下の整数 X_i が与えられ、次の操作を行います。\nG において駒 U_{X_i} と駒 V_{X_i} が異なる頂点に置かれており、\nそれらの間に（ G 上の）辺 e が存在するならばその辺を縮約したグラフ G' を作成する。\nこの際、自己ループができた場合は取り除き、多重辺が存在した場合は単純辺に置き換える。 \nその後、G において辺 e が結んでいた 2 頂点に置かれていた駒はすべて、G' の e の縮約によって新たに生成された頂点に置く。\nG 上のその他の頂点に置かれていた駒については、G' の対応する頂点に置く。\n最後に、このようにしてできた G' を新たな G とする。\n駒 U_{X_i} と駒 V_{X_i} が同じ頂点に置かれていた場合、あるいは置かれている頂点の間が辺で結ばれていなかった場合は何も行わない。\ni=1,2,..., Q 回目の操作それぞれについて、i 回目の操作の後の G の辺の数を出力してください。\n辺の縮約 とは\n頂点 u と頂点 v を結ぶ辺の縮約とは、頂点 u,v を 1 つの頂点にまとめる操作です。 \nより正確には、G に対して辺の縮約を行なって得られるグラフとは G に対して次の操作を行って得られるものを指します。\n\n- G に新たに頂点 w を追加する。\n- G 上の u,v 以外の各頂点 x について、u と x を結ぶ辺、あるいは v と x を結ぶ辺の少なくとも一方が存在するとき、かつその時に限り、w と x を結ぶ辺を加える。\n- 頂点 u,v を削除し、頂点 u と v を結ぶ辺および頂点 u または v と他の頂点を結ぶ辺をすべて削除する。",
    "Statement Images": [],
    "Constraints": "- 2≤ N≤ 3\\times 10^5\n- 1≤ M≤ 3\\times 10^5\n- 1≤ U_i<V_i≤ N\n- i\\neq j ならば (U_i,V_i)\\neq (U_j,V_j)\n- 1≤ Q≤ 3\\times 10^5\n- 1≤ X_i≤ M\n- 入力はすべて整数",
    "IO Styles": "入力\n入力は以下の形式で標準入力から与えられる。\nN M\r\nU_1 V_1\r\nU_2 V_2\r\n\\vdots\r\nU_M V_M\r\nQ\r\nX_1 X_2 ... X_Q\r\n出力\nQ 行出力せよ。\r\ni 行目 (1≤ i≤ Q) には、i 回目の操作の後の G の辺の数を出力せよ。",
    "Sample Detail": [
        {
            "input": "7 7\n1 2\n1 3\n2 3\n1 4\n1 5\n2 5\n6 7\n5\n1 2 3 1 5\n",
            "output": "4\n3\n3\n3\n2\n",
            "explanation": "最初、G は下図のようになっています。丸付き数字はその番号の駒を表します。\n\n![image](1.png)\n\n1 回目の操作では、駒 1 と駒 2 が置かれている頂点の間の辺（下図左）の縮約を行います。\r\n操作後、G は下図右のようになり、特に辺の数は 4 です。\r\n自己ループの削除および多重辺の単純辺への置換が行われていることに注意してください。\n\n![image](2.png)\n\n2 回目の操作では、駒 1 と駒 3 が置かれている頂点の間の辺の縮約を行います。\r\n操作後、G は下図左のようになり、辺の数は 3 となります。\n3 回目の操作では、駒 2 と駒 3 は同じ頂点に置かれているため、G はそのままであり、辺の数も 3 のままです。\n4 回目の操作でも、駒 1 と駒 2 は同じ頂点に置かれているため、G はそのままであり、辺の数も 3 のままです。 \n5 回目の操作では、駒 1 と駒 5 が置かれている頂点の間の辺の縮約を行います。\r\n操作後、G は下図右のようになり、辺の数は 2 となります。 \n\nよって、4,3,3,3,2 をこの順に改行区切りで出力します。\n\n![image](3.png)",
            "images": [
                "https://img.atcoder.jp/abc411/9469e5c08fdb8fb3b5da9f88dc121dec.png",
                "https://img.atcoder.jp/abc411/412aba64d94291e89c051b3c547e4c29.png",
                "https://img.atcoder.jp/abc411/c176efe296aa93c69cfb48c793c8bb64.png"
            ]
        }
    ],
    "Language": "jp"
}