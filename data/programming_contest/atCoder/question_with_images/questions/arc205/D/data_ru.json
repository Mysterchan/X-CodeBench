{
    "Title": "AtCoder Regular Contest 205 (Div. 2)",
    "Source": "atcoder",
    "Name": "Non-Ancestor Matching",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "Вам дано корневое дерево с N вершинами, номерами от 1 до N. Вершина 1 является корнем, а родителем вершины i (2 ≤ i ≤ N) является вершина p_i (1 ≤ p_i < i). Изначально все вершины окрашены в белый цвет. \nВы можете выполнять следующую последовательность операций ноль или более раз. \n- Выберите пару целых чисел (u,v), которая удовлетворяет всем следующим условиям:\n- 1 ≤ u < v ≤ N\n- Обе вершины u и v окрашены в белый цвет.\n- u не является предком v.\n- Окрасьте вершины u и v в черный цвет.\nЗдесь \"u не является предком v\" означает, что вы не можете добраться до вершины u из вершины v, сколько бы раз вы ни выполняли операцию перемещения к родительской вершине текущей вершины.\nНайдите максимальное количество операций, которые вы можете выполнить, когда вы выполняете операции в соответствующем порядке.\nВам даны T тестов, поэтому найдите ответ для каждого из них.",
    "Statement Images": [],
    "Constraints": "- $1≤ T≤ 5\\times 10^4$\n- $2≤ N≤ 5\\times 10^5$\n- $1≤ p_i < i$\n- Сумма $N$ по всем тестовым случаям не превышает $5\\times 10^5$.\n- Все входные значения являются целыми числами.",
    "IO Styles": "Входные данные\nВходные данные предоставляются из стандартного ввода в следующем формате:\nT\n\\text{case}_1\n\\text{case}_2\n\\vdots\n\\text{case}_T\nКаждый набор входных данных \\text{case}_i представлен в следующем формате:\nN\np_2 p_3 ... p_N\nВыходные данные\nВыведите T строк.\ni-я строка (1≤ i≤ T) должна содержать ответ для i-го тестового случая.",
    "Sample Detail": [
        {
            "input": "4\n6\n1 2 2 2 5\n7\n1 2 3 4 5 6\n7\n1 2 3 4 2 4\n12\n1 1 2 2 2 4 4 4 7 7 7\n",
            "output": "2\n0\n2\n5\n",
            "explanation": "Рассмотрим первый набор тестовых данных.\n\n![image](1.png)\n\nВы можете выполнить две операции следующим образом.\n\n- Выберите (u,v)=(3,5). Закрасьте вершины 3 и 5 в черный цвет.\n- Выберите (u,v)=(4,6). Закрасьте вершины 4 и 6 в черный цвет.\n\nВы не можете выполнить более двух операций, поэтому выведите 2 в первой строке.",
            "images": [
                "https://img.atcoder.jp/arc205/6734339acfecc9c4c7ae80a268dda726.png"
            ]
        }
    ],
    "Language": "ru"
}