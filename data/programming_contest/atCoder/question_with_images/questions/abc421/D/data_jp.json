{
    "Title": "AtCoder Beginner Contest 421",
    "Source": "atcoder",
    "Name": "RLE Moving",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "無限に広いグリッドがあります。グリッドのあるマスはマス (0,0) と名前がついています。\nマス (0,0) から下に r マス、右に c マスの移動した位置にあるマスをマス (r,c) と呼びます。\nここで、「下に r マス移動する」は r が負のときは「上に |r| マス移動する」ことを表し、「右に c マス移動する」は c が負のときには「左に |c| マス移動する」ことを表すものとします。\n具体的には、マス (0,0) の周辺にあるマスは以下のようになります。\n![image](1.png)\n最初、高橋君はマス (R_t,C_t) に、青木君はマス (R_a,C_a) にいます。二人はそれぞれ U,D,L,R からなる長さ N の文字列 S,T に従って N 回移動を行います。\n各 i について、高橋君と青木君の i 回目の移動は同時に行われます。具体的には、高橋君は S の i 文字目が U のとき上、D のとき下、L のとき左、R のとき右へ 1 マス移動し、青木君は T の i 文字目によって同様に移動します。\nN 回の移動の中で、移動直後に高橋君と青木君が同じマスにいた回数を求めてください。\nただし、N は非常に大きいため S,T は ( (S'_1, A_1),...(S'_M,A_M) ), ( (T'_1,B_1),...,(T'_L,B_L) ) の形で与えられ、 S は「文字 S'_1 を A_1 個、\\dots、文字 S'_M を A_M 個」をこの順に連結した文字列であり、T も同様です。",
    "Statement Images": [
        "https://img.atcoder.jp/abc421/550057ef5ef7d5545bf82cc405541482.png"
    ],
    "Constraints": "- -10^9 ≤ R_t,C_t,R_a,C_a ≤ 10^9\n- 1≤ N ≤ 10^{14}\n- 1≤ M,L ≤ 10^5\n- S'_i,T'_i は U, D, L, R のいずれか\n- 1 ≤ A_i,B_i ≤ 10^9\n- A_1+\\dots+A_M=B_1+\\dots+B_L=N\n- 与えられる数値は全て整数",
    "IO Styles": "入力\n入力は以下の形式で標準入力から与えられる。\nR_t C_t R_a C_a\nN M L\nS'_1 A_1\n\\vdots\nS'_M A_M\nT'_1 B_1\n\\vdots\nT'_L B_L\n出力\n答えを出力せよ。",
    "Sample Detail": [
        {
            "input": "0 0 4 2\n3 2 1\nR 2\nD 1\nU 3\n",
            "output": "1\n",
            "explanation": "このケースでは S= RRD、T= UUU であり、移動は次のように行われます。\n\n- 最初、高橋君はマス (0,0) に、青木君はマス (4,2) にいる。\n- 1 回目の移動後、高橋君はマス (0,1)、青木君はマス (3,2) にいる。\n- 2 回目の移動後、高橋君はマス (0,2)、青木君はマス (2,2) にいる。\n- 3 回目の移動後、高橋君はマス (1,2)、青木君はマス (1,2) にいる。\n\n\nよって、高橋君と青木君が移動直後に同じマスにいた回数は 1 です。",
            "images": []
        },
        {
            "input": "1000000000 1000000000 -1000000000 -1000000000\n3000000000 3 3\nL 1000000000\nU 1000000000\nU 1000000000\nD 1000000000\nR 1000000000\nU 1000000000\n",
            "output": "1000000001\n",
            "explanation": "2000000000 回目の移動から 3000000000 回目の移動までの 1000000001 回で高橋君と青木君は移動直後に同じマスにいます。",
            "images": []
        },
        {
            "input": "3 3 3 2\n1 1 1\nL 1\nR 1\n",
            "output": "0\n",
            "explanation": "",
            "images": []
        },
        {
            "input": "0 0 0 0\n1 1 1\nL 1\nR 1\n",
            "output": "0\n",
            "explanation": "",
            "images": []
        }
    ],
    "Language": "jp"
}