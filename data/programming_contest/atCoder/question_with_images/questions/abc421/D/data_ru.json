{
    "Title": "AtCoder Beginner Contest 421",
    "Source": "atcoder",
    "Name": "RLE Moving",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "Существует бесконечно большая сетка. Одна ячейка сетки называется ячейкой (0,0).\nЯчейка, расположенная на r ячеек вниз и c ячеек вправо от ячейки (0,0), называется ячейкой (r,c).\nЗдесь \"r ячеек вниз\" означает \"|r| ячеек вверх\", когда r отрицательно, а \"c ячеек вправо\" означает \"|c| ячеек влево\", когда c отрицательно.\nВ частности, ячейки вокруг ячейки (0,0) выглядят следующим образом:\n![image](1.png)\nСначала Такахаши находится в ячейке (R_t,C_t), а Аоки — в ячейке (R_a,C_a). Каждый из них сделает N ходов в соответствии со строками S и T длины N, состоящими из символов U, D, L, R.\nДля каждого i, i-й ход Такахаши и i-й ход Аоки происходят одновременно: Такахаши двигается на одну ячейку вверх, если i-й символ строки S — U, вниз, если D, влево, если L, и вправо, если R; Аоки движется аналогично, исходя из i-го символа строки T.\nНайдите количество раз, когда Такахаши и Аоки оказываются в одной и той же ячейке сразу после хода в течение N ходов.\nПоскольку N очень велико, строки S и T заданы в форме ((S'_1, A_1),...,(S'_M,A_M)) и ((T'_1,B_1),...,(T'_L,B_L)), где S — это строка, полученная конкатенацией \"A_1 копий символа S'_1, \\dots, A_M копий символа S'_M\" в этом порядке, а T задана аналогично.",
    "Statement Images": [
        "https://img.atcoder.jp/abc421/550057ef5ef7d5545bf82cc405541482.png"
    ],
    "Constraints": "- -10^9 ≤ R_t,C_t,R_a,C_a ≤ 10^9\n- 1≤ N ≤ 10^{14}\n- 1≤ M,L ≤ 10^5\n- Каждый из S'_i и T'_i равен одному из U, D, L, R.\n- 1 ≤ A_i,B_i ≤ 10^9\n- A_1+\\dots+A_M=B_1+\\dots+B_L=N\n- Все заданные значения являются целыми числами.",
    "IO Styles": "Входные данные\nВходные данные подаются из стандартного ввода в следующем формате:\nR_t C_t R_a C_a\nN M L\nS'_1 A_1\n\\vdots\nS'_M A_M\nT'_1 B_1\n\\vdots\nT'_L B_L\nВыходные данные\nНапечатайте ответ.",
    "Sample Detail": [
        {
            "input": "0 0 4 2\n3 2 1\nR 2\nD 1\nU 3\n",
            "output": "1\n",
            "explanation": "В этом случае, S= RRD и T= UUU, а движения происходят следующим образом:\n\n- Сначала Такаши находится в ячейке (0,0), а Аоки - в ячейке (4,2).\n- После 1-го хода Такаши находится в ячейке (0,1), а Аоки - в ячейке (3,2).\n- После 2-го хода Такаши находится в ячейке (0,2), а Аоки - в ячейке (2,2).\n- После 3-го хода Такаши находится в ячейке (1,2), а Аоки - в ячейке (1,2).\n\nТаким образом, количество раз, когда Такаши и Аоки находятся в одной и той же ячейке непосредственно после хода, равно 1.",
            "images": []
        },
        {
            "input": "1000000000 1000000000 -1000000000 -1000000000\n3000000000 3 3\nL 1000000000\nU 1000000000\nU 1000000000\nD 1000000000\nR 1000000000\nU 1000000000\n",
            "output": "1000000001\n",
            "explanation": "С 2000000000-го хода по 3000000000-й ход Такахаси и Аоки находятся в одной и той же клетке сразу после хода 1000000001 раз.",
            "images": []
        },
        {
            "input": "3 3 3 2\n1 1 1\nL 1\nR 1\n",
            "output": "0\n",
            "explanation": "",
            "images": []
        },
        {
            "input": "0 0 0 0\n1 1 1\nL 1\nR 1\n",
            "output": "0\n",
            "explanation": "",
            "images": []
        }
    ],
    "Language": "ru"
}