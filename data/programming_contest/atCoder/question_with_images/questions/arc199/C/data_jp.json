{
    "Title": "AtCoder Regular Contest 199 (Div. 1)",
    "Source": "atcoder",
    "Name": "Circular Tree Embedding",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "この問題では，頂点に 1,2,...,N の番号が付けられ，辺に番号が付いていない N 頂点の木を単に N 頂点の木と呼ぶことにします．\nN 頂点の木 T および (1,2,...,N) の順列 Q=(Q_1,Q_2,...,Q_N) が次の条件を満たすとき，順列 Q は木 T の 良い順列 であると呼びます．\n円周上に N 個の点 1,2,...,N がこの順で反時計回りに等間隔で配置されている．木 T の各辺 \\lbrace u,v\\rbrace に対して 2 点 Q_u,Q_v を結ぶ線分を書き込む．このとき，書き込まれた N-1 本の線分のうちどの 2 本を選んでも，それらは端点を除いて共有点を持たない．\nM 個の (1,2,...,N) の順列 P^1=(P^1_1,P^1_2,...,P^1_N),P^2=(P^2_1,P^2_2,...,P^2_N),...,P^M=(P^M_1,P^M_2,...,P^M_N) が与えられます．\nP^1,P^2,...,P^M が全て良い順列となるような N 頂点の木の個数を 998244353 で割った余りを求めて下さい．",
    "Statement Images": [],
    "Constraints": "- 2≤ N,M≤ 500\n- P^1,P^2,...,P^M は (1,2,...,N) の順列\n- 入力は全て整数",
    "IO Styles": "入力\n入力は以下の形式で標準入力から与えられる．\nN M\nP^1_1 P^1_2 ... P^1_N\nP^2_1 P^2_2 ... P^2_N\n\\vdots\nP^M_1 P^M_2 ... P^M_N\n出力\nP^1,P^2,...,P^M が全て良い順列となるような N 頂点の木の個数を 998244353 で割った余りを出力せよ．",
    "Sample Detail": [
        {
            "input": "4 2\n1 4 2 3\n3 1 4 2\n",
            "output": "8\n",
            "explanation": "たとえば以下の 2 つの木に対して，P^1,P^2 はどちらも良い順列です．（青い数字は頂点番号を表しています．）\n\n![image](1.png)\n\n一方，以下の木に対して P^2 は良い順列ではありません．\n\n![image](2.png)\n\nP^1,P^2 がともに良い順列となるような 4 頂点の木は全部で 8 つあります．",
            "images": [
                "https://img.atcoder.jp/arc199/9f18f81fa8fb939d65e4d941450a2dbf.png",
                "https://img.atcoder.jp/arc199/6b602382a1f4bc4e7d6f792c0b2f7d20.png"
            ]
        },
        {
            "input": "12 3\n7 9 1 10 8 12 2 6 11 5 4 3\n8 10 4 12 11 7 6 3 1 2 9 5\n10 4 9 7 5 1 3 11 8 12 6 2\n",
            "output": "540\n",
            "explanation": "",
            "images": []
        }
    ],
    "Language": "jp"
}