{
    "Title": "AtCoder Regular Contest 199 (Div. 1)",
    "Source": "atcoder",
    "Name": "Circular Tree Embedding",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "В этой задаче мы просто называем дерево с N вершинами, пронумерованными 1,2,...,N, и неундированными рёбрами, N-вершинным деревом. Когда N-вершинное дерево T и перестановка Q=(Q_1,Q_2,...,Q_N) из (1,2,...,N) удовлетворяют следующему условию, перестановка Q называется хорошей перестановкой для дерева T:\nСуществуют N точек 1,2,...,N, расположенных против часовой стрелки на окружности на равных интервалах в этом порядке. Для каждого ребра \\lbrace u,v\\rbrace дерева T проведите отрезок, соединяющий две точки Q_u,Q_v. Тогда среди N-1 проведённых отрезков ни два из них не пересекаются, кроме как в их конечных точках.\nВам даны M перестановок из (1,2,...,N): P^1=(P^1_1,P^1_2,...,P^1_N),P^2=(P^2_1,P^2_2,...,P^2_N),...,P^M=(P^M_1,P^M_2,...,P^M_N).\nНайдите количество N-вершинных деревьев, таких что P^1,P^2,...,P^M являются хорошими перестановками, по модулю 998244353.",
    "Statement Images": [],
    "Constraints": "- $2 \\leq N, M \\leq 500$\n- $P^1, P^2, \\ldots, P^M$ — это перестановки последовательности $(1, 2, \\ldots, N)$.\n- Все входные значения — целые числа.",
    "IO Styles": "Входные данные\nВходные данные подаются из стандартного ввода в следующем формате:\nN M\nP^1_1 P^1_2 ... P^1_N\nP^2_1 P^2_2 ... P^2_N\n\\vdots\nP^M_1 P^M_2 ... P^M_N\n\nВыходные данные\nВыведите число, по модулю 998244353, деревьев с N вершинами, таких что P^1,P^2,...,P^M являются всеми хорошими пермутациями.",
    "Sample Detail": [
        {
            "input": "4 2\n1 4 2 3\n3 1 4 2\n",
            "output": "8\n",
            "explanation": "Например, для следующих двух деревьев обе перестановки P^1 и P^2 являются хорошими. (Синие числа представляют номера вершин.)\n\n![image](1.png)\n\nС другой стороны, для следующего дерева перестановка P^2 не является хорошей.\n\n![image](2.png)\n\nВсего существует 8 деревьев с четырьмя вершинами, такие что обе перестановки P^1 и P^2 являются хорошими.",
            "images": [
                "https://img.atcoder.jp/arc199/9f18f81fa8fb939d65e4d941450a2dbf.png",
                "https://img.atcoder.jp/arc199/6b602382a1f4bc4e7d6f792c0b2f7d20.png"
            ]
        },
        {
            "input": "12 3\n7 9 1 10 8 12 2 6 11 5 4 3\n8 10 4 12 11 7 6 3 1 2 9 5\n10 4 9 7 5 1 3 11 8 12 6 2\n",
            "output": "540\n",
            "explanation": "",
            "images": []
        }
    ],
    "Language": "ru"
}