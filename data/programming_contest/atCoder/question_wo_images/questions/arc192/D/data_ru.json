{
    "Title": "AtCoder Regular Contest 192 (Div. 2)",
    "Source": "atcoder",
    "Name": "Fraction Line",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "Для положительного рационального числа x определим f(x) следующим образом:\nПредставьте x в виде \\dfrac{P}{Q}, используя взаимнопростые положительные целые числа P и Q. f(x) определяется как значение P\\times Q.\nВам дано положительное целое число N и последовательность A=(A_1,A_2,\\dots,A_{N-1}) положительных целых чисел длины N-1.\nМы называем последовательность S=(S_1,S_2,\\dots,S_N) положительных целых чисел длины N хорошей последовательностью, если она удовлетворяет всем следующим условиям:\n- Для каждого целого числа i, где 1≤ i≤ N-1, выполняется f\\left(\\dfrac{S_i}{S_{i+1}}\\right)=A_i.\n- \\gcd(S_1,S_2,\\dots,S_N)=1.\nОпределите оценку последовательности как произведение всех её элементов.\nМожно доказать, что существует конечное количество хороших последовательностей. Найдите сумму, по модулю 998244353, оценок всех хороших последовательностей.",
    "Statement Images": [],
    "Constraints": "- 2≤ N≤ 1000\n- 1≤ A_i≤ 1000 (1≤ i≤ N-1)\n- Все входные значения являются целыми числами.",
    "IO Styles": "Входные данные  \nВходные данные подаются через стандартный ввод в следующем формате:  \nN  \nA_1 A_2 \\dots A_{N-1}  \n\nВыходные данные  \nВыведите сумму, по модулю 998244353, оценок всех хороших последовательностей.",
    "Sample Detail": [
        {
            "input": "6\n1 9 2 2 9\n",
            "output": "939634344\n",
            "explanation": "Например, как последовательность (2,2,18,9,18,2), так и (18,18,2,1,2,18) являются хорошими последовательностями, и обе имеют балл 23328.\n\nВсего существует 16 хороших последовательностей, и сумма баллов всех них составляет 939634344.",
            "images": []
        },
        {
            "input": "2\n9\n",
            "output": "18\n",
            "explanation": "Существует 2 хороших последовательности, обе с оценкой 9.",
            "images": []
        },
        {
            "input": "25\n222 299 229 22 999 922 99 992 22 292 222 229 992 922 22 992 222 222 99 29 92 999 2 29\n",
            "output": "192457116\n",
            "explanation": "Не забудьте вычислить сумму по модулю 998244353.",
            "images": []
        }
    ],
    "Language": "ru"
}