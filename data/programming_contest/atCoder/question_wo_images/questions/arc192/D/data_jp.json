{
    "Title": "AtCoder Regular Contest 192 (Div. 2)",
    "Source": "atcoder",
    "Name": "Fraction Line",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "正の有理数 x に対し、f(x) を以下のように定義します。\nx を互いに素な正整数 P,Q を用いて \\dfrac{P}{Q} と表したときの P\\times Q の値\n正整数 N と、長さ N-1 の正整数列 A=(A_1,A_2,\\dots,A_{N-1}) が与えられます。\n以下の条件をすべて満たす長さ N の正整数列 S=(S_1,S_2,\\dots,S_N) を 良い数列 と呼ぶことにします。\n- 1≤ i≤ N-1 なるすべての整数 i について、f≤ft(\\dfrac{S_i}{S_{i+1}}\\right)=A_i が成り立つ。\n- \\gcd(S_1,S_2,\\dots,S_N)=1\n数列の スコア を、その数列に含まれる要素の総積と定義します。\n良い数列の個数は有限個であることが証明できます。良い数列すべてに対するスコアの総和を 998244353 で割った余りを求めてください。",
    "Statement Images": [],
    "Constraints": "- 2≤ N≤ 1000\n- 1≤ A_i≤ 1000 (1≤ i≤ N-1)\n- 入力はすべて整数",
    "IO Styles": "入力\n入力は以下の形式で標準入力から与えられる。\nN\nA_1 A_2 \\dots A_{N-1}\n出力\n良い数列すべてに対するスコアの総和を 998244353 で割った余りを出力せよ。",
    "Sample Detail": [
        {
            "input": "6\n1 9 2 2 9\n",
            "output": "939634344\n",
            "explanation": "例えば (2,2,18,9,18,2) や (18,18,2,1,2,18) は良い数列で、スコアはどちらも 23328 です。\n\n良い数列は全部で 16 個存在し、それらすべてに対するスコアの総和は 939634344 です。",
            "images": []
        },
        {
            "input": "2\n9\n",
            "output": "18\n",
            "explanation": "良い数列は 2 個存在し、どちらもスコアは 9 です。",
            "images": []
        },
        {
            "input": "25\n222 299 229 22 999 922 99 992 22 292 222 229 992 922 22 992 222 222 99 29 92 999 2 29\n",
            "output": "192457116\n",
            "explanation": "総和を 998244353 で割った余りを求めることを忘れないでください。",
            "images": []
        }
    ],
    "Language": "jp"
}