{
    "Title": "AtCoder Regular Contest 192 (Div. 2)",
    "Source": "atcoder",
    "Name": "Fraction Line",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "For a positive rational number x, define f(x) as follows:\nExpress x as \\dfrac{P}{Q} using coprime positive integers P and Q. f(x) is defined as the value P\\times Q.\nYou are given a positive integer N and a sequence A=(A_1,A_2,\\dots,A_{N-1}) of positive integers of length N-1.\nWe call a sequence S=(S_1,S_2,\\dots,S_N) of positive integers of length N a good sequence if it satisfies all of the following conditions:\n- For every integer i with 1≤ i≤ N-1, it holds that f≤ft(\\dfrac{S_i}{S_{i+1}}\\right)=A_i.\n- \\gcd(S_1,S_2,\\dots,S_N)=1.\nDefine the score of a sequence as the product of all its elements.\nIt can be proved that there are finitely many good sequences. Find the sum, modulo 998244353, of the scores of all good sequences.",
    "Statement Images": [],
    "Constraints": "- 2≤ N≤ 1000\n- 1≤ A_i≤ 1000 (1≤ i≤ N-1)\n- All input values are integers.",
    "IO Styles": "Input\nThe input is given from Standard Input in the following format:\nN\nA_1 A_2 \\dots A_{N-1}\nOutput\nPrint the sum, modulo 998244353, of the scores of all good sequences.",
    "Sample Detail": [
        {
            "input": "6\n1 9 2 2 9\n",
            "output": "939634344\n",
            "explanation": "For example, both (2,2,18,9,18,2) and (18,18,2,1,2,18) are good sequences, and both have a score of 23328.\n\nThere are a total of 16 good sequences, and the sum of the scores of all of them is 939634344.",
            "images": []
        },
        {
            "input": "2\n9\n",
            "output": "18\n",
            "explanation": "There are 2 good sequences, both with a score of 9.",
            "images": []
        },
        {
            "input": "25\n222 299 229 22 999 922 99 992 22 292 222 229 992 922 22 992 222 222 99 29 92 999 2 29\n",
            "output": "192457116\n",
            "explanation": "Do not forget to compute the sum modulo 998244353.",
            "images": []
        }
    ],
    "Language": "en"
}