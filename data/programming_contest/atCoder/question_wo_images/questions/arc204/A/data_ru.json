{
    "Title": "AtCoder Regular Contest 204 (Div. 1)",
    "Source": "atcoder",
    "Name": "Use Udon Coupon",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "Вам даны положительные целые числа N, L, R и последовательности положительных целых чисел длины N A = (A_{1}, A_{2}, \\dots, A_{N}), B = (B_{1}, B_{2}, \\dots, B_{N}).\nИспользуя последовательность Q, инициализированную как пустую, переменную C, инициализированную нулем, и переменную i, инициализированную единицей, выполните следующую операцию 2N раз.\n- Выберите одно из следующих действий 1, 2 и выполните его.\n- Действие 1 : Вставьте i в конец Q, замените C на \\max(0, C - A_{i}). Затем увеличьте i на 1. Это действие можно выполнять только когда i перед операцией не превышает N.\n- Действие 2 : Пусть x будет первым числом в Q, и добавьте B_{x} к C. Затем удалите первый элемент из Q. Это действие можно выполнять только когда Q перед операцией не пустое.\nНайдите количество способов, по модулю 998244353, выполнить 2N операций так, чтобы конечное значение C находилось в диапазоне от L до R, включительно.",
    "Statement Images": [],
    "Constraints": "- $1 \\leq N \\leq 5000$\n- $1 \\leq L \\leq R \\leq \\sum B$\n- $1 \\leq A_{i} \\leq 5000$\n- $1 \\leq B_{i} \\leq 5000$\n- Все входные значения являются целыми числами.",
    "IO Styles": "Входные данные\nВходные данные поступают из стандартного ввода в следующем формате:\nN L R\nA_{1} A_{2} \\dots A_{N}\nB_{1} B_{2} \\dots B_{N}\nВыходные данные\nВыведите ответ.",
    "Sample Detail": [
        {
            "input": "2 100 1000\n2001 167\n924 178\n",
            "output": "1\n",
            "explanation": "Например, вы можете выполнить четыре операции следующим образом.\n\n- Выполните действие 1. Тогда Q = (1), C = 0, i = 2.\n- Выполните действие 2. Тогда Q = (), C = 924, i = 2.\n- Выполните действие 1. Затем Q = (2), C = 757, i = 3.\n- Выполните действие 2. Тогда Q = (), C = 935, i = 3.\n\nВыполнение операций, как описано выше, приводит к тому, что окончательное значение C находится в диапазоне от 100 до 1000 (включительно). Это единственный такой способ выполнения операций, поэтому выведите 1.",
            "images": []
        },
        {
            "input": "3 10 10\n1 6 7\n9 2 4\n",
            "output": "0\n",
            "explanation": "",
            "images": []
        },
        {
            "input": "15 167 924\n122 122 111 85 97 108 115 82 84 82 105 103 113 102 135\n116 122 110 106 71 85 70 94 86 110 73 97 101 86 73\n",
            "output": "9576277\n",
            "explanation": "",
            "images": []
        }
    ],
    "Language": "ru"
}