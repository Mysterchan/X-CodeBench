{
    "Title": "AtCoder Regular Contest 204 (Div. 1)",
    "Source": "atcoder",
    "Name": "Use Udon Coupon",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "正整数 N, L, R と長さ N の正整数列 A = (A_{1}, A_{2}, \\dots, A_{N}), B = (B_{1}, B_{2}, \\dots, B_{N}) が与えられます。\n空で初期化された数列 Q と、 0 で初期化された変数 C と、 1 で初期化された変数 i を用いて以下の操作を 2N 回行います。\n- 以下の行動 1, 2 のうち、いずれかを選んで行う。\n- 行動 1 : Q の末尾に i を挿入し、C を \\max(0, C - A_{i}) に置き換える。その後、i を 1 増やす。この行動は、操作前の i が N 以下のときのみ行える。\n- 行動 2 : Q の先頭の数を x として、C に B_{x} を加算する。その後、Q の先頭の要素を削除する。この行動は、操作前の Q が空でないときのみ行える。\n2N 回の操作の方法であって、最終的な C が L 以上 R 以下であるようなものの場合の数を 998244353 で割ったあまりを求めてください。",
    "Statement Images": [],
    "Constraints": "- 1≤ N≤ 5000\n- 1≤ L ≤ R ≤ \\sum B\n- 1≤ A_{i}≤ 5000\n- 1≤ B_{i}≤ 5000\n- 入力は全て整数",
    "IO Styles": "入力\n入力は以下の形式で標準入力から与えられます。\nN L R\nA_{1} A_{2} \\dots A_{N}\nB_{1} B_{2} \\dots B_{N}\n出力\n答えを出力してください。",
    "Sample Detail": [
        {
            "input": "2 100 1000\n2001 167\n924 178\n",
            "output": "1\n",
            "explanation": "例えば以下のように 4 回の操作を行うことができます。\n\n- 行動 1 をする。Q = (1), C = 0, i = 2 と変化する。\n- 行動 2 をする。Q = (), C = 924, i = 2 と変化する。\n- 行動 1 をする。Q = (2), C = 757, i = 3 と変化する。\n- 行動 2 をする。Q = (), C = 935, i = 3 と変化する。\n\n\n上記のように操作すると、最終的な C が 100 以上 1000 以下になります。そのような操作方法はこれしかないので、1 を出力します。",
            "images": []
        },
        {
            "input": "3 10 10\n1 6 7\n9 2 4\n",
            "output": "0\n",
            "explanation": "",
            "images": []
        },
        {
            "input": "15 167 924\n122 122 111 85 97 108 115 82 84 82 105 103 113 102 135\n116 122 110 106 71 85 70 94 86 110 73 97 101 86 73\n",
            "output": "9576277\n",
            "explanation": "",
            "images": []
        }
    ],
    "Language": "jp"
}