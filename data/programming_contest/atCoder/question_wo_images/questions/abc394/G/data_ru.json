{
    "Title": "KAJIMA CORPORATION CONTEST 2025 (AtCoder Beginner Contest 394)",
    "Source": "atcoder",
    "Name": "Dense Buildings",
    "Time Limit": "5 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "В городе имеется H \\times W кварталов, ориентированных с севера на юг и с запада на восток, и в каждом квартале находится ровно одно здание. В частности, в квартале на i-ой строке с севера (1≤ i≤ H) и j-ой колонне с запада (1≤ j≤ W) (далее именуемом квартал (i,j)) находится здание с F_{i,j} этажами. \nТакэхаси может передвигаться двумя способами. Если он находится на X-ом этаже (1≤ X≤ F_{i,j}) здания в квартале (i,j), он может:\n- Подниматься или спускаться на один этаж внутри того же здания, используя лестницу. Если X=1, он не может спуститься; если X=F_{i,j}, он не может подняться.\n- Выбрать здание с не менее чем X этажами в соседнем квартале и переместиться на X-ый этаж этого здания по (небесному) переходу.\nЗдесь два квартала (i,j) и (i',j') являются соседними, если и только если \\lvert i - i'\\rvert + \\lvert j - j'\\rvert = 1.\nВам будет дано Q запросов для ответа. i-й запрос (1≤ i≤ Q) заключается в следующем.\nНайдите минимально возможное количество раз, когда Такэхаси использует лестницы, чтобы переместиться с Y_i-го этажа здания в квартале (A_i,B_i) на Z_i-й этаж здания в квартале (C_i,D_i).\nКоличество раз использования лестницы увеличивается каждый раз, когда он поднимается или спускается на один этаж, возможно, несколько раз внутри одного здания. (Например, перемещение с 1-го этажа на 6-й этаж здания считается как 5 использований лестницы.)\nОбратите внимание, что ему не нужно минимизировать количество раз, когда он использует переходы.",
    "Statement Images": [],
    "Constraints": "- 1 ≤ H ≤ 500  \n- 1 ≤ W ≤ 500  \n- 1 ≤ F_{i,j} ≤ 10^6  \n- 1 ≤ Q ≤ 2 × 10^5  \n- 1 ≤ A_i, C_i ≤ H  \n- 1 ≤ B_i, D_i ≤ W  \n- 1 ≤ Y_i ≤ F_{A_i, B_i}  \n- 1 ≤ Z_i ≤ F_{C_i, D_i}  \n- (A_i, B_i, Y_i) ≠ (C_i, D_i, Z_i)  \n- Все входные значения - целые числа.",
    "IO Styles": "Входные данные\nВходные данные подаются из стандартного ввода в следующем формате:\nH W\nF_{1,1} F_{1,2} ... F_{1,W}\nF_{2,1} F_{2,2} ... F_{2,W}\n\\vdots\nF_{H,1} F_{H,2} ... F_{H,W}\nQ\nA_1 B_1 Y_1 C_1 D_1 Z_1\nA_2 B_2 Y_2 C_2 D_2 Z_2\n\\vdots\nA_Q B_Q Y_Q C_Q D_Q Z_Q\nВыходные данные\nНапечатайте Q строк. $i$-я строка должна содержать ответ на $i$-й запрос в виде целого числа.",
    "Sample Detail": [
        {
            "input": "3 3\n12 10 6\n1 1 3\n8 6 7\n2\n1 1 10 3 1 6\n1 1 6 1 2 4\n",
            "output": "10\n2\n",
            "explanation": "Для первого запроса, например, можно переместиться с 10-го этажа здания в блоке (1,1) на 6-й этаж здания в блоке (3,1), воспользовавшись лестницами в общей сложности 10 раз, следующим образом:\n\n- Переместитесь с 10-го этажа здания в блоке (1,1) на 10-й этаж здания в блоке (1,2) по переходному мосту.\n- Используйте лестницы 4 раза, чтобы спуститься с 10-го этажа на 6-й этаж здания в блоке (1,2).\n- Переместитесь с 6-го этажа здания в блоке (1,2) на 6-й этаж здания в блоке (1,3) по переходному мосту.\n- Используйте лестницы 3 раза, чтобы спуститься с 6-го этажа на 3-й этаж здания в блоке (1,3).\n- Переместитесь с 3-го этажа здания в блоке (1,3) на 3-й этаж здания в блоке (2,3) по переходному мосту.\n- Переместитесь с 3-го этажа здания в блоке (2,3) на 3-й этаж здания в блоке (3,3) по переходному мосту.\n- Используйте лестницы 3 раза, чтобы подняться с 3-го этажа на 6-й этаж здания в блоке (3,3).\n- Переместитесь с 6-го этажа здания в блоке (3,3) на 6-й этаж здания в блоке (3,2) по переходному мосту.\n- Переместитесь с 6-го этажа здания в блоке (3,2) на 6-й этаж здания в блоке (3,1) по переходному мосту.\n\nНевозможно совершить это путешествие, использовав не более 9 раз лестницы, поэтому мы выводим 10.\n\nДля второго запроса, если сначала воспользоваться переходным мостом, чтобы добраться до здания в блоке (1,2), а затем использовать лестницы дважды, чтобы спуститься с 6-го этажа на 4-й этаж, то можно переместиться с 6-го этажа здания в блоке (1,1) на 4-й этаж здания в блоке (1,2), используя лестницы дважды.",
            "images": []
        }
    ],
    "Language": "ru"
}