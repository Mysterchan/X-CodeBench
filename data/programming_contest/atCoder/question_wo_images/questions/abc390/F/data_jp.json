{
    "Title": "AtCoder Beginner Contest 390",
    "Source": "atcoder",
    "Name": "Double Sum 3",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "長さ N の整数列 A=(A_1,A_2,...,A_N) が与えられます。\n1≤ L≤ R≤ N を満たす整数の組 (L,R) に対し f(L,R) を以下のように定義します。\n- 何も書かれていない黒板に R-L+1 個の整数 A_L,A_{L+1},...,A_R を順に書き込む。\n- 以下の操作を黒板に書かれた整数が全て消えるまで繰り返す。\n- 整数 l,r を選ぶ。ただし、 l≤ r かつ黒板に l 以上 r 以下の整数が全て 1 つ以上書かれているように l,r を選ぶ必要がある。その後、黒板に書かれた l 以上 r 以下の整数を全て消す。\n- 黒板に書かれた整数が全て消えるまでに必要な操作回数の最小値を f(L,R) とする。\n\\displaystyle \\sum_{L=1}^N\\sum_{R=L}^N f(L,R) を求めてください。",
    "Statement Images": [],
    "Constraints": "- 1≤ N≤ 3\\times 10^5\n- 1≤ A_i≤ N\n- 入力される値は全て整数",
    "IO Styles": "入力\n入力は以下の形式で標準入力から与えられる。\nN\nA_1 A_2 ... A_N\n出力\n答えを出力せよ。",
    "Sample Detail": [
        {
            "input": "4\n1 3 1 4\n",
            "output": "16\n",
            "explanation": "例えば (L,R)=(1,4) の場合、以下の手順で f(L,R) を計算することができます。\n\n- 黒板に 1,3,1,4 が書かれている。\n- (l,r)=(1,1) を選び、黒板に書かれた 1 を全て消す。黒板には 3,4 が書かれた状態になる。\n- (l,r)=(3,4) を選び、黒板に書かれた 3,4 を全て消す。黒板は何も書かれていない状態になる。\n- 2 回未満の操作で黒板の整数を全て消すことはできないので、f(1,4)=2 である。\n\n\n同様の計算で、例えば f(2,4)=2, f(1,1)=1 なども分かります。\n\n\\displaystyle \\sum_{L=1}^N\\sum_{R=L}^N f(L,R)=16 なので、 16 を出力してください。",
            "images": []
        },
        {
            "input": "5\n3 1 4 2 4\n",
            "output": "23\n",
            "explanation": "",
            "images": []
        },
        {
            "input": "10\n5 1 10 9 2 5 6 9 1 6\n",
            "output": "129\n",
            "explanation": "",
            "images": []
        }
    ],
    "Language": "jp"
}