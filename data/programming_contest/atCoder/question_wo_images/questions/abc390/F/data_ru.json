{
    "Title": "AtCoder Beginner Contest 390",
    "Source": "atcoder",
    "Name": "Double Sum 3",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "Вам дана последовательность целых чисел A=(A_1,A_2,...,A_N) длины N. \nДля каждой пары целых чисел (L,R) с 1 ≤ L ≤ R ≤ N, определите f(L,R) следующим образом:\n- Начните с пустой доски для записей. Запишите на доске в порядке R-L+1 целых числа A_L, A_{L+1}, ..., A_R.\n- Повторяйте следующую операцию, пока все целые числа на доске не будут стерты:\n- Выберите целые числа l, r такие, что l ≤ r и каждое целое число от l до r появляется хотя бы раз на доске. Затем удалите все целые числа от l до r, которые есть на доске.\n- Пусть f(L,R) будет минимальным количеством таких операций, необходимых для того, чтобы стереть все целые числа с доски.\nНайдите \\displaystyle \\sum_{L=1}^N \\sum_{R=L}^N f(L,R).",
    "Statement Images": [],
    "Constraints": "- 1 ≤ N ≤ 3 \\times 10^5\n- 1 ≤ A_i ≤ N\n- Все входные значения являются целыми числами.",
    "IO Styles": "Входные данные\nВходные данные поступают из стандартного ввода в следующем формате:\nN\nA_1 A_2 ... A_N\nВыходные данные\nВыведите ответ.",
    "Sample Detail": [
        {
            "input": "4\n1 3 1 4\n",
            "output": "16\n",
            "explanation": "Например, в случае (L,R)=(1,4):\n\n- Доска имеет значения 1,3,1,4.\n- Выбираем (l,r)=(1,1) и стираем все вхождения 1. Теперь на доске остаются 3,4.\n- Выбираем (l,r)=(3,4) и стираем все вхождения 3 и 4. Доска становится пустой.\n- Это невозможно сделать менее чем за два действия, поэтому f(1,4) = 2.\n\nАналогично, вы можете найти f(2,4)=2, f(1,1)=1 и т.д.\n\n\\displaystyle \\sum_{L=1}^N \\sum_{R=L}^N f(L,R) = 16, поэтому выведите 16.",
            "images": []
        },
        {
            "input": "5\n3 1 4 2 4\n",
            "output": "23\n",
            "explanation": "",
            "images": []
        },
        {
            "input": "10\n5 1 10 9 2 5 6 9 1 6\n",
            "output": "129\n",
            "explanation": "",
            "images": []
        }
    ],
    "Language": "ru"
}