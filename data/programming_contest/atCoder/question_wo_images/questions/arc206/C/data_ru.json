{
    "Title": "AtCoder Regular Contest 206 (Div. 2)",
    "Source": "atcoder",
    "Name": "Tree Sequence",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "Последовательность B=(B_1,...,B_N) длины N, состоящая из целых чисел от 1 до N (включительно), называется хорошей последовательностью тогда и только тогда, когда выполняется следующее условие:\n- Для каждого интервала [l,r]\\ (1≤ l ≤ r ≤ N) существует целое число x\\ (l≤ x≤ r), такое что выполняется следующее условие:\n- Подготовьте граф с N вершинами, пронумерованными от 1 до N, и нулевыми ребрами. Для каждого l ≤ i ≤ r, если i\\neq x, добавьте ребро между вершинами i и B_i. Таким образом, вершины l, l+1,...,r образуют дерево. То есть, вершины l, l+1,...,r связаны.\nВам дана последовательность A=(A_1,...,A_N), где каждый элемент либо является целым числом от 1 до N, либо -1. Найдите количество способов, по модулю 998244353, заменить элементы, равные -1 в A, на целые числа от 1 до N, чтобы A стала хорошей последовательностью.",
    "Statement Images": [],
    "Constraints": "- Все входные значения являются целыми числами.\n- $1 ≤ N ≤ 2\\times 10^5$\n- $1 ≤ A_i ≤ N$ или $A_i = -1$",
    "IO Styles": "Входные данные\nВходные данные подаются из стандартного ввода в следующем формате:\nN \nA_1 \\cdots A_N\nВыходные данные\nВыведите число, по модулю 998244353, способов заменить элементы, равные -1 в A, целыми числами от 1 до N (включительно) так, чтобы A стало хорошей последовательностью.",
    "Sample Detail": [
        {
            "input": "3\n-1 -1 -1\n",
            "output": "7\n",
            "explanation": "Замены, которые удовлетворяют условию, следующие семь:\n\n- (1,1,2)\n- (2,1,2)\n- (2,2,2)\n- (2,3,1)\n- (2,3,2)\n- (2,3,3)\n- (3,1,2)\n\nНапример, в случае A=(1,1,2) можно подтвердить, что интервал [1,2] удовлетворяет условию, установив x=1, где вершины 2 и A_2=1 соединены, а вершины 1 и 2 образуют дерево.\n\nАналогично, интервалы [1,1],[2,2],[3,3],[2,3],[1,3] также удовлетворяют условию, поэтому (1,1,2) является хорошей последовательностью.",
            "images": []
        },
        {
            "input": "3\n-1 3 -1\n",
            "output": "3\n",
            "explanation": "Замены, которые удовлетворяют условию, следующие три:\n\n- (2,3,1)\n- (2,3,2)\n- (2,3,3)",
            "images": []
        },
        {
            "input": "6\n2 3 -1 -1 -1 -1\n",
            "output": "21\n",
            "explanation": "",
            "images": []
        }
    ],
    "Language": "ru"
}