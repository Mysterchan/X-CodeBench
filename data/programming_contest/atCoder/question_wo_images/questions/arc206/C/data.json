{
    "Title": "AtCoder Regular Contest 206 (Div. 2)",
    "Source": "atcoder",
    "Name": "Tree Sequence",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "A sequence B=(B_1,...,B_N) of length N consisting of integers between 1 and N (inclusive) is called a good sequence if and only if it satisfies the following condition:\n- For every interval [l,r]\\ (1≤ l ≤ r ≤ N), there exists an integer x\\ (l≤ x≤ r) such that the following condition holds:\n- Prepare a graph with N vertices numbered from 1 to N and zero edges. For each l ≤ i ≤ r, if i\\neq x, add an edge between vertices i and B_i. Then, vertices l, l+1,...,r form a tree. That is, vertices l, l+1,...,r are connected.\nYou are given a sequence A=(A_1,...,A_N) where each element is either an integer between 1 and N, or -1. Find the number, modulo 998244353, of ways to replace the elements that are -1 in A with integers between 1 and N such that A becomes a good sequence.",
    "Statement Images": [],
    "Constraints": "- All input values are integers.\n- 1≤ N≤ 2\\times 10^5\n- 1≤ A_i≤ N or A_i=-1",
    "IO Styles": "Input\nThe input is given from Standard Input in the following format:\nN \nA_1 \\cdots A_N\nOutput\nOutput the number, modulo 998244353, of ways to replace the elements that are -1 in A with integers between 1 and N (inclusive) such that A becomes a good sequence.",
    "Sample Detail": [
        {
            "input": "3\n-1 -1 -1\n",
            "output": "7\n",
            "explanation": "The replacements that satisfy the condition are the following seven:\n\n- (1,1,2)\n- (2,1,2)\n- (2,2,2)\n- (2,3,1)\n- (2,3,2)\n- (2,3,3)\n- (3,1,2)\n\n\nFor example, in the case of A=(1,1,2), that the interval [1,2] satisfies the condition can be confirmed by setting x=1, where vertices 2 and A_2=1 are connected and vertices 1,2 form a tree.\n\nSimilarly, intervals [1,1],[2,2],[3,3],[2,3],[1,3] also satisfy the condition, so (1,1,2) is a good sequence.",
            "images": []
        },
        {
            "input": "3\n-1 3 -1\n",
            "output": "3\n",
            "explanation": "The replacements that satisfy the condition are the following three:\n\n- (2,3,1)\n- (2,3,2)\n- (2,3,3)",
            "images": []
        },
        {
            "input": "6\n2 3 -1 -1 -1 -1\n",
            "output": "21\n",
            "explanation": "",
            "images": []
        }
    ],
    "Language": "en"
}