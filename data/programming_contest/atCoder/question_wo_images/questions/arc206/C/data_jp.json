{
    "Title": "AtCoder Regular Contest 206 (Div. 2)",
    "Source": "atcoder",
    "Name": "Tree Sequence",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "1 以上 N 以下の整数からなる長さ N の数列 B=(B_1,...,B_N) が良い数列であるとは，以下の条件を満たすことをいいます．\n- 任意の区間 [l,r]\\ (1≤ l ≤ r ≤ N) に対して，以下の条件が成り立つような整数 x\\ (l≤ x≤ r) が存在する：\n- 頂点に 1 から N の番号が付いた N 頂点 0 辺のグラフを用意する．全ての l ≤ i ≤ r について，i\\neq x ならば頂点 i と頂点 B_i の間に辺を張る．このとき 頂点 l, l+1,...,r が木をなしている．つまり，頂点 l, l+1,...,r が連結になっている．\n各要素が 1 以上 N 以下の整数，または -1 であるような数列 A=(A_1,...,A_N) が与えられます．A のうち -1 であるような要素を 1 以上 N 以下の整数に置き換える方法であって，A が良い数列になるようなものの個数を 998244353 で割ったあまりを求めてください．",
    "Statement Images": [],
    "Constraints": "- 入力される数値は全て整数\n- 1≤ N≤ 2\\times 10^5\n- 1≤ A_i≤ N または A_i=-1",
    "IO Styles": "入力\n入力は以下の形式で標準入力から与えられる．\nN \nA_1 \\cdots A_N\n出力\nA のうち -1 であるような要素を 1 以上 N 以下の整数に置き換える方法であって，A が良い数列になるようなものの個数を 998244353 で割ったあまりを出力せよ．",
    "Sample Detail": [
        {
            "input": "3\n-1 -1 -1\n",
            "output": "7\n",
            "explanation": "条件を満たす置き換え方は以下の 7 個です．\n\n- (1,1,2)\n- (2,1,2)\n- (2,2,2)\n- (2,3,1)\n- (2,3,2)\n- (2,3,3)\n- (3,1,2)\n\n\n例えば A=(1,1,2) の場合に区間 [1,2] が条件を満たすことは，x=1 とすると頂点 2 と頂点 A_2=1 が結ばれ頂点 1,2 が木をなすことから確認できます．\n\n同様に区間 [1,1],[2,2],[3,3],[2,3],[1,3] も条件を満たすため，(1,1,2) は良い数列です．",
            "images": []
        },
        {
            "input": "3\n-1 3 -1\n",
            "output": "3\n",
            "explanation": "条件を満たす置き換え方は以下の 3 個です．\n\n- (2,3,1)\n- (2,3,2)\n- (2,3,3)",
            "images": []
        },
        {
            "input": "6\n2 3 -1 -1 -1 -1\n",
            "output": "21\n",
            "explanation": "",
            "images": []
        }
    ],
    "Language": "jp"
}