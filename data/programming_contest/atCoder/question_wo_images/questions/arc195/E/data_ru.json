{
    "Title": "AtCoder Regular Contest 195 (Div. 2)",
    "Source": "atcoder",
    "Name": "Random Tree Distance",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "Дана целочисленная последовательность A = (A_2,A_3,...,A_N). Также, для целочисленной последовательности P=(P_2, P_3, ... ,P_N), где 1 ≤ P_i ≤ i-1 для каждого i (2 ≤ i ≤ N), определим взвешенное дерево T(P) с N вершинами, корнем в вершине 1, следующим образом:\n- Корневое дерево, где для каждого i (2 ≤ i ≤ N) родитель вершины i является P_i, а вес ребра между i и P_i равен A_i.\nВам даны Q запросов. Обрабатывайте их по порядку. i-й запрос выглядит следующим образом:\n- Вам даны целые числа u_i и v_i, каждое из которых находится в пределах от 1 до N. Для каждой из возможных последовательностей (N-1)! P, возьмите дерево T(P) и рассмотрите расстояние между вершинами u_i и v_i в этом дереве. Выведите сумму, по модулю 998244353, этих расстояний для всех T(P). Здесь расстояние между двумя вершинами u_i и v_i - это сумма весов ребер на уникальном пути (без посещения одной и той же вершины более одного раза), который соединяет их.",
    "Statement Images": [],
    "Constraints": "- $2 ≤ N ≤ 2 \\times 10^5$\n- $1 ≤ Q ≤ 2 \\times 10^5$\n- $1 ≤ A_i ≤ 10^9$\n- $1 ≤ u_i < v_i ≤ N$\n- Все входные данные являются целыми числами.",
    "IO Styles": "Входные данные\nВходные данные подаются через стандартный ввод в следующем формате:\nN Q\nA_2 A_3 ... A_N\nu_1 v_1\nu_2 v_2\n\\vdots\nu_Q v_Q\nВыходные данные\nВыведите Q строк. В i-й строке должно содержаться решение для i-го запроса.",
    "Sample Detail": [
        {
            "input": "3 2\n1 1\n1 2\n1 3\n",
            "output": "2\n3\n",
            "explanation": "- Если P = (1,1), то в дереве T(P) расстояние между вершинами 1 и 2 равно 1, а расстояние между вершинами 1 и 3 равно 1.\n- Если P = (1,2), то в дереве T(P) расстояние между вершинами 1 и 2 равно 1, а расстояние между вершинами 1 и 3 равно 2.\n\nТаким образом, общее расстояние между вершинами 1 и 2 по всем T(P) составляет 2, а общее расстояние между вершинами 1 и 3 по всем T(P) составляет 3.",
            "images": []
        },
        {
            "input": "2 1\n100\n1 2\n",
            "output": "100\n",
            "explanation": "",
            "images": []
        },
        {
            "input": "9 6\n765689282 93267307 563699854 951829154 801512848 389123318 924504746 596035433\n3 8\n2 5\n5 8\n2 9\n8 9\n5 7\n",
            "output": "55973424\n496202632\n903509579\n343265517\n550981449\n68482696\n",
            "explanation": "Не забудьте взять сумму по модулю 998244353.",
            "images": []
        }
    ],
    "Language": "ru"
}