{
    "Title": "AtCoder Regular Contest 195 (Div. 2)",
    "Source": "atcoder",
    "Name": "Random Tree Distance",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "There is an integer sequence A = (A_2,A_3,...,A_N). Also, for an integer sequence P=(P_2, P_3, ... ,P_N) where 1 ≤ P_i ≤ i-1 for each i (2 ≤ i ≤ N), define the weighted tree T(P) with N vertices, rooted at vertex 1, as follows:\n- A rooted tree where, for each i (2 ≤ i ≤ N), the parent of i is P_i, and the weight of the edge between i and P_i is A_i.\nYou are given Q queries. Process them in order. The i-th query is as follows:\n- You are given integers u_i and v_i, each between 1 and N. For each of the possible (N-1)! sequences P, take the tree T(P) and consider the distance between vertices u_i and v_i in this tree. Output the sum, modulo 998244353, of these distances over all T(P). Here, the distance between two vertices u_i and v_i is the sum of the weights of the edges on the unique path (not visiting the same vertex more than once) that connects them.",
    "Statement Images": [],
    "Constraints": "- 2 ≤ N ≤ 2 \\times 10^5\n- 1 ≤ Q ≤ 2 \\times 10^5\n- 1 ≤ A_i ≤ 10^9\n- 1 ≤ u_i < v_i ≤ N\n- All input values are integers.",
    "IO Styles": "Input\nThe input is given from Standard Input in the following format:\nN Q\nA_2 A_3 ... A_N\nu_1 v_1\nu_2 v_2\n\\vdots\nu_Q v_Q\nOutput\nPrint Q lines. The i-th line should contain the answer to the i-th query.",
    "Sample Detail": [
        {
            "input": "3 2\n1 1\n1 2\n1 3\n",
            "output": "2\n3\n",
            "explanation": "- If P = (1,1), then in the tree T(P), the distance between vertices 1 and 2 is 1, and the distance between vertices 1 and 3 is 1.\n- If P = (1,2), then in the tree T(P), the distance between vertices 1 and 2 is 1, and the distance between vertices 1 and 3 is 2.\n\n\nTherefore, the total distance between vertices 1 and 2 over all T(P) is 2, and the total distance between vertices 1 and 3 over all T(P) is 3.",
            "images": []
        },
        {
            "input": "2 1\n100\n1 2\n",
            "output": "100\n",
            "explanation": "",
            "images": []
        },
        {
            "input": "9 6\n765689282 93267307 563699854 951829154 801512848 389123318 924504746 596035433\n3 8\n2 5\n5 8\n2 9\n8 9\n5 7\n",
            "output": "55973424\n496202632\n903509579\n343265517\n550981449\n68482696\n",
            "explanation": "Remember to take the sum modulo 998244353.",
            "images": []
        }
    ],
    "Language": "en"
}