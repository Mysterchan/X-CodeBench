{
    "Title": "AtCoder Regular Contest 195 (Div. 2)",
    "Source": "atcoder",
    "Name": "Random Tree Distance",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "有一個整數序列 A = (A_2,A_3,...,A_N)。還有一個整數序列 P=(P_2, P_3, ... ,P_N)，其中對於每個 i (2 ≤ i ≤ N)，1 ≤ P_i ≤ i-1，定義加權樹 T(P)，其具有 N 個頂點，根位於頂點 1，如下所示：\n- 一棵根樹，其中對於每個 i (2 ≤ i ≤ N)，i 的父節點是 P_i，而邊 i 與 P_i 之間的權重是 A_i。\n你將獲得 Q 個查詢。按順序處理這些查詢。第 i 個查詢如下：\n- 給定整數 u_i 和 v_i，每個整數都在 1 到 N 之間。對於所有可能的 (N-1)! 序列 P，取樹 T(P)，並考慮在這棵樹中頂點 u_i 和 v_i 之間的距離。輸出這些距離在所有 T(P) 中的總和，取模 998244353。這兩個頂點 u_i 和 v_i 之間的距離是連接它們的唯一路徑（不重複訪問同一節點）的邊權重之和。",
    "Statement Images": [],
    "Constraints": "- 2 ≤ N ≤ 2 \\times 10^5\n- 1 ≤ Q ≤ 2 \\times 10^5\n- 1 ≤ A_i ≤ 10^9\n- 1 ≤ u_i < v_i ≤ N\n- 所有輸入值均為整數。",
    "IO Styles": "輸入\n輸入是以以下格式從標準輸入給出：\nN Q\nA_2 A_3 ... A_N\nu_1 v_1\nu_2 v_2\n\\vdots\nu_Q v_Q\n輸出\n輸出 Q 行。第 i 行應該包含第 i 個查詢的答案。",
    "Sample Detail": [
        {
            "input": "3 2\n1 1\n1 2\n1 3\n",
            "output": "2\n3\n",
            "explanation": "- 如果 P = (1,1)，那麼在樹 T(P) 中，頂點 1 和 2 之間的距離為 1，頂點 1 和 3 之間的距離為 1。\n- 如果 P = (1,2)，那麼在樹 T(P) 中，頂點 1 和 2 之間的距離為 1，頂點 1 和 3 之間的距離為 2。\n\n因此，所有 T(P) 中頂點 1 和 2 之間的總距離為 2，所有 T(P) 中頂點 1 和 3 之間的總距離為 3。",
            "images": []
        },
        {
            "input": "2 1\n100\n1 2\n",
            "output": "100\n",
            "explanation": "",
            "images": []
        },
        {
            "input": "9 6\n765689282 93267307 563699854 951829154 801512848 389123318 924504746 596035433\n3 8\n2 5\n5 8\n2 9\n8 9\n5 7\n",
            "output": "55973424\n496202632\n903509579\n343265517\n550981449\n68482696\n",
            "explanation": "記得將總和取模 998244353。",
            "images": []
        }
    ],
    "Language": "cn"
}