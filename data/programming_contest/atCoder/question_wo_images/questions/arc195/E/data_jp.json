{
    "Title": "AtCoder Regular Contest 195 (Div. 2)",
    "Source": "atcoder",
    "Name": "Random Tree Distance",
    "Time Limit": "2 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "整数列 A = (A_2,A_3,...,A_N) があります。また、各 i (2 ≤ i ≤ N) について 1 ≤ P_i ≤ i-1 を満たす整数列 P=(P_2, P_3, ... ,P_N) に対して、頂点 1 を根とする N 頂点の重み付き木 T(P) を以下のように定義します。\n- 各 i (2 ≤ i ≤ N) について、i の親が P_i であり、i と P_i を結ぶ辺の重みが A_i であるような根付き木\nQ 個のクエリが与えられるので、順に処理してください。i 番目のクエリは以下の通りです。\n- 1 以上 N 以下の整数 u_i,v_i が与えられる。P としてあり得る (N-1)! 通りの数列全てについての木 T(P) での頂点 u_i と頂点 v_i の距離の総和を 998244353 で割った余りを出力する。ただし、頂点 u_i と頂点 v_i の距離とは、この 2 頂点を結ぶ唯一の（同じ頂点を 2 回以上通らない）パスに含まれる辺の重みの総和である。",
    "Statement Images": [],
    "Constraints": "- 2 ≤ N ≤ 2 \\times 10^5\n- 1 ≤ Q ≤ 2 \\times 10^5\n- 1 ≤ A_i ≤ 10^9\n- 1 ≤ u_i \\lt v_i ≤ N\n- 入力される値は全て整数",
    "IO Styles": "入力\n入力は以下の形式で標準入力から与えられる。\nN Q\nA_2 A_3 ... A_N\nu_1 v_1\nu_2 v_2\n\\vdots\nu_Q v_Q\n出力\nQ 行出力せよ。i 行目には、i 番目のクエリの答えを出力せよ。",
    "Sample Detail": [
        {
            "input": "3 2\n1 1\n1 2\n1 3\n",
            "output": "2\n3\n",
            "explanation": "- P = (1,1) の場合、木 T(P) での頂点 1 と頂点 2 の距離は 1、頂点 1 と頂点 3 の距離は 1 です。\n- P = (1,2) の場合、木 T(P) での頂点 1 と頂点 2 の距離は 1、頂点 1 と頂点 3 の距離は 2 です。\n\n\n以上より、全ての P に対する木 T(P) での頂点 1 と頂点 2 の距離の総和は 2、頂点 1 と頂点 3 の距離の総和は 3 です。",
            "images": []
        },
        {
            "input": "2 1\n100\n1 2\n",
            "output": "100\n",
            "explanation": "",
            "images": []
        },
        {
            "input": "9 6\n765689282 93267307 563699854 951829154 801512848 389123318 924504746 596035433\n3 8\n2 5\n5 8\n2 9\n8 9\n5 7\n",
            "output": "55973424\n496202632\n903509579\n343265517\n550981449\n68482696\n",
            "explanation": "総和を 998244353 で割った余りを求めることに注意してください。",
            "images": []
        }
    ],
    "Language": "jp"
}