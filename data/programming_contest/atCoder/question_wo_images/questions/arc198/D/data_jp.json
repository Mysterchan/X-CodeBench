{
    "Title": "AtCoder Regular Contest 198 (Div. 2)",
    "Source": "atcoder",
    "Name": "Many Palindromes on Tree",
    "Time Limit": "5 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "頂点に 1 から N の番号がついた N 頂点の木 T と N \\times N 行列 A = (A_{i,j}) が与えられます。T の i 本目の辺は頂点 U_i と頂点 V_i を結ぶ辺です。また、A の成分は 0 または 1 です。\n整数列 x=(x_1,x_2,\\dots,x_N) のスコアを以下のように定義します。\n- 頂点の組 (i,j)(1 ≤ i,j ≤ N) に対して、T における i から j への単純パスが通る頂点を v_1=i,v_2,\\dots,v_n=j とする(T は木なので、単純パスが一意に定まる)。(i,j) が回文ペアであるとは、任意の k(1 ≤ k ≤ n) について、x_{v_k} = x_{v_{n+1-k}} が成り立つことと定義する。\n- A_{i,j} = 1 かつ (i,j) が回文ペアでないような (i,j) が存在するとき、x のスコアは 10^{100} とする。\n- そのような (i,j) が存在しないとき、x のスコアは 1 ≤ i,j ≤ N かつ (i,j) が回文ペアであるような (i,j) の個数とする。\n全ての整数列 x に対する、スコアの最小値を求めてください。",
    "Statement Images": [],
    "Constraints": "- 1 ≤ N ≤ 3000\n- 1 ≤ U_i,V_i ≤ N\n- T は木である。\n- A_{i,j} \\in \\lbrace 0,1 \\rbrace\n- A_{i,i} = 1\n- A_{i,j} = A_{j,i}",
    "IO Styles": "入力\n入力は以下の形式で標準入力から与えられる。\nN\r\nU_1 V_1\r\nU_2 V_2\r\n\\vdots\r\nU_{N-1} V_{N-1}\r\nA_{1,1}A_{1,2}\\dots A_{1,N}\r\nA_{2,1}A_{2,2}\\dots A_{2,N}\r\n\\vdots\r\nA_{N,1}A_{N,2}\\dots A_{N,N}\r\n出力\n全ての整数列 x に対する、スコアの最小値を出力せよ。",
    "Sample Detail": [
        {
            "input": "4\n1 2\n1 3\n1 4\n1000\n0101\n0010\n0101\n",
            "output": "6\n",
            "explanation": "例えば x = (1,2,4,2) のとき、A_{i,j} = 1 かつ (i,j) が回文ペアでないような (i,j) は存在しません。また、(i,j) が回文ペアであるようなものは (1,1),(2,2),(3,3),(4,4),(2,4),(4,2) の 6 個なので、スコアは 6 です。\n\n他にも x = (1,2,3,4) のとき、(i,j) = (2,4) について A_{2,4} = 1 ですが、(2,4) が回文ペアでないためスコアは 10^{100} です。",
            "images": []
        },
        {
            "input": "7\n7 2\n4 1\n6 5\n1 6\n3 4\n2 3\n1001000\n0100000\n0010000\n1001001\n0000100\n0000010\n0001001\n",
            "output": "13\n",
            "explanation": "",
            "images": []
        },
        {
            "input": "10\n7 5\n10 3\n7 6\n6 10\n8 3\n9 3\n5 4\n1 5\n2 10\n1000000000\n0100010000\n0010010100\n0001000000\n0000100100\n0110010000\n0000001001\n0010100110\n0000000110\n0000001001\n",
            "output": "66\n",
            "explanation": "",
            "images": []
        }
    ],
    "Language": "jp"
}