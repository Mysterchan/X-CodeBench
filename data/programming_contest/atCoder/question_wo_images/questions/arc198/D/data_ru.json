{
    "Title": "AtCoder Regular Contest 198 (Div. 2)",
    "Source": "atcoder",
    "Name": "Many Palindromes on Tree",
    "Time Limit": "5 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "Вам дано дерево T с N вершинами, пронумерованными от 1 до N, и матрица размером N \\times N, обозначенная A = (A_{i,j}). i-е ребро дерева T соединяет вершины U_i и V_i. Каждый элемент матрицы A равен 0 или 1. \nОпределите оценку для целочисленной последовательности x=(x_1,x_2,\\dots,x_N) следующим образом:\n- Для пары вершин (i,j)(1 ≤ i,j ≤ N) пусть простой путь в T от i до j будет v_1=i,v_2,\\dots,v_n=j (этот путь уникален, так как T является деревом). Пара (i,j) называется палиндромной парой, если x_{v_k} = x_{v_{n+1-k}} для каждого k(1 ≤ k ≤ n).\n- Если существует пара (i,j) такая, что A_{i,j} = 1 и (i,j) не является палиндромной парой, то оценка x равна 10^{100}.\n- В противном случае, оценка x равна количеству пар (i,j) таких, что 1 ≤ i,j ≤ N и (i,j) является палиндромной парой.\nНайдите минимальную оценку среди всех целочисленных последовательностей x.",
    "Statement Images": [],
    "Constraints": "- $1 ≤ N ≤ 3000$  \n- $1 ≤ U_i,V_i ≤ N$  \n- $T$ — это дерево.  \n- $A_{i,j} \\in \\{0,1\\}$  \n- $A_{i,i} = 1$  \n- $A_{i,j} = A_{j,i}$",
    "IO Styles": "Входные данные\nВходные данные поступают из стандартного ввода в следующем формате:\nN  \nU_1 V_1  \nU_2 V_2  \n\\vdots  \nU_{N-1} V_{N-1}  \nA_{1,1}A_{1,2}\\dots A_{1,N}  \nA_{2,1}A_{2,2}\\dots A_{2,N}  \n\\vdots  \nA_{N,1}A_{N,2}\\dots A_{N,N}  \nВыходные данные\nВыведите минимальный балл для всех целых последовательностей x.",
    "Sample Detail": [
        {
            "input": "4\n1 2\n1 3\n1 4\n1000\n0101\n0010\n0101\n",
            "output": "6\n",
            "explanation": "Например, когда x = (1,2,4,2), не существует пары (i,j) такая, что A_{i,j}=1 и (i,j) не является палиндромной парой. Палиндромные пары: (1,1),(2,2),(3,3),(4,4),(2,4),(4,2), таким образом, счет равен 6.\n\nС другой стороны, когда x = (1,2,3,4), мы имеем A_{2,4} = 1, в то время как (2,4) не является палиндромной парой, поэтому счет равен 10^{100}.",
            "images": []
        },
        {
            "input": "7\n7 2\n4 1\n6 5\n1 6\n3 4\n2 3\n1001000\n0100000\n0010000\n1001001\n0000100\n0000010\n0001001\n",
            "output": "13\n",
            "explanation": "",
            "images": []
        },
        {
            "input": "10\n7 5\n10 3\n7 6\n6 10\n8 3\n9 3\n5 4\n1 5\n2 10\n1000000000\n0100010000\n0010010100\n0001000000\n0000100100\n0110010000\n0000001001\n0010100110\n0000000110\n0000001001\n",
            "output": "66\n",
            "explanation": "",
            "images": []
        }
    ],
    "Language": "ru"
}