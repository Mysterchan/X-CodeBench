{
    "Title": "AtCoder Regular Contest 190 (Div. 1)",
    "Source": "atcoder",
    "Name": "Basic Grid Problem with Updates",
    "Time Limit": "5 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "Есть сетка размером H \\times W. Пусть (h,w) обозначает ячейку в h-й строке сверху и w-й столбце слева. В ячейке (h,w) записано неотрицательное целое число A_{h,w}. ТокаHashи начинает с ячейки (sh,sw) и выполнит Q изменений в сетке. i-е изменение задано символом d_i (d_i один из L, R, U, D) и неотрицательным целым числом a_i, что означает, что ТокаHashи сделает следующее:\n- Переместится на одну ячейку в направлении d_i. То есть, если d_i равно L, переместится влево; если R, переместится вправо; если U, поднимется вверх; если D, спустится вниз на одну ячейку. Затем пусть ячейка назначения будет (h,w), и установите A_{h,w} равным a_i. Гарантируется, что при каждом изменении он может переместиться на одну ячейку в направлении d_i.\nПосле каждого изменения выведите ответ на следующую задачу:\nПоследовательность ячеек P = ((h_1,w_1), ..., (h_{M},w_{M})) называется путем, если и только если она удовлетворяет всем следующим условиям:\n- (h_1,w_1) = (1,1), (h_{M},w_{M}) = (H,W), и M = H + W - 1.\n- Для каждого i с 1 ≤ i ≤ M-1, либо (h_{i+1}, w_{i+1}) = (h_i + 1, w_i), либо (h_{i+1}, w_{i+1}) = (h_i, w_i + 1).\nСуществует \\binom{H+W-2}{H-1} путей. Для пути P = ((h_1,w_1), ..., (h_{M},w_{M})) определите f(P) = \\prod_{1≤ i≤ M}A_{h_i,w_i}. Выведите сумму, по модулю 998244353, f(P) по всем путям P.",
    "Statement Images": [],
    "Constraints": "- 2 ≤ H, W ≤ 200000  \n- HW ≤ 200000  \n- 0 ≤ A_{h,w} < 998244353  \n- 1 ≤ Q ≤ 200000  \n- 1 ≤ sh ≤ H, 1 ≤ sw ≤ W  \n- 0 ≤ a_i < 998244353  \n- H, W, A_{h,w}, Q, sh, sw и a_i — целые числа.  \n- Каждое d_i равно L, R, U или D.  \n- В каждом изменении Такаси может переместиться на одну ячейку в направлении d_i.",
    "IO Styles": "Входные данные\nВходные данные подаются через стандартный ввод в следующем формате:\nH W\nA_{1,1} \\cdots A_{1,W}\n\\vdots\nA_{H,1} \\cdots A_{H,W}\nQ sh sw\nd_1 a_1\n\\vdots\nd_Q a_Q\nВыходные данные\nВыведите Q строк.\ni-я строка должна содержать сумму, по модулю 998244353, f(P) по всем путям P после выполнения i-го изменения в сетке.",
    "Sample Detail": [
        {
            "input": "2 3\n1 2 3\n4 5 6\n3 2 2\nU 7\nR 8\nL 9\n",
            "output": "456\n666\n822\n",
            "explanation": "- Изначально Такахаси находится в точке (2,2).  \n- Поднимитесь вверх, затем установите A_{1,2} равным 7. Значение f(P) для каждого пути:\n- P=((1,1),(1,2),(1,3),(2,3)): f(P)=1 \\times 7 \\times 3 \\times 6=126.  \n- P=((1,1),(1,2),(2,2),(2,3)): f(P)=1 \\times 7 \\times 5 \\times 6=210.  \n- P=((1,1),(2,1),(2,2),(2,3)): f(P)=1 \\times 4 \\times 5 \\times 6=120.  \n\n- Переместитесь вправо, затем установите A_{1,3} равным 8. Значение f(P) для каждого пути:\n- P=((1,1),(1,2),(1,3),(2,3)): f(P)=1 \\times 7 \\times 8 \\times 6=336.  \n- P=((1,1),(1,2),(2,2),(2,3)): f(P)=1 \\times 7 \\times 5 \\times 6=210.  \n- P=((1,1),(2,1),(2,2),(2,3)): f(P)=1 \\times 4 \\times 5 \\times 6=120.  \n\n- Переместитесь влево, затем установите A_{1,2} равным 9. Значение f(P) для каждого пути:\n- P=((1,1),(1,2),(1,3),(2,3)): f(P)=1 \\times 9 \\times 8 \\times 6=432.  \n- P=((1,1),(1,2),(2,2),(2,3)): f(P)=1 \\times 9 \\times 5 \\times 6=270.  \n- P=((1,1),(2,1),(2,2),(2,3)): f(P)=1 \\times 4 \\times 5 \\times 6=120.",
            "images": []
        },
        {
            "input": "5 4\n147015809 294958521 852121867 499798308\n790350368 404692331 645419803 290531806\n275766153 896286651 239187926 945049742\n340760022 236352314 926236110 223464913\n287023679 590772036 340282357 521075891\n6 3 1\nU 344644511\nR 45812235\nD 260083498\nR 781118585\nL 156297846\nL 411901560\n",
            "output": "299123226\n548055393\n810247224\n876210800\n773990840\n506814544\n",
            "explanation": "",
            "images": []
        }
    ],
    "Language": "ru"
}