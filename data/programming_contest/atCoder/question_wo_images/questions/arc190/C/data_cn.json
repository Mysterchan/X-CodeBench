{
    "Title": "AtCoder Regular Contest 190 (Div. 1)",
    "Source": "atcoder",
    "Name": "Basic Grid Problem with Updates",
    "Time Limit": "5 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "有一個 H × W 的網格。令 (h,w) 表示從上方第 h 行和從左側第 w 列的單元格。非負整數 A_{h,w} 被寫在單元格 (h,w) 中。\nTakahashi 從單元格 (sh,sw) 開始，將對網格進行 Q 次變更。第 i 次變更由字符 d_i (d_i 是 L, R, U, D 之一) 和非負整數 a_i 組成，這意味著 Takahashi 將執行以下操作：\n- 向 d_i 所指定的方向移動一個單元格。也就是說，如果 d_i 是 L，就向左移動；如果是 R，就向右移動；如果是 U，就向上移動；如果是 D，就向下移動一個單元格。然後，令目的單元格為 (h,w)，並將 A_{h,w} 設為 a_i。\n保證在每次變更中，他都可以向 d_i 所指的方向移動一個單元格。\n在每次變更後，輸出以下問題的答案：\n一系列單元格 P = ((h_1,w_1), ..., (h_{M},w_{M})) 被稱為一條路徑當且僅當它滿足以下所有條件：\n- (h_1,w_1) = (1,1)，(h_{M},w_{M}) = (H,W)，且 M = H + W - 1。\n- 對於每個 i，1 ≤ i ≤ M-1，(h_{i+1}, w_{i+1}) 必須是 (h_i + 1, w_i) 或 (h_{i+1}, w_{i+1}) = (h_i, w_i + 1)。\n總共有 \\binom{H+W-2}{H-1} 條路徑。對於一條路徑 P = ((h_1,w_1), ..., (h_{M},w_{M}))，定義 f(P) = \\prod_{1≤ i≤ M}A_{h_i,w_i}。輸出所有路徑 P 所有 f(P) 的總和，對 998244353 取模。",
    "Statement Images": [],
    "Constraints": "- 2 ≤ H, W ≤ 200000  \n- HW ≤ 200000  \n- 0 ≤ A_{h,w} < 998244353  \n- 1 ≤ Q ≤ 200000  \n- 1 ≤ sh ≤ H, 1 ≤ sw ≤ W  \n- 0 ≤ a_i < 998244353  \n- H, W, A_{h,w}, Q, sh, sw, 和 a_i 為整數。  \n- 每個 d_i 為 L、R、U 或 D。  \n- 在每次變更中，高橋可以朝 d_i 的方向移動一個單元格。",
    "IO Styles": "輸入\n輸入是以以下格式從標準輸入給出：\nH W\nA_{1,1} \\cdots A_{1,W}\n\\vdots\nA_{H,1} \\cdots A_{H,W}\nQ sh sw\nd_1 a_1\n\\vdots\nd_Q a_Q\n輸出\n輸出 Q 行。\n第 i 行應該包含在對網格執行第 i 次變更後，所有路徑 P 的 f(P) 之和，取模 998244353。",
    "Sample Detail": [
        {
            "input": "2 3\n1 2 3\n4 5 6\n3 2 2\nU 7\nR 8\nL 9\n",
            "output": "456\n666\n822\n",
            "explanation": "- 起初，高橋的位置在 (2,2)。\n- 向上移動，然後將 A_{1,2} 設為 7。每條路徑的 f(P) 值為：\n- P=((1,1),(1,2),(1,3),(2,3)): f(P)=1 \\times 7 \\times 3 \\times 6=126。\n- P=((1,1),(1,2),(2,2),(2,3)): f(P)=1 \\times 7 \\times 5 \\times 6=210。\n- P=((1,1),(2,1),(2,2),(2,3)): f(P)=1 \\times 4 \\times 5 \\times 6=120。\n\n\n- 向右移動，然後將 A_{1,3} 設為 8。每條路徑的 f(P) 值為：\n- P=((1,1),(1,2),(1,3),(2,3)): f(P)=1 \\times 7 \\times 8 \\times 6=336。\n- P=((1,1),(1,2),(2,2),(2,3)): f(P)=1 \\times 7 \\times 5 \\times 6=210。\n- P=((1,1),(2,1),(2,2),(2,3)): f(P)=1 \\times 4 \\times 5 \\times 6=120。\n\n\n- 向左移動，然後將 A_{1,2} 設為 9。每條路徑的 f(P) 值為：\n- P=((1,1),(1,2),(1,3),(2,3)): f(P)=1 \\times 9 \\times 8 \\times 6=432。\n- P=((1,1),(1,2),(2,2),(2,3)): f(P)=1 \\times 9 \\times 5 \\times 6=270。\n- P=((1,1),(2,1),(2,2),(2,3)): f(P)=1 \\times 4 \\times 5 \\times 6=120。",
            "images": []
        },
        {
            "input": "5 4\n147015809 294958521 852121867 499798308\n790350368 404692331 645419803 290531806\n275766153 896286651 239187926 945049742\n340760022 236352314 926236110 223464913\n287023679 590772036 340282357 521075891\n6 3 1\nU 344644511\nR 45812235\nD 260083498\nR 781118585\nL 156297846\nL 411901560\n",
            "output": "299123226\n548055393\n810247224\n876210800\n773990840\n506814544\n",
            "explanation": "",
            "images": []
        }
    ],
    "Language": "cn"
}