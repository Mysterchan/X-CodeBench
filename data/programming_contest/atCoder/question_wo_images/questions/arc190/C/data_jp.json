{
    "Title": "AtCoder Regular Contest 190 (Div. 1)",
    "Source": "atcoder",
    "Name": "Basic Grid Problem with Updates",
    "Time Limit": "5 sec",
    "Memory Limit": "1024 MiB",
    "Problem Statement": "H\\times W のマス目があります．上から h 行目，左から w 列目のマスを (h,w) で表します．(h,w) には非負整数 A_{h,w} が書かれています．\n高橋君がはじめマス (sh,sw) におり，これからマス目に Q 回の変更を行います．i 回目の変更は文字 d_i （d_i は L, R, U, D のいずれか）と非負整数 a_i によって与えられ，これは高橋君が以下を行うことを意味します．\n- d_i の方向に 1 マス移動する．つまり，d_i が L ならば左，d_i が R ならば右，d_i が U ならば上，d_i が D ならば下方向に 1 マス移動する．その後，移動先のマスを (h,w) とするとき A_{h,w} を a_i に変更する．\nただし，各変更において，高橋君が d_i 方向に 1 マス移動することが可能であることが保証されます．\nマス目の変更のたびに，以下の問題の答を出力してください．\nマスの列 P=((h_1,w_1),...,(h_{M},w_{M})) が以下の条件をすべて満たすとき，P はパスであるということにします．\n- (h_1,w_1)=(1,1), (h_{M},w_{M})=(H,W), M=H+W-1. \n- 1≤ i ≤ M-1 を満たす任意の i に対して，(h_{i+1},w_{i+1}) = (h_i+1,w_i) または (h_{i+1},w_{i+1}) = (h_i,w_i+1) が成り立つ．\nパスは \\binom{H+W-2}{H-1} 個あります．パス P=((h_1,w_1),...,(h_{M},w_{M})) に対して f(P) = \\prod_{1≤ i≤ M}A_{h_i,w_i} と定めます．\nすべてのパス P に対する f(P) の総和を 998244353 で割った余りを出力してください．",
    "Statement Images": [],
    "Constraints": "- 2≤ H, W≤ 200000\n- HW≤ 200000\n- 0≤ A_{h,w} < 998244353\n- 1≤ Q≤ 200000\n- 1≤ sh≤ H, 1≤ sw≤ W\n- 0≤ a_i < 998244353\n- H, W, A_{h,w}, Q, sh, sw, a_i は整数\n- d_i は L, R, U, D のいずれか\n- 各変更において，高橋君が d_i 方向に 1 マス移動することが可能である",
    "IO Styles": "入力\n入力は以下の形式で標準入力から与えられます．\nH W\nA_{1,1} \\cdots A_{1,W}\n\\vdots\nA_{H,1} \\cdots A_{H,W}\nQ sh sw\nd_1 a_1\n\\vdots\nd_Q a_Q\n出力\nQ 行出力してください．\ni 行目には i 回目のマス目の変更の後に，すべてのパス P に対する f(P) の総和を 998244353 で割った余りを出力してください．",
    "Sample Detail": [
        {
            "input": "2 3\n1 2 3\n4 5 6\n3 2 2\nU 7\nR 8\nL 9\n",
            "output": "456\n666\n822\n",
            "explanation": "- はじめ高橋君は (2,2) に居ます．\n- 上方向に移動して，A_{1,2} を 7 に変更します．各パスに対する f(P) は次の通りです．\n- P=((1,1),(1,2),(1,3),(2,3)): f(P)=1\\times 7\\times 3\\times 6=126. \n- P=((1,1),(1,2),(2,2),(2,3)): f(P)=1\\times 7\\times 5\\times 6=210. \n- P=((1,1),(2,1),(2,2),(2,3)): f(P)=1\\times 4\\times 5\\times 6=120. \n\n\n- 右方向に移動して，A_{1,3} を 8 に変更します．各パスに対する f(P) は次の通りです．\n- P=((1,1),(1,2),(1,3),(2,3)): f(P)=1\\times 7\\times 8\\times 6=336. \n- P=((1,1),(1,2),(2,2),(2,3)): f(P)=1\\times 7\\times 5\\times 6=210. \n- P=((1,1),(2,1),(2,2),(2,3)): f(P)=1\\times 4\\times 5\\times 6=120. \n\n\n- 左方向に移動して，A_{1,2} を 9 に変更します．各パスに対する f(P) は次の通りです．\n- P=((1,1),(1,2),(1,3),(2,3)): f(P)=1\\times 9\\times 8\\times 6=432. \n- P=((1,1),(1,2),(2,2),(2,3)): f(P)=1\\times 9\\times 5\\times 6=270. \n- P=((1,1),(2,1),(2,2),(2,3)): f(P)=1\\times 4\\times 5\\times 6=120.",
            "images": []
        },
        {
            "input": "5 4\n147015809 294958521 852121867 499798308\n790350368 404692331 645419803 290531806\n275766153 896286651 239187926 945049742\n340760022 236352314 926236110 223464913\n287023679 590772036 340282357 521075891\n6 3 1\nU 344644511\nR 45812235\nD 260083498\nR 781118585\nL 156297846\nL 411901560\n",
            "output": "299123226\n548055393\n810247224\n876210800\n773990840\n506814544\n",
            "explanation": "",
            "images": []
        }
    ],
    "Language": "jp"
}