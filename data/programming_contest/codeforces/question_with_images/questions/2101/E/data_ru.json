{
    "Title": "Specific Tasks",
    "Source": "codeforces",
    "Name": "E",
    "Time Limit": "unknown",
    "Memory Limit": "unknown",
    "Problem Statement": "Вам дана бинарная строка $s$ длиной $n$ и дерево $T$ с $n$ вершинами. Пусть $k$ — это количество 1 в $s$. Мы построим полный неориентированный взвешенный граф с $k$ вершинами следующим образом: - Для каждого $1≤ i≤ n$, для которого $s_i = \\mathtt{1}$, создать вершину с номером $i$. - Для любых двух вершин с номерами $u$ и $v$, созданных на предыдущем шаге, определить вес ребра между ними $w(u, v)$ как расстояние$^{\\text{∗}}$ между вершиной $u$ и вершиной $v$ в дереве $T$. \nПростой путь$^{\\text{†}}$, который посещает вершины $v_1, v_2, ..., v_m$ в данном порядке, называется красивым, если для всех $1≤ i≤ m - 2$ выполняется условие $2\\cdot w(v_i, v_{i + 1})≤ w(v_{i + 1}, v_{i + 2})$. Другими словами, вес каждого ребра в пути должен быть как минимум в два раза больше веса предыдущего ребра. Обратите внимание, что $s_{v_i} = \\mathtt{1}$ должно выполняться для всех $1≤ i≤ m$, иначе вершины с таким номером не будет.\nДля каждой вершины с номером $i$ ($1≤ i≤ n$ и $s_i = \\mathtt{1}$) в полном неориентированном взвешенном графе определите максимальное количество вершин на красивом простом пути, начинающемся с вершины $i$.\n$^{\\text{∗}}$Расстояние между двумя вершинами $a$ и $b$ в дереве равно количеству рёбер на уникальном простом пути между вершиной $a$ и вершиной $b$.\n$^{\\text{†}}$Путь — это последовательность вершин $v_1, v_2, ..., v_m$, такая что между $v_i$ и $v_{i + 1}$ есть ребро для всех $1≤ i≤ m - 1$. Простой путь — это путь без повторяющихся вершин, т.е. $v_i\\neq v_j$ для всех $1≤ i < j≤ m$.",
    "Statement Images": [],
    "Constraints": "Time limit: unknown\nMemory limit: unknown",
    "IO Styles": "Входные данные\nКаждый тест состоит из нескольких наборов входных данных. В первой строке находится одно целое число $t$ ($1 ≤ t ≤ 10^4$) — количество наборов входных данных. Далее следует описание наборов входных данных. \nПервая строка каждого набора входных данных содержит одно целое число $n$ ($1≤ n≤ 7\\cdot10^4$) — длина бинарной строки $s$ и количество вершин в дереве $T$.\nВторая строка каждого набора входных данных содержит бинарную строку из $n$ символов $s_1s_2... s_n$ ($s_i\\in \\{\\mathtt{0}, \\mathtt{1}\\}$) — строку, представляющую вершины, которые будут построены в полном неориентированном взвешенном графе.\nКаждая из следующих $n - 1$ строк содержит два целых числа $u$ и $v$ ($1≤ u, v≤ n$) — концы рёбер дерева $T$.\nГарантируется, что заданные рёбра образуют дерево.\nГарантируется, что сумма значений $n$ по всем наборам входных данных не превосходит $7\\cdot10^4$. \nВыходные данные\nДля каждого набора входных данных выведите $n$ целых чисел. $i$-е целое число представляет максимальное количество вершин в красивом простом пути, начинающемся с вершины $i$. Если вершины с номером $i$ нет, т.е. $s_i = \\mathtt{0}$, выведите $-1$.",
    "Sample Detail": [
        {
            "input": "3\n5\n01111\n1 2\n2 3\n3 4\n4 5\n17\n01101011110101101\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n9 10\n10 11\n11 12\n12 13\n13 14\n14 15\n15 16\n16 17\n2\n01\n1 2",
            "output": "-1 3 3 3 3 \n-1 5 4 -1 4 -1 5 5 5 5 -1 4 -1 5 5 -1 3 \n-1 1 ",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "Примечание\nВ первом наборе входных данных дерево $T$ и построенный граф выглядят следующим образом: ![image](1.png) Слева показано дерево $T$ с выделенными вершинами, окрашенными в желтый цвет. Справа — построенный полный граф. \nКрасивый путь, показанный на картинке, это $3\\rightarrow 4\\rightarrow 2$. Путь красивый, так как $w(4, 2) = 2$ как минимум в два раза больше, чем $w(3, 4) = 1$. Расширить путь, используя $2\\rightarrow 5$, невозможно, так как $w(2, 5) = 3$ меньше, чем удвоенный $w(4, 2) = 2$.\nВо втором наборе входных данных дерево $T$ является простым путем длиной $17$. Пример красивого пути, начинающегося с вершины с числом $2$, это $2\\rightarrow 3\\rightarrow 5\\rightarrow 9\\rightarrow 17$, который имеет веса рёбер $1, 2, 4, 8$, удваивающиеся каждый раз.",
    "Note Images": [
        "https://espresso.codeforces.com/2c018d3678fcc993cea93af930f4bc10bd9d0bed.png"
    ],
    "Language": "ru"
}