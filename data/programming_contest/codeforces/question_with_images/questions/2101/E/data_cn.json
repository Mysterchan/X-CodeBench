{
    "Title": "Codeforces Round 1024 (Div. 1)",
    "Source": "codeforces",
    "Name": "Kia Bakes a Cake",
    "Time Limit": "6 s",
    "Memory Limit": "512 mb",
    "Problem Statement": "給定一個長度為 $n$ 的二進位字符串 $s$ 和一棵具有 $n$ 個頂點的樹 $T$。令 $k$ 為 $s$ 中 1 的數量。我們將按照以下方式構建一個具有 $k$ 個頂點的完全無向加權圖：\n\n- 對於每個 $1≤ i≤ n$ 且 $s_i = \\mathtt{1}$，創建一個標記為 $i$ 的頂點。\n- 對於以上步驟中創建的任何兩個標記為 $u$ 和 $v$ 的頂點，定義它們之間的邊權重 $w(u, v)$ 為樹 $T$ 中頂點 $u$ 和頂點 $v$ 之間的距離$^{\\text{∗}}$。\n\n如果一條簡單路徑$^{\\text{†}}$ 按照這個順序訪問標記為 $v_1, v_2, ..., v_m$ 的頂點，其中對於所有 $1≤ i≤ m - 2$，條件 $2\\cdot w(v_i, v_{i + 1})≤ w(v_{i + 1}, v_{i + 2})$ 成立，那麼這條路徑是「好」的。換句話說，路徑中每條邊的權重必須至少是前一條邊權重的兩倍。請注意，對於所有 $1≤ i≤ m$，必須滿足 $s_{v_i} = \\mathtt{1}$，否則將不存在具有相應標籤的頂點。\n\n對於每個標記為 $i$ 的頂點 ($1≤ i≤ n$ 且 $s_i = \\mathtt{1}$) 在這個完全無向加權圖中，確定從標記為 $i$ 的頂點開始的任何「好」簡單路徑中最多可以包含的頂點數量。\n$^{\\text{∗}}$ 樹中兩個頂點 $a$ 和 $b$ 之間的距離等於頂點 $a$ 和頂點 $b$ 之間唯一簡單路徑上的邊數。\n$^{\\text{†}}$ 路徑是一組頂點 $v_1, v_2, ..., v_m$，使得對於所有 $1≤ i≤ m - 1$，$v_i$ 和 $v_{i + 1}$ 之間存在一條邊。簡單路徑是一條沒有重複頂點的路徑，即對於所有 $1≤ i < j≤ m$，$v_i\\neq v_j$。",
    "Statement Images": [],
    "Constraints": "Time limit: 6 s\nMemory limit: 512 mb",
    "IO Styles": "輸入\n每個測試包含多個測試案例。第一行包含測試案例的數量 $t$ ($1 ≤ t ≤ 10^4$)。接下來是測試案例的描述。\n每個測試案例的第一行包含一個整數 $n$ ($1≤ n≤ 7\\cdot10^4$)，即二進制字串 $s$ 的長度以及樹 $T$ 的頂點數。\n每個測試案例的第二行包含一個二進制字串，長度為 $n$ 的字串 $s_1s_2... s_n$ ($s_i\\in \\{\\mathtt{0}, \\mathtt{1}\\}$)，表示要在完全無向加權圖中構建的頂點。\n接下來的 $n - 1$ 行每行包含兩個整數 $u$ 和 $v$ ($1≤ u, v≤ n$)，即樹 $T$ 的邊的端點。\n可保證給定的邊形成一棵樹。\n可保證所有測試案例中的 $n$ 的總和不超過 $7\\cdot10^4$。\n輸出\n對於每個測試案例，輸出 $n$ 個整數，第 $i$ 個整數表示從標記為 $i$ 的頂點出發的任何優雅簡單路徑中的最大頂點數。如果不存在標記為 $i$ 的頂點，即 $s_i = \\mathtt{0}$，則輸出 $-1$。",
    "Sample Detail": [
        {
            "input": "3\n5\n01111\n1 2\n2 3\n3 4\n4 5\n17\n01101011110101101\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n9 10\n10 11\n11 12\n12 13\n13 14\n14 15\n15 16\n16 17\n2\n01\n1 2",
            "output": "-1 3 3 3 3 \n-1 5 4 -1 4 -1 5 5 5 5 -1 4 -1 5 5 -1 3 \n-1 1 ",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "備註\n在第一個測試案例中，樹 $T$ 和構建的圖如下所示： ![image](1.png) 左側是樹 $T$，選中的節點用黃色標記。右側是構建的完全圖。 \n圖中顯示的好路徑是 $3\\rightarrow 4\\rightarrow 2$。這條路徑是好的，因為 $w(4, 2) = 2$ 至少是 $w(3, 4) = 1$ 的兩倍。使用 $2\\rightarrow 5$ 擴展路徑是不可能的，因為 $w(2, 5) = 3$ 小於 $w(4, 2) = 2$ 的兩倍。\n在第二個測試案例中，樹 $T$ 是一條長度為 $17$ 的簡單路徑。從標記為 $2$ 的頂點出發的好路徑的例子是 $2\\rightarrow 3\\rightarrow 5\\rightarrow 9\\rightarrow 17$，其邊權重分別為 $1, 2, 4, 8$，每次都加倍。",
    "Note Images": [
        "https://espresso.codeforces.com/2c018d3678fcc993cea93af930f4bc10bd9d0bed.png"
    ],
    "Language": "cn"
}