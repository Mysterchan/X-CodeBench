{
    "Title": "Codeforces Round 1040 (Div. 1)",
    "Source": "codeforces",
    "Name": "Permutation Blackhole",
    "Time Limit": "3 s",
    "Memory Limit": "512 mb",
    "Problem Statement": "For a permutation $p_1, p_2, ..., p_n$ of length $n$, the corresponding coloring sequence $s$ can be obtained by the following coloring process: - Initially, there are $n$ white cells indexed from $1$ to $n$ from left to right. At second $0$, the score of each cell is $0$. - At second $i$ ($1 ≤ i ≤ n$),  - If $i > 1$, find the nearest black cell to the cell $p_i$, and increase the score of that cell by $1$. In case there are multiple nearest black cells, choose the cell with the lowest index. Cell $y$ is called the nearest black cell to cell $x$ only if cell $y$ is black and there is no black cell $z$ satisfying $|x-z|<|x-y|$. - Color the cell $p_i$ black.  \nAfter all cells are colored black, denoting $s_i$ as the score of cell $i$ ($1 ≤ i ≤ n$), we get the coloring sequence $s$.\nYou might want to read the notes for a better understanding.\nYou are given an incomplete coloring sequence $s$, where some $s_i$ are already fixed, while others are not yet determined. Count how many different permutations $p$ can produce this coloring sequence. Since the answer may be large, you need to output it modulo $998\\,244\\,353$.",
    "Statement Images": [],
    "Constraints": "Time limit: 3 s\nMemory limit: 512 mb",
    "IO Styles": "Input\nEach test contains multiple test cases. The first line contains the number of test cases $t$ ($1 ≤ t ≤ 10^3$). The description of the test cases follows. \nFor each test case, the first line contains an integer $n$ ($2 ≤ n ≤ 100$).\nThe second line contains $n$ integers $s_1, s_2, ..., s_n$ ($-1 ≤ s_i ≤ n-1$). Here, $s_i=-1$ means $s_i$ has not been determined. And $s_i \\neq -1$ means $s_i$ has already been fixed.\nIt is guaranteed that the sum of $n^2$ over all test cases does not exceed $10^4$.\nOutput\nFor each test case, output the total of different permutations $p_1, p_2, ..., p_n$ that can produce the coloring sequence, modulo $998\\,244\\,353$.",
    "Sample Detail": [
        {
            "input": "9\n3\n-1 -1 1\n3\n-1 -1 -1\n4\n-1 2 -1 0\n4\n-1 0 1 -1\n5\n-1 3 -1 0 -1\n5\n4 4 4 4 4\n5\n1 0 1 2 0\n6\n-1 1 -1 -1 3 0\n13\n-1 -1 -1 -1 -1 -1 2 -1 -1 -1 -1 -1 -1",
            "output": "2\n6\n4\n3\n8\n0\n4\n10\n867303072",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "Note\nIn the first test case, $p=[3,1,2]$ and $p=[3,2,1]$ can produce the coloring sequence $s=[-1,-1,1]$.\nFor $p=[3,1,2]$, the coloring process is shown as the following picture. ![image](1.png)![image](2.png)![image](3.png)![image](4.png) The grid at seconds $0$, $1$, $2$, and $3$ respectively when $p=[3,1,2]$. \nFor $p=[3,2,1]$, the coloring process is shown as the following picture. ![image](5.png)![image](6.png)![image](7.png)![image](8.png) The grid at seconds $0$, $1$, $2$, and $3$ respectively when $p=[3,2,1]$.",
    "Note Images": [
        "https://espresso.codeforces.com/26efaccea13cb1b0cea714b08dfdc0ac71a96b85.png",
        "https://espresso.codeforces.com/bdd07d7a497ef2e639ca122e46586048c77853ac.png",
        "https://espresso.codeforces.com/e7cbbc909a8c1f66e77eb10a021d79bae4673c82.png",
        "https://espresso.codeforces.com/059ff6b5a11674aa3a45d3fed2d15884b5d57da4.png",
        "https://espresso.codeforces.com/26efaccea13cb1b0cea714b08dfdc0ac71a96b85.png",
        "https://espresso.codeforces.com/bdd07d7a497ef2e639ca122e46586048c77853ac.png",
        "https://espresso.codeforces.com/552c55326775e1fa2bf69f0e4d8a046c6d3abea9.png",
        "https://espresso.codeforces.com/c8295c674ce2876ecbb6926a02ba211fdcdfe904.png"
    ],
    "Language": "en"
}