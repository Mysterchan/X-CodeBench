{
    "Title": "Codeforces Round 1040 (Div. 1)",
    "Source": "codeforces",
    "Name": "Permutation Blackhole",
    "Time Limit": "3 s",
    "Memory Limit": "512 mb",
    "Problem Statement": "順列 $p_1, p_2, ..., p_n$ の長さ $n$ に対して、対応する彩色列 $s$ は次の彩色プロセスによって得られます： - 初めに、左から右に $1$ から $n$ までの $n$ 個の白いセルがあります。時刻 $0$ では、各セルの得点は $0$ です。 - 時刻 $i$ ($1 ≤ i ≤ n$) の場合、  - $i > 1$ の場合、セル $p_i$ に最も近い黒いセルを見つけ、そのセルの得点を $1$ 増加させます。最も近い黒いセルが複数ある場合は、インデックスが最も小さいセルを選びます。セル $y$ はセル $x$ に最も近い黒いセルと呼ばれるのは、セル $y$ が黒く、かつ $|x-z|<|x-y|$ を満たす黒いセル $z$ が存在しない場合のみです。 - セル $p_i$ を黒く塗ります。  \nすべてのセルが黒く塗られた後、セル $i$ の得点を $s_i$ ($1 ≤ i ≤ n$) とし、彩色列 $s$ を得ます。  \nより良い理解のために、注意事項をお読みになることをお勧めします。  \n不完全な彩色列 $s$ が与えられ、いくつかの $s_i$ がすでに固定されており、他はまだ決まっていません。この彩色列を生成できる異なる順列 $p$ の数を数えてください。答えが大きくなる場合があるため、$998\\,244\\,353$ で割った余りを出力する必要があります。",
    "Statement Images": [],
    "Constraints": "Time limit: 3 s\nMemory limit: 512 mb",
    "IO Styles": "入力\n各テストには複数のテストケースが含まれています。最初の行にはテストケースの数 $t$ ($1 ≤ t ≤ 10^3$) が含まれています。テストケースの説明が続きます。\n各テストケースについて、最初の行には整数 $n$ ($2 ≤ n ≤ 100$) が含まれています。\n2行目には $n$ 個の整数 $s_1, s_2, ..., s_n$ ($-1 ≤ s_i ≤ n-1$) が含まれています。ここで、$s_i=-1$ は $s_i$ が未確定であることを意味します。$s_i \\neq -1$ は $s_i$ がすでに固定されていることを意味します。\nすべてのテストケースに対して $n^2$ の合計が $10^4$ を超えないことが保証されています。\n出力\n各テストケースについて、色付けの順列を生成できる異なる順列 $p_1, p_2, ..., p_n$ の合計を、$998\\,244\\,353$ で割った余りとして出力してください。",
    "Sample Detail": [
        {
            "input": "9\n3\n-1 -1 1\n3\n-1 -1 -1\n4\n-1 2 -1 0\n4\n-1 0 1 -1\n5\n-1 3 -1 0 -1\n5\n4 4 4 4 4\n5\n1 0 1 2 0\n6\n-1 1 -1 -1 3 0\n13\n-1 -1 -1 -1 -1 -1 2 -1 -1 -1 -1 -1 -1",
            "output": "2\n6\n4\n3\n8\n0\n4\n10\n867303072",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "注意  \n最初のテストケースでは、$p=[3,1,2]$と$p=[3,2,1]$が色付けの順序$s=[-1,-1,1]$を生成することができます。  \n$p=[3,1,2]$の場合の色付けプロセスは以下の図のようになります。 ![image](1.png)![image](2.png)![image](3.png)![image](4.png) $p=[3,1,2]$のときのグリッドはそれぞれ秒数$0$、$1$、$2$、$3$です。  \n$p=[3,2,1]$の場合の色付けプロセスは以下の図のようになります。 ![image](5.png)![image](6.png)![image](7.png)![image](8.png) $p=[3,2,1]$のときのグリッドはそれぞれ秒数$0$、$1$、$2$、$3$です。",
    "Note Images": [
        "https://espresso.codeforces.com/26efaccea13cb1b0cea714b08dfdc0ac71a96b85.png",
        "https://espresso.codeforces.com/bdd07d7a497ef2e639ca122e46586048c77853ac.png",
        "https://espresso.codeforces.com/e7cbbc909a8c1f66e77eb10a021d79bae4673c82.png",
        "https://espresso.codeforces.com/059ff6b5a11674aa3a45d3fed2d15884b5d57da4.png",
        "https://espresso.codeforces.com/26efaccea13cb1b0cea714b08dfdc0ac71a96b85.png",
        "https://espresso.codeforces.com/bdd07d7a497ef2e639ca122e46586048c77853ac.png",
        "https://espresso.codeforces.com/552c55326775e1fa2bf69f0e4d8a046c6d3abea9.png",
        "https://espresso.codeforces.com/c8295c674ce2876ecbb6926a02ba211fdcdfe904.png"
    ],
    "Language": "jp"
}