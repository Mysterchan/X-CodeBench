{
    "Title": "Codeforces Round 1048 (Div. 2)",
    "Source": "codeforces",
    "Name": "Antiamuny and Slider Movement",
    "Time Limit": "5 s",
    "Memory Limit": "512 mb",
    "Problem Statement": "Antiamuny 正在一條長度為 $m$ 的一維軌道上管理 $n$ 梇木。每個梇木恰好佔用一個單位的空間，並且起始於不同的位置。這些梇木從 $1$ 到 $n$ 編號，並從左到右排列，因此第 $i$ 根梇木最初位於位置 $a_i$。\n\nAntiamuny 收到了 $q$ 個操作。每個操作由兩個整數 $i$ 和 $x$ 描述 ($1≤ i≤ n$, $i ≤ x ≤ m - n + i$)。該操作將第 $i$ 根梇木移動到位置 $x$。然而，如果這個移動造成與另一個梇木碰撞（即，如果在第 $i$ 根梇木的當前位置和目的地 $x$ 之間有任何其他梇木），那麼阻礙的梇木將在同一方向上推進一個單位，直到不再與第 $i$ 根梇木發生碰撞。這可能會觸發連鎖反應，其中一根梇木推動另一根，依此類推，直到所有梇木再次佔據不同的位置。\n\n重要的是，請注意，操作不會改變梇木的相對順序：左邊的第 $i$ 根梇木將始終保持為左邊的第 $i$ 根梇木。此外，對 $x$ 的約束確保了所有梇木始終保持在軌道上，位置在 $1$ 和 $m$ 之間。\n\n例如，假設初始梇木位置為 $[1, 3, 5, 7, 9]$。如果第五根梇木（在位置 $9$）被移動到位置 $6$，它將把第四根梇木從 $7$ 推到 $5$，而第四根梇木又將第三根梇木從 $5$ 推到 $4$。結果位置變為 $[1, 3, \\textbf{4}, \\textbf{5}, \\textbf{6}]$。\n\n不幸的是，Antiamuny 忘記了 $q$ 個操作的應用順序。為了恢復結果，他決定獨立模擬 $q!$ 個可能的操作排列。對於操作長度為 $q^{\\text{∗}}$ 的每一個排列 $p$，定義 $f_i(p)$ 為在按照 $p$ 所指定的順序應用操作後第 $i$ 根梇木的最終位置。\n\n換句話說，從初始位置 $a_1, a_2, ..., a_n$ 開始，Antiamuny 首先應用第 $p_1$ 個操作，然後是第 $p_2$ 個操作，依此類推，直到第 $p_q$ 個操作。$f_i(p)$ 的值是在這一系列操作結束時第 $i$ 根梇木的位置。\n\n你的任務是計算對於每根梇木 $i$ ($1≤ i≤ n$)，$f_i(p)$ 在所有 $q!$ 個操作的排列 $p$ 中的總和。由於結果可能很大，請將每個總和輸出為模 $10^9 + 7$。  \n$^{\\text{∗}}$ 長度為 $q$ 的排列是一個包含 $1$ 到 $q$ 的 $q$ 個不同整數的數組，順序任意。例如，$[2,3,1,5,4]$ 是一個排列，但 $[1,2,2]$ 不是一個排列（$2$ 在數組中出現兩次），而 $[1,3,4]$ 也不是一個排列（$q=3$ 但數組中有 $4$）。",
    "Statement Images": [],
    "Constraints": "Time limit: 5 s\nMemory limit: 512 mb",
    "IO Styles": "輸入\n每個測試包含多個測試案例。第一行包含測試案例的數量 $t$ ($1 ≤ t ≤ 10^3$)。隨後是測試案例的描述。\n每個測試案例的第一行包含三個整數 $n$、$m$ 和 $q$ ($1 ≤ n,q ≤ 5 \\cdot 10^3$，$n ≤ m ≤ 10^9$) — 滑塊的數量、賽道的長度和操作的數量。\n每個測試案例的第二行包含 $n$ 個整數 $a_1, a_2, ..., a_n$ ($1 ≤ a_1 < a_2 < ... < a_n ≤ m$) — 每個滑塊的初始位置。\n接下來的 $q$ 行中，每行包含兩個整數 $i$ 和 $x$ ($1 ≤ i ≤ n$，$i ≤ x ≤ m - n + i$) — 要移動的滑塊的索引，以及要將該滑塊移動到的位置。\n可以保證所有測試案例中 $n$ 的總和和 $q$ 的總和不會超過 $5 \\cdot 10^3$。\n\n輸出\n對於每個測試案例，輸出 $n$ 個整數，其中第 $i$ 個表示 $f_i(p)$ 在所有 $q!$ 的操作排列 $p$ 上的總和，並取模 $10^9 + 7$。",
    "Sample Detail": [
        {
            "input": "3\n5 10 3\n1 3 5 7 9\n5 6\n2 6\n1 4\n5 10 5\n2 3 5 7 9\n1 6\n4 7\n3 3\n5 7\n4 9\n3 1000000000 3\n1 10 253746392\n3 100000000\n3 1000000000\n3 500000000",
            "output": "18 29 35 41 47 \n340 460 580 930 1090 \n6 60 199999979 ",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "註\n在第一個測試案例中：- 如果操作按照順序$[2,1,3]$進行，我們首先執行第二個操作，使得第$2$個滑桿移動到位置$6$；然後執行第一個操作，讓第$5$個滑桿移動到位置$6$；最後執行第三個操作，讓第$1$個滑桿移動到位置$4$。每次操作後滑桿的位置如下面的圖所示。滑桿的最終位置將是$[4,5,6,7,8]$。 ![image](1.png) - 如果操作按照順序$[1,2,3]$進行，滑桿的最終位置將是$[4,6,7,8,9]$。- 如果操作按照順序$[1,3,2]$進行，滑桿的最終位置將是$[4,6,7,8,9]$。- 如果操作按照順序$[2,3,1]$進行，滑桿的最終位置將是$[2,3,4,5,6]$。- 如果操作按照順序$[3,1,2]$進行，滑桿的最終位置將是$[2,6,7,8,9]$。- 如果操作按照順序$[3,2,1]$進行，滑桿的最終位置將是$[2,3,4,5,6]$。\n對於滑桿$1$，$6$種不同情況下位置的總和是$4+4+4+2+2+2=18$。\n對於滑桿$2$，$6$種不同情況下位置的總和是$5+6+6+3+6+3=29$。\n對於滑桿$3$，$6$種不同情況下位置的總和是$6+7+7+4+7+4=35$。\n對於滑桿$4$，$6$種不同情況下位置的總和是$7+8+8+5+8+5=41$。\n對於滑桿$5$，$6$種不同情況下位置的總和是$8+9+9+6+9+6=47$。",
    "Note Images": [
        "https://espresso.codeforces.com/7d5398150d613f4b33f34da67e8d70aeac5bfd6a.png"
    ],
    "Language": "cn"
}