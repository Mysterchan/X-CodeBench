{
    "Title": "Codeforces Round 1013 (Div. 3)",
    "Source": "codeforces",
    "Name": "Igor and Mountain",
    "Time Limit": "5 s",
    "Memory Limit": "512 mb",
    "Problem Statement": "IT 校園「NEIMARK」的訪客不僅是強大的程式設計師，還是身體健壯的個體！有些人練習游泳，有些人划船，還有些人攀岩！\n伊戈爾大師是當地攀岩社區的知名人物。一天，他去登山健行，想要攀登其中一座山峰。作為一名經驗豐富的攀岩者，伊戈爾決定不走既定的步道，而是利用他的技能進行垂直攀爬。\n伊戈爾發現了一個矩形的垂直山體，並在心中將其劃分為 $n$ 個水平層。他然後將每個層劃分為 $m$ 個區段，並使用垂直隔板進行分隔。在檢查這些區段後，伊戈爾發現了一些方便的突出物可以抓握（以下稱為握點）。因此，所選擇的山體部分可以表示為一個 $n \\times m$ 的矩形，其中一些單元格包含握點。\n作為一名經驗豐富的程式設計師，伊戈爾決定計算有效路徑的數量。路徑被定義為一系列不同的握點。如果滿足以下條件，則路徑被視為有效：\n- 路徑中的第一個握點位於最底層（第 $n$ 行）；\n- 路徑中的最後一個握點位於最頂層（第 $1$ 行）；\n- 每個後續握點不低於前一個握點；\n- 每個層至少使用一個握點（即矩形的每一行）；\n- 每個層最多使用兩個握點（因為伊戈爾只有兩隻手）；\n- 如果相應區段的中心之間的距離不超過伊戈爾的臂展，則伊戈爾可以從當前握點到達下一個握點。\n伊戈爾的臂展為 $d$，這意味著如果相應區段的中心之間的歐幾里得距離不超過 $d$，他就可以從一個握點移動到另一個握點。區段 ($i_1, j_1$) 和 ($i_2, j_2$) 之間的距離由以下公式給出：$\\sqrt{(i_1 - i_2) ^ 2 + (j_1 - j_2) ^ 2}$。\n計算不同有效路徑的數量。如果兩條路徑在使用的握點列表或這些握點的訪問順序上有所不同，則這兩條路徑被視為不同。",
    "Statement Images": [],
    "Constraints": "Time limit: 5 s\nMemory limit: 512 mb",
    "IO Styles": "輸入\n每個測試包含多個測試案例。第一行包含測試案例的數量 $t$ ($1 ≤ t ≤ 10^3$)。接下來是測試案例的描述。\n每個測試案例的第一行包含三個整數 $n$, $m$, $d$ ($2 ≤ n ≤ 2000$, $1 ≤ m, d ≤ 2000$)。\n接下來的 $n$ 行中，每行包含 $m$ 個字符——對應山脈層級的描述。符號 '#' 代表空白區域，符號 'X' 代表有把手的區域。層級的描述是從上到下。\n保證所有測試案例中 $n \\cdot m$ 的總和不超過 $4 \\cdot 10^6$。\n輸出\n對於每個測試案例，輸出不同路徑的數量，取模 $998244353$。",
    "Sample Detail": [
        {
            "input": "3\n3 4 1\nXX#X\n#XX#\n#X#X\n3 4 2\nXX#X\n#XX#\n#X#X\n3 1 3\nX\nX\n#",
            "output": "2\n60\n0",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "注意\n第一個案例中的可能路徑： ![image](1.png) \n在第二個例子中，伊戈爾的臂展變大了，因此他可以使用新的路徑，例如這條： ![image](2.png) \n在第三個例子中，底層沒有把手，因此沒有正確的路徑。",
    "Note Images": [
        "https://espresso.codeforces.com/690658303fd506886aca153e80ac4c6db61d7cb8.png",
        "https://espresso.codeforces.com/5fd7b97b8ba5036d98b5afe1eef30b846d9c67fd.png"
    ],
    "Language": "cn"
}