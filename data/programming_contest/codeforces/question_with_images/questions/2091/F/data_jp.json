{
    "Title": "Codeforces Round 1013 (Div. 3)",
    "Source": "codeforces",
    "Name": "Igor and Mountain",
    "Time Limit": "5 s",
    "Memory Limit": "512 mb",
    "Problem Statement": "ITキャンパス「NEIMARK」の訪問者は、優れたプログラマーであるだけでなく、身体的にも頑健な人々です！水泳をする人もいれば、ボート漕ぎをする人、さらにはロッククライミングをする人もいます！\nマスター・イーゴルは地元のロッククライミングコミュニティの著名な人物です。ある日、彼は山のハイキングに出かけ、一つのピークを登ることにしました。経験豊富なクライマーであるイーゴルは、整備されたトレイルに従うのではなく、自らの技術を利用して垂直に登ることを決めました。\nイーゴルは山の長方形の垂直断面を見つけ、それを$n$の水平レベルに心の中で分けました。次に、各レベルを垂直の仕切りを使って$m$のセグメントに分割しました。これらのセグメントを観察したところ、握りやすい突起（以下、ホールドと呼びます）がいくつか見つかりました。したがって、選択された山の部分は、ホールドが含まれるセルを持つ$n \\times m$の長方形として表すことができます。\n経験豊富なプログラマーであるイーゴルは、有効なルートの数を数えることにしました。ルートは、一連の異なるホールドとして定義されます。ルートが有効と見なされるためには、次の条件を満たす必要があります：- ルートの最初のホールドは、最も底のレベル（行$n$）に位置していること； - ルートの最後のホールドは、最も上のレベル（行$1$）に位置していること； - 各次のホールドは前のホールドよりも低くないこと； - 各レベルで少なくとも1つのホールドが使用されること（すなわち、長方形の各行において）； - 各レベルで最大2つのホールドが使用されること（イーゴルには2つの手しかないため）； - 現在のホールドから次のホールドに移動できるのは、対応するセグメントの中心間の距離がイーゴルの腕の長さを超えない場合です。\nイーゴルの腕の長さは$d$であり、対応するセグメントの中心間のユークリッド距離が$d$を超えない場合に、あるホールドから別のホールドに移動できることを意味します。セクション($i_1, j_1$)と($i_2, j_2$)間の距離は、$\\sqrt{(i_1 - i_2) ^ 2 + (j_1 - j_2) ^ 2}$で与えられます。\n異なる有効なルートの数を計算してください。2つのルートは、使用されるホールドのリストや、これらのホールドが訪れる順序が異なる場合に異なると見なされます。",
    "Statement Images": [],
    "Constraints": "Time limit: 5 s\nMemory limit: 512 mb",
    "IO Styles": "入力\n各テストケースには複数のテストケースが含まれています。最初の行にはテストケースの数 $t$ ($1 ≤ t ≤ 10^3$) が含まれています。テストケースの説明が続きます。\n各テストケースの最初の行には3つの整数 $n$, $m$, $d$ ($2 ≤ n ≤ 2000$, $1 ≤ m, d ≤ 2000$) が含まれています。\nその後の $n$ 行には $m$ 文字が含まれ、対応する山のレベルの説明が行われます。記号 '#' は空のセクションを、記号 'X' はホールドがあるセクションを表します。レベルは上から下へと説明されています。\nすべてのテストケースに対して、$n \\cdot m$ の合計が $4 \\cdot 10^6$ を超えないことが保証されています。\n出力\n各テストケースについて、異なるルートの数を $998244353$ で割った余りを出力してください。",
    "Sample Detail": [
        {
            "input": "3\n3 4 1\nXX#X\n#XX#\n#X#X\n3 4 2\nXX#X\n#XX#\n#X#X\n3 1 3\nX\nX\n#",
            "output": "2\n60\n0",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "注意\n最初のケースでの可能なルート:  ![image](1.png) \n2番目の例では、イーゴルの腕の幅が大きくなったため、新たなルートが利用可能になっています。例えば、こちらのルート:  ![image](2.png) \n3番目の例では、下のレベルにホールドがないため、正しいルートはありません。",
    "Note Images": [
        "https://espresso.codeforces.com/690658303fd506886aca153e80ac4c6db61d7cb8.png",
        "https://espresso.codeforces.com/5fd7b97b8ba5036d98b5afe1eef30b846d9c67fd.png"
    ],
    "Language": "jp"
}