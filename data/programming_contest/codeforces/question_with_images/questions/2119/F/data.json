{
    "Title": "Codeforces Round 1035 (Div. 2)",
    "Source": "codeforces",
    "Name": "Volcanic Eruptions",
    "Time Limit": "3 s",
    "Memory Limit": "256 mb",
    "Problem Statement": "There is an undirected tree with root $1$ where each vertex has a weight $w_i\\in\\{1,-1\\}$.\nA volcano at the root erupts at time $0$. At time $t$, lava floods all vertices whose distance from the root is at most $t$, where the distance is the number of edges in the shortest path between the two vertices.\nAt time $0$, you are at vertex $st$ with life value $S$, initially $S=1$. Starting at time $0$ (including time $0$), the following events happen in order at each time stamp:  - Let $u$ be the vertex you are currently at. Your life value increases by $w_u$, i.e., $S≥ts S+w_u$. - If $S=0$ or if vertex $u$ is flooded with lava at this time, you die immediately. - You must move to an adjacent vertex (includes father and sons; staying in place is not allowed). You arrive at the chosen vertex at the next time stamp. \nFind the maximum number of moves you can make before you die.",
    "Statement Images": [],
    "Constraints": "Time limit: 3 s\nMemory limit: 256 mb",
    "IO Styles": "Input\nEach test contains multiple test cases. The first line contains the number of test cases $T$ ($1 ≤ T ≤ 10^4$). The description of the test cases follows. \nFor each test case, the first line contains two integers $n,st$ ($2 ≤ st ≤ n ≤ 5\\cdot 10^5$), denoting the number of vertices and the vertex you start at at time stamp $0$.\nThe second line contains $n$ integers $w_1, w_2, ..., w_n$ ($w_i\\in\\{1,-1\\}$,$w_{st}=1$), where $w_i$ represents the weight of the vertex $i$.\nThe next $n-1$ lines each contain two integers $u,v$ ($1≤ u,v ≤ n$), which describe a pair of vertices connected by an edge.\nIt is guaranteed that the given graph is a tree and the sum of $n$ over all test cases does not exceed $10^6$.\nOutput\nFor each test case, output a line with an integer indicating the maximum number of moves you can make.",
    "Sample Detail": [
        {
            "input": "6\n7 4\n-1 -1 -1 1 1 1 -1\n2 1\n3 2\n4 3\n5 4\n6 5\n7 6\n8 2\n-1 1 1 1 1 -1 1 1\n2 1\n6 2\n8 6\n3 8\n7 3\n5 7\n4 5\n8 2\n-1 1 -1 -1 -1 1 -1 -1\n2 1\n8 2\n4 1\n5 4\n3 4\n7 2\n6 8\n8 4\n1 1 1 1 1 -1 1 -1\n8 1\n3 1\n4 3\n5 4\n6 4\n7 6\n2 5\n8 4\n1 1 1 1 -1 -1 1 1\n2 1\n5 1\n4 5\n8 5\n3 8\n7 2\n6 2\n18 10\n-1 -1 -1 -1 -1 -1 -1 -1 -1 1 -1 1 1 -1 1 1 1 1\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n9 10\n10 11\n11 12\n12 13\n9 14\n14 15\n15 16\n16 17\n17 18",
            "output": "6\n7\n3\n3\n1\n13",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "Note\nHere is a picture that shows the tree in the first test case. ![image](1.png) The first test case. \nOne of the optimal sequence of moves is $4\\to3\\to4\\to5\\to6\\to7\\to6$, which makes $6$ moves in total. The changes in $S$ is $2\\to1\\to2\\to3\\to4\\to3\\to4$. More precisely: - At time $0$, the life value $S$ becomes $2$ and we move from vertex $4$ to vertex $3$. - At time $1$, the life value $S$ becomes $1$ and we move from vertex $3$ to vertex $4$. - At time $2$, the life value $S$ becomes $2$ and we move from vertex $4$ to vertex $5$. - At time $3$, the life value $S$ becomes $3$ and we move from vertex $5$ to vertex $6$. - At time $4$, the life value $S$ becomes $4$ and we move from vertex $6$ to vertex $7$. - At time $5$, the life value $S$ becomes $3$. The distance from vertex $7$ to the root is $6$, which means vertex $7$ is not flooded by lava yet. We move from vertex $7$ to vertex $6$. - At time $6$, the life value $S$ becomes $4$, but the distance from vertex $6$ to the root is $5$, which means vertex $6$ is flooded with lava.",
    "Note Images": [
        "https://espresso.codeforces.com/8d0ad4dc59ccfdf46be697d0e6f4e30a45873a2a.png"
    ],
    "Language": "en"
}