{
    "Title": "Codeforces Round 1035 (Div. 2)",
    "Source": "codeforces",
    "Name": "Volcanic Eruptions",
    "Time Limit": "3 s",
    "Memory Limit": "256 mb",
    "Problem Statement": "無向木が根$1$を持ち、各頂点には重み$w_i\\in\\{1,-1\\}$があります。\n根である頂点で火山が時間$0$に噴火します。時間$t$には、根からの距離が$t$以下のすべての頂点が溶岩に浸水します。距離は、2つの頂点間の最短経路における辺の数です。\n時間$0$の時点で、あなたは頂点$st$にいて、ライフ値$S$は初めに$S=1$です。時間$0$（時間$0$を含む）から始まり、各タイムスタンプで次のイベントが順に発生します：\n- 現在いる頂点を$u$とします。あなたのライフ値は$w_u$だけ増加します。すなわち、$S \\geq ts S + w_u$です。\n- もし$S=0$になるか、またはこの時点で頂点$u$が溶岩に浸水している場合、あなたは即座に死にます。\n- 隣接する頂点に移動しなければなりません（父と子を含む；その場に留まることは許可されていません）。選択した頂点には次のタイムスタンプで到着します。\nあなたが死ぬ前に最大で何回移動できるかを求めてください。",
    "Statement Images": [],
    "Constraints": "Time limit: 3 s\nMemory limit: 256 mb",
    "IO Styles": "入力\n各テストには複数のテストケースが含まれています。最初の行にはテストケースの数 $T$ ($1 ≤ T ≤ 10^4$) が含まれています。テストケースの説明が続きます。\n各テストケースの最初の行には、2つの整数 $n, st$ ($2 ≤ st ≤ n ≤ 5\\cdot 10^5$) が含まれ、$n$ は頂点の数、$st$ はタイムスタンプ $0$ で開始する頂点を示します。\n2行目には $n$ 個の整数 $w_1, w_2, ..., w_n$ ($w_i\\in\\{1,-1\\}$, $w_{st}=1$) が含まれ、$w_i$ は頂点 $i$ の重みを表します。\n次の $n-1$ 行にはそれぞれ2つの整数 $u,v$ ($1≤ u,v ≤ n$) が含まれ、エッジで接続された頂点のペアを示します。\n与えられたグラフが木であることが保証されており、すべてのテストケースにおける $n$ の合計は $10^6$ を超えません。\n出力\n各テストケースについて、移動できる最大の回数を示す整数を1行で出力してください。",
    "Sample Detail": [
        {
            "input": "6\n7 4\n-1 -1 -1 1 1 1 -1\n2 1\n3 2\n4 3\n5 4\n6 5\n7 6\n8 2\n-1 1 1 1 1 -1 1 1\n2 1\n6 2\n8 6\n3 8\n7 3\n5 7\n4 5\n8 2\n-1 1 -1 -1 -1 1 -1 -1\n2 1\n8 2\n4 1\n5 4\n3 4\n7 2\n6 8\n8 4\n1 1 1 1 1 -1 1 -1\n8 1\n3 1\n4 3\n5 4\n6 4\n7 6\n2 5\n8 4\n1 1 1 1 -1 -1 1 1\n2 1\n5 1\n4 5\n8 5\n3 8\n7 2\n6 2\n18 10\n-1 -1 -1 -1 -1 -1 -1 -1 -1 1 -1 1 1 -1 1 1 1 1\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n9 10\n10 11\n11 12\n12 13\n9 14\n14 15\n15 16\n16 17\n17 18",
            "output": "6\n7\n3\n3\n1\n13",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "注意\nこちらは最初のテストケースにおける木の図です。 ![image](1.png) 最初のテストケース。\n最適な移動の一つの順序は $4\\to3\\to4\\to5\\to6\\to7\\to6$ で、合計 $6$ 回の移動を行います。$S$ の変化は $2\\to1\\to2\\to3\\to4\\to3\\to4$ です。より正確には：\n- 時間 $0$ では、ライフ値 $S$ は $2$ になり、頂点 $4$ から頂点 $3$ へ移動します。\n- 時間 $1$ では、ライフ値 $S$ は $1$ になり、頂点 $3$ から頂点 $4$ へ移動します。\n- 時間 $2$ では、ライフ値 $S$ は $2$ になり、頂点 $4$ から頂点 $5$ へ移動します。\n- 時間 $3$ では、ライフ値 $S$ は $3$ になり、頂点 $5$ から頂点 $6$ へ移動します。\n- 時間 $4$ では、ライフ値 $S$ は $4$ になり、頂点 $6$ から頂点 $7$ へ移動します。\n- 時間 $5$ では、ライフ値 $S$ は $3$ になります。頂点 $7$ から根までの距離は $6$ であり、これは頂点 $7$ がまだ溶岩に浸されていないことを意味します。頂点 $7$ から頂点 $6$ へ移動します。\n- 時間 $6$ では、ライフ値 $S$ は $4$ になりますが、頂点 $6$ から根までの距離は $5$ であり、これは頂点 $6$ が溶岩に浸されていることを意味します。",
    "Note Images": [
        "https://espresso.codeforces.com/8d0ad4dc59ccfdf46be697d0e6f4e30a45873a2a.png"
    ],
    "Language": "jp"
}