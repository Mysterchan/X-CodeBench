{
    "Title": "Codeforces Round 1007 (Div. 2)",
    "Source": "codeforces",
    "Name": "LeaFall",
    "Time Limit": "3 s",
    "Memory Limit": "512 mb",
    "Problem Statement": "与えられた$n$頂点の木$^{\\text{∗}}$があります。時間が経つにつれて、各頂点$i$（$1 ≤ i ≤ n$）は$\\frac{p_i}{q_i}$の確率で倒れます。結果としてできる森$^{\\text{§}}$において葉$^{\\text{‡}}$になる異なる頂点の順序なしの対$^{\\text{†}}$の数の期待値を$998\\,244\\,353$で割った余りを求めてください。\n頂点$v$が倒れると、$v$に接続されているすべての辺とともに$v$が削除されます。ただし、隣接する頂点は$v$の倒れによって影響を受けません。\n$^{\\text{∗}}$木はサイクルのない連結グラフです。  \n$^{\\text{†}}$順序なしの対は、要素が出現する順序が重要でない二つの要素の集合です。例えば、順序なしの対$(1, 2)$は$(2, 1)$と同じと見なされます。  \n$^{\\text{‡}}$葉は、ちょうど1つの辺に接続されている頂点です。  \n$^{\\text{§}}$森はサイクルのないグラフです。",
    "Statement Images": [],
    "Constraints": "Time limit: 3 s\nMemory limit: 512 mb",
    "IO Styles": "入力\n各テストには複数のテストケースが含まれています。最初の行にはテストケースの数 $t$ （$1 ≤ t ≤ 10^4$）が含まれています。テストケースの説明が続きます。\n各テストケースの最初の行には、単一の整数 $n$ （$1 ≤ n ≤ 10^5$）が含まれています。\n次の $n$ 行の $i$ 番目の行には、2つの整数 $p_i$ および $q_i$ （$1 ≤ p_i < q_i < 998\\,244\\,353$）が含まれています。\nその後の $n - 1$ 行には、2つの整数 $u$ および $v$ （$1 ≤ u, v ≤ n$, $u \\neq v$）が含まれており、これは辺で結ばれた頂点のインデックスです。\n与えられた辺は木を形成することが保証されています。\nすべてのテストケースに対する $n$ の合計は $10^5$ を超えないことが保証されています。\n出力\n各テストケースについて、結果の森で葉となる異なる頂点の順序なしのペアの数の期待値を、$998\\,244\\,353$ での剰余として出力してください。\n形式的には、$M = 998\\,244\\,353$ とします。正確な答えは、整数 $p$ と $q$ の irreducible fraction $\\frac{p}{q}$ で表せることが示されています。ただし、$q \\not \\equiv 0 \\pmod{M}$ です。出力は、$p \\cdot q^{-1} \\bmod M$ と等しい整数を出力してください。言い換えれば、$0 ≤ x < M$ であり、$x \\cdot q \\equiv p \\pmod{M}$ となるような整数 $x$ を出力します。",
    "Sample Detail": [
        {
            "input": "5\n1\n1 2\n3\n1 2\n1 2\n1 2\n1 2\n2 3\n3\n1 3\n1 5\n1 3\n1 2\n2 3\n1\n998244351 998244352\n6\n10 17\n7 13\n6 11\n2 10\n10 19\n5 13\n4 3\n3 6\n1 4\n3 5\n3 2",
            "output": "0\n623902721\n244015287\n0\n799215919",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "注意\n最初のテストケースでは、木に1つの頂点があり、それは葉ではないため、答えは $0$ です。\n2番目のテストケースでは、以下に木が示されています。 ![image](1.png) \n落ちていない頂点は太字で表示されています。次の3つのケースを調べてみましょう: ![image](2.png) この構成に到達する確率は $≤ft( \\frac{1}{2} \\right) ^3$ であり、ただ1つの順不同の異なる葉頂点の組は $(2, 3)$ です。 ![image](3.png) この構成に到達する確率は $≤ft( \\frac{1}{2} \\right) ^3$ であり、ただ1つの順不同の異なる葉頂点の組は $(2, 1)$ です。 ![image](4.png) この構成に到達する確率は $≤ft( \\frac{1}{2} \\right) ^3$ であり、ただ1つの順不同の異なる葉頂点の組は $(1, 3)$ です。 \n残りのすべてのケースには、順不同の異なる葉頂点の組が含まれていません。したがって、答えは $\\frac{1 + 1 + 1}{8} = \\frac{3}{8}$ であり、これは $998\\,244\\,353$ での剰余 $623\\,902\\,721$ と等しいです。",
    "Note Images": [
        "https://espresso.codeforces.com/218d5395c3eda2e155307f3e22e7428b9a96e6ff.png",
        "https://espresso.codeforces.com/6cfe17a3ff2a57778dfab93b3e9a98240502f199.png",
        "https://espresso.codeforces.com/a22759c32eac92fed3e06de6d3dae7fba635c199.png",
        "https://espresso.codeforces.com/482e22b5149724d44e3ecc17a70ff253edaec105.png"
    ],
    "Language": "jp"
}