{
    "Title": "Codeforces Round 1007 (Div. 2)",
    "Source": "codeforces",
    "Name": "LeaFall",
    "Time Limit": "3 s",
    "Memory Limit": "512 mb",
    "Problem Statement": "你給了一棵有$n$個頂點的樹$^{\\text{∗}}$。隨著時間的推移，每個頂點$i$（$1 ≤ i ≤ n$）有$\\frac{p_i}{q_i}$的概率會倒下。請計算在隨後形成的森林$^{\\text{§}}$中，成為葉子$^{\\text{‡}}$的不同頂點的無序對$^{\\text{†}}$的期望值，並對$998\\,244\\,353$取模。\n請注意，當頂點$v$倒下時，它會與所有連接到它的邊一起被移除。然而，鄰接的頂點不會受$v$倒下的影響。\n$^{\\text{∗}}$樹是一種無環連通圖。\n$^{\\text{†}}$無序對是一組兩個元素的集合，其中元素出現的順序不重要。例如，無序對$(1, 2)$與$(2, 1)$被認為是相同的。\n$^{\\text{‡}}$葉子是只與一條邊相連的頂點。\n$^{\\text{§}}$森林是一種無環圖。",
    "Statement Images": [],
    "Constraints": "時間限制：3 秒  \n記憶體限制：512 MB",
    "IO Styles": "輸入\n每個測試包含多個測試案例。第一行包含測試案例的數量 $t$ ($1 ≤ t ≤ 10^4$)。接下來是測試案例的描述。\n每個測試案例的第一行包含一個整數 $n$ ($1 ≤ n ≤ 10^5$)。\n接下來的 $n$ 行中，第 $i$ 行包含兩個整數 $p_i$ 和 $q_i$ ($1 ≤ p_i < q_i < 998\\,244\\,353$)。\n接下來的 $n - 1$ 行中，每行包含兩個整數 $u$ 和 $v$ ($1 ≤ u, v ≤ n$, $u \\neq v$) — 連接邊的頂點索引。\n保證給定的邊形成一棵樹。\n保證所有測試案例的 $n$ 之和不超過 $10^5$。 \n輸出\n對於每個測試案例，輸出一個整數 — 在得出的森林中，成為葉子的不同頂點無序對的期望值，模 $998\\,244\\,353$。\n形式上，設 $M = 998\\,244\\,353$。可以證明，精確的答案可以表示為一個不可約分數 $\\frac{p}{q}$，其中 $p$ 和 $q$ 是整數且 $q \\not \\equiv 0 \\pmod{M}$。輸出與 $p \\cdot q^{-1} \\bmod M$ 相等的整數。換句話說，輸出滿足 $0 ≤ x < M$ 且 $x \\cdot q \\equiv p \\pmod{M}$ 的整數 $x$。",
    "Sample Detail": [
        {
            "input": "5\n1\n1 2\n3\n1 2\n1 2\n1 2\n1 2\n2 3\n3\n1 3\n1 5\n1 3\n1 2\n2 3\n1\n998244351 998244352\n6\n10 17\n7 13\n6 11\n2 10\n10 19\n5 13\n4 3\n3 6\n1 4\n3 5\n3 2",
            "output": "0\n623902721\n244015287\n0\n799215919",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "註\n在第一個測試案例中，樹中只有一個頂點，這不是葉子，因此答案是 $0$。 \n在第二個測試案例中，樹如下所示。 ![image](1.png) \n尚未掉落的頂點以粗體表示。讓我們研究以下三種情況： ![image](2.png) 我們以概率 $≤ft( \\frac{1}{2} \\right) ^3$ 得到此配置，唯一的無序不同葉子頂點對是 $(2, 3)$。 ![image](3.png) 我們以概率 $≤ft( \\frac{1}{2} \\right) ^3$ 得到此配置，唯一的無序不同葉子頂點對是 $(2, 1)$。 ![image](4.png) 我們以概率 $≤ft( \\frac{1}{2} \\right) ^3$ 得到此配置，唯一的無序不同葉子頂點對是 $(1, 3)$。 \n所有剩餘的情況都不包含無序不同的葉子頂點對。因此，答案是 $\\frac{1 + 1 + 1}{8} = \\frac{3}{8}$，這等於 $623\\,902\\,721$ 模 $998\\,244\\,353$。",
    "Note Images": [
        "https://espresso.codeforces.com/218d5395c3eda2e155307f3e22e7428b9a96e6ff.png",
        "https://espresso.codeforces.com/6cfe17a3ff2a57778dfab93b3e9a98240502f199.png",
        "https://espresso.codeforces.com/a22759c32eac92fed3e06de6d3dae7fba635c199.png",
        "https://espresso.codeforces.com/482e22b5149724d44e3ecc17a70ff253edaec105.png"
    ],
    "Language": "cn"
}