{
    "Title": "Specific Tasks",
    "Source": "codeforces",
    "Name": "E",
    "Time Limit": "unknown",
    "Memory Limit": "unknown",
    "Problem Statement": "Вам дано дерево$^{\\text{∗}}$ с $n$ вершинами. Каждая вершина $i$ ($1 ≤ i ≤ n$) имеет вероятность $\\frac{p_i}{q_i}$ упасть. Определите математическое ожидание количества неупорядоченных пар$^{\\text{†}}$ различных вершин, которые станут листьями$^{\\text{‡}}$ в полученном лесу$^{\\text{§}}$, по модулю $998\\,244\\,353$.\nОбратите внимание, что когда вершина $v$ падает, она удаляется вместе со всеми ребрами, соединенными с ней. Однако соседние вершины остаются неизменными после падения $v$.\n$^{\\text{∗}}$Деревом называется связный граф без циклов. \n$^{\\text{†}}$Неупорядоченная пара — это коллекция из двух элементов, где порядок, в котором элементы появляются, не имеет значения. Например, неупорядоченная пара $(1, 2)$ считается такой же, как $(2, 1)$.\n$^{\\text{‡}}$Лист — это вершина, соединенная ровно с одним ребром.\n$^{\\text{§}}$Лес — это граф без циклов",
    "Statement Images": [],
    "Constraints": "Time limit: unknown\nMemory limit: unknown",
    "IO Styles": "Входные данные\nКаждый тест состоит из нескольких наборов входных данных. В первой строке находится одно целое число $t$ ($1 ≤ t ≤ 10^4$) — количество наборов входных данных. Далее следует описание наборов входных данных. \nПервая строка каждого набора входных данных содержит одно целое число $n$ ($1 ≤ n ≤ 10^5$).\n$i$-я строка из следующих $n$ строк содержит два целых числа $p_i$ и $q_i$ ($1 ≤ p_i < q_i < 998\\,244\\,353$).\nКаждая из следующих $n - 1$ строк содержит два целых числа $u$ и $v$ ($1 ≤ u, v ≤ n$, $u \\neq v$) — индексы вершин, соединенных ребром.\nГарантируется, что заданные ребра образуют дерево.\nГарантируется, что сумма значений $n$ по всем наборам входных данных не превосходит $10^5$. \nВыходные данные\nДля каждого набора входных данных выведите одно целое число — ожидаемое значение количества неупорядоченных пар различных вершин, которые станут листьями в полученном лесу, по модулю $998\\,244\\,353$.\nФормально, пусть $M = 998\\,244\\,353$. Можно показать, что точный ответ может быть представлен в виде несократимой дроби $\\frac{p}{q}$, где $p$ и $q$ — целые числа, и $q \\not \\equiv 0 \\pmod{M}$. Выведите целое число, равное $p \\cdot q^{-1} \\bmod M$. Другими словами, выведите такое целое число $x$, что $0 ≤ x < M$ и $x \\cdot q \\equiv p \\pmod{M}$.",
    "Sample Detail": [
        {
            "input": "5\n1\n1 2\n3\n1 2\n1 2\n1 2\n1 2\n2 3\n3\n1 3\n1 5\n1 3\n1 2\n2 3\n1\n998244351 998244352\n6\n10 17\n7 13\n6 11\n2 10\n10 19\n5 13\n4 3\n3 6\n1 4\n3 5\n3 2",
            "output": "0\n623902721\n244015287\n0\n799215919",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "Примечание\nВ первом наборе входных данных в дереве только одна вершина, которая не является листом, поэтому ответ равен $0$.\nВо втором наборе входных данных дерево показано ниже. ![image](1.png) \nВершины, которые не упали, выделены жирным. Рассмотрим следующие три случая: ![image](2.png) Мы приходим к этой конфигурации с вероятностью $≤ft( \\frac{1}{2} \\right) ^3$, где единственной неупорядоченной парой различных листовых вершин является $(2, 3)$. ![image](3.png) Мы приходим к этой конфигурации с вероятностью $≤ft( \\frac{1}{2} \\right) ^3$, где единственной неупорядоченной парой различных листовых вершин является $(2, 1)$. ![image](4.png) Мы приходим к этой конфигурации с вероятностью $≤ft( \\frac{1}{2} \\right) ^3$, где единственной неупорядоченной парой различных листовых вершин является $(1, 3)$. \nВсе остальные случаи не содержат неупорядоченных пар различных листовых вершин. Следовательно, ответ равен $\\frac{1 + 1 + 1}{8} = \\frac{3}{8}$, что равно $623\\,902\\,721$ по модулю $998\\,244\\,353$.",
    "Note Images": [
        "https://espresso.codeforces.com/88da9982c2235c99d9ffcce691fcf261f6bfa4a5.png",
        "https://espresso.codeforces.com/9da948826ed89da482f751896a1b0981953df52d.png",
        "https://espresso.codeforces.com/888d27d6a4f1e486edd17132830ebd71583b2fb2.png",
        "https://espresso.codeforces.com/3b5b406c4476d76929d57e1007bc6981a06ee2ad.png"
    ],
    "Language": "ru"
}