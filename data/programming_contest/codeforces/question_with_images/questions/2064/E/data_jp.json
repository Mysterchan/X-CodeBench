{
    "Title": "Codeforces Round 1005 (Div. 2)",
    "Source": "codeforces",
    "Name": "Mycraft Sand Sort",
    "Time Limit": "3 s",
    "Memory Limit": "256 mb",
    "Problem Statement": "スティーブは長さ$n$の順列$^{\\text{∗}}$ $p$と配列$c$を持っています。スティーブは順列$p$をソートしたいと考えています。  \nスティーブは無限の量の色付き砂ブロックを持っており、それを使って「重力ソート」と呼ばれる数列をソートする物理ベースの方法を発見しました。すなわち、スティーブは$p$に対して重力ソートを行うために以下の操作を行います：  \n- $1 ≤ i ≤ n$を満たすすべての$i$について、位置$(i, j)$に対して、$1 ≤ j ≤ p_i$の全ての$j$に砂ブロックの色$c_i$を置きます。ここで位置$(x, y)$は上から$x$行目、左から$y$列目のセルを示します。  \n- 配列に下向きの重力を適用し、すべての砂ブロックができるだけ落ちるようにします。  \n![image](1.png) 第三のテストケースにおける重力ソートの例。$p = [4, 2, 3, 1, 5]$、$c = [2, 1, 4, 1, 5]$  \nアレックスはスティーブが重力ソートを行った後の砂ブロックを見て、どれだけの数の配列のペア$(p',c')$が同じ砂の配置をもたらすかを考えています。ここで、$p'$は順列であることに注意してください。元の配列のペア$(p, c)$は常にカウントされます。  \nアレックスのためにこれを計算してください。この数は大きくなる可能性があるため、$998\\,244\\,353$で割った余りを出力してください。  \n$^{\\text{∗}}$長さ$n$の順列は、$1$から$n$までの$n$個の異なる整数からなる任意の順序の配列です。例えば、$[2,3,1,5,4]$は順列ですが、$[1,2,2]$は順列ではありません（$2$が配列に2回現れています）、また$[1,3,4]$も順列ではありません（$n=3$ですが、配列に$4$が含まれています）。",
    "Statement Images": [
        "https://espresso.codeforces.com/bc9da7db75c1cd76ae4b448579a882a11a989364.png"
    ],
    "Constraints": "Time limit: 3 s\nMemory limit: 256 mb",
    "IO Styles": "入力\n最初の行には整数 $t$ ($1 ≤ t ≤ 10^4$) が含まれています ― テストケースの数。\n各テストケースの最初の行には整数 $n$ ($1 ≤ n ≤ 2 \\cdot 10^5$) が含まれています ― 配列の長さ。\n各テストケースの2行目には $n$ の異なる整数 $p_1,p_2,...,p_n$ ($1 ≤ p_i ≤ n$) が含まれています ― 配列 $p$ の要素。\n次の行には $n$ の整数 $c_1,c_2,...,c_n$ ($1 ≤ c_i ≤ n$) が含まれています ― 配列 $c$ の要素。\n全てのテストケースでの $n$ の合計は $2 \\cdot 10^5$ を超えません。\n出力\n各テストケースについて、Steve が最初に持っていた配列のペア $(p', c')$ の数を $998\\,244\\,353$ で割った余りとして出力せよ。",
    "Sample Detail": [
        {
            "input": "4\n1\n1\n1\n5\n5 3 4 1 2\n1 1 1 1 1\n5\n4 2 3 1 5\n2 1 4 1 5\n40\n29 15 20 35 37 31 27 1 32 36 38 25 22 8 16 7 3 28 11 12 23 4 14 9 39 13 10 30 6 2 24 17 19 5 34 18 33 26 40 21\n3 1 2 2 1 2 3 1 1 1 1 2 1 3 1 1 3 1 1 1 2 2 1 3 3 3 2 3 2 2 2 2 1 3 2 1 1 2 2 2",
            "output": "1\n120\n1\n143654893",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "注意\n第二のテストケースは以下に示されています。 ![image](2.png) 第二のテストケースの重力ソート。 \n$p$ の置換は同じ結果をもたらすことが示されるため、$c$ は $[1,1,1,1,1]$ に等しくなければならず（すべての砂は同じ色である必要があるため）、答えは $5! = 120$ です。\n第三のテストケースは上記の説明に示されています。他の配列 $p$ と $c$ が同じ最終結果を得ることはないことが証明できるため、答えは $1$ です。",
    "Note Images": [
        "https://espresso.codeforces.com/0be3e1a1e38f8485a0af76fd4cafe659e8413522.png"
    ],
    "Language": "jp"
}