{
    "Title": "Specific Tasks",
    "Source": "codeforces",
    "Name": "E",
    "Time Limit": "unknown",
    "Memory Limit": "unknown",
    "Problem Statement": "У Стива есть перестановка$^{\\text{∗}}$ $p$ и массив $c$, оба — длины $n$. Стив хочет отсортировать перестановку $p$.\nУ Стива есть бесконечное количество цветных песчаных блоков, и с их помощью он обнаружил способ сортировки массива чисел, основанный на физике, называемый гравитационной сортировкой. А именно, чтобы выполнить гравитационную сортировку на $p$, Стив будет делать следующее:  - Для всех $i$, таких что $1 ≤ i ≤ n$, поместить песчаный блок цвета $c_i$ в позицию $(i, j)$ для всех $j$, где $1 ≤ j ≤ p_i$. Здесь позиция $(x, y)$ обозначает ячейку в $x$-й строке сверху и $y$-й колонке слева. - Применить гравитацию вниз к массиву, так чтобы все песчаные блоки падали, пока они могут падать.  ![image](1.png) Пример гравитационной сортировки для третьего набора входных данных. $p = [4, 2, 3, 1, 5]$, $c = [2, 1, 4, 1, 5]$ \nАлекс смотрит на песчаные блоки Стива после выполнения гравитационной сортировки и задается вопросом, сколько пар массивов $(p',c')$, где $p'$ является перестановкой, привели бы к такому же расположению песка. Обратите внимание, что оригинальная пара массивов $(p, c)$ всегда будет учитываться.\nПожалуйста, помогите Алекс вычислить это. Поскольку это число может быть огромным, выведите его по модулю $998\\,244\\,353$.\n$^{\\text{∗}}$Перестановка длины $n$ — это массив, состоящий из $n$ различных целых чисел от $1$ до $n$ в произвольном порядке. Например, $[2,3,1,5,4]$ является перестановкой, но $[1,2,2]$ не является перестановкой (число $2$ встречается дважды в массиве), и $[1,3,4]$ также не является перестановкой ($n=3$, но в массиве есть $4$).",
    "Statement Images": [
        "https://espresso.codeforces.com/bc9da7db75c1cd76ae4b448579a882a11a989364.png"
    ],
    "Constraints": "Time limit: unknown\nMemory limit: unknown",
    "IO Styles": "Входные данные\nПервая строка содержит целое число $t$ ($1 ≤ t ≤ 10^4$) — количество наборов входных данных.\nПервая строка каждого набора входных данных содержит целое число $n$ ($1 ≤ n ≤ 2 \\cdot 10^5$) — длины массивов.\nВторая строка каждого набора входных данных содержит $n$ различных целых чисел $p_1,p_2,...,p_n$ ($1 ≤ p_i ≤ n$) — элементы перестановки $p$.\nСледующая строка содержит $n$ целых чисел $c_1,c_2,...,c_n$ ($1 ≤ c_i ≤ n$) — элементы $c$.\nСумма $n$ по всем наборам входных данных не превосходит $2 \\cdot 10^5$.\nВыходные данные\nДля каждого набора входных данных выведите количество пар массивов $(p', c')$, с которых Стив мог начать, по модулю $998\\,244\\,353$.",
    "Sample Detail": [
        {
            "input": "4\n1\n1\n1\n5\n5 3 4 1 2\n1 1 1 1 1\n5\n4 2 3 1 5\n2 1 4 1 5\n40\n29 15 20 35 37 31 27 1 32 36 38 25 22 8 16 7 3 28 11 12 23 4 14 9 39 13 10 30 6 2 24 17 19 5 34 18 33 26 40 21\n3 1 2 2 1 2 3 1 1 1 1 2 1 3 1 1 3 1 1 1 2 2 1 3 3 3 2 3 2 2 2 2 1 3 2 1 1 2 2 2",
            "output": "1\n120\n1\n143654893",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "Примечание\nВторой набор входных данных показан ниже. ![image](2.png) Гравитационная сортировка второго набора входных данных. \nМожно показать, что все перестановки $p$ дадут тот же результат, и что $c$ должно быть равно $[1,1,1,1,1]$ (так как весь песок должен быть одного цвета), поэтому ответ равен $5! = 120$.\nТретий набор входных данных показан в условии выше. Можно доказать, что другие массивы $p$ и $c$ не дадут такого же конечного результата, поэтому ответ равен $1$.",
    "Note Images": [
        "https://espresso.codeforces.com/0be3e1a1e38f8485a0af76fd4cafe659e8413522.png"
    ],
    "Language": "ru"
}