{
    "Title": "Codeforces Round 1005 (Div. 2)",
    "Source": "codeforces",
    "Name": "Mycraft Sand Sort",
    "Time Limit": "3 s",
    "Memory Limit": "256 mb",
    "Problem Statement": "史蒂夫有一個長度為 $n$ 的排列 $p^{\\text{∗}}$ 和一個數組 $c$。史蒂夫希望對排列 $p$ 進行排序。  \n史蒂夫擁有無限量的顏色沙塊，並且利用它們發現了一種基於物理的方法來對數字數組進行排序，稱為重力排序。具體來說，對於排列 $p$ 執行重力排序，史蒂夫將會進行以下操作：\n- 對於所有 $i$ 使得 $1 ≤ i ≤ n$，在位置 $(i, j)$ 放置顏色為 $c_i$ 的沙塊，對於所有 $j$ 使得 $1 ≤ j ≤ p_i$。這裡，位置 $(x, y)$ 表示從上方第 $x$ 行和從左側第 $y$ 列的單元格。\n- 對數組應用向下的重力，使所有沙塊都盡可能地下落。  \n ![image](1.png) 第三個測試用例的重力排序示例。$p = [4, 2, 3, 1, 5]$，$c = [2, 1, 4, 1, 5]$  \n亞歷克斯在執行重力排序後查看史蒂夫的沙塊，並想知道有多少對數組 $(p',c')$ 會導致相同的沙塊佈局，其中 $p'$ 是一個排列。注意，原始數組對 $(p, c)$ 將始終被計入。  \n請為亞歷克斯計算這個數字。由於這個數字可能很大，請對 $998\\,244\\,353$ 取模。  \n$^{\\text{∗}}$ 長度為 $n$ 的排列是一個由 $n$ 個獨特整數組成的數組，範圍從 $1$ 到 $n$，順序任意。例如，$[2,3,1,5,4]$ 是一個排列，但 $[1,2,2]$ 不是一個排列（$2$ 在數組中出現了兩次），而 $[1,3,4]$ 也不是一個排列（$n=3$ 但數組中有一個 $4$）。",
    "Statement Images": [
        "https://espresso.codeforces.com/bc9da7db75c1cd76ae4b448579a882a11a989364.png"
    ],
    "Constraints": "時間限制：3 秒  \n內存限制：256 MB",
    "IO Styles": "輸入\n第一行包含一個整數 $t$ （$1 ≤ t ≤ 10^4$）—— 測試案例的數量。\n每個測試案例的第一行包含一個整數 $n$ （$1 ≤ n ≤ 2 \\cdot 10^5$）—— 陣列的長度。\n每個測試案例的第二行包含 $n$ 個不同的整數 $p_1,p_2,...,p_n$ （$1 ≤ p_i ≤ n$）—— 陣列 $p$ 的元素。\n接下來的一行包含 $n$ 個整數 $c_1,c_2,...,c_n$ （$1 ≤ c_i ≤ n$）—— 陣列 $c$ 的元素。\n所有測試案例中 $n$ 的總和不超過 $2 \\cdot 10^5$。\n輸出\n對於每個測試案例，輸出 Steve 可能開始的陣列對 $(p', c')$ 的數量，結果以 $998\\,244\\,353$ 為模。",
    "Sample Detail": [
        {
            "input": "4\n1\n1\n1\n5\n5 3 4 1 2\n1 1 1 1 1\n5\n4 2 3 1 5\n2 1 4 1 5\n40\n29 15 20 35 37 31 27 1 32 36 38 25 22 8 16 7 3 28 11 12 23 4 14 9 39 13 10 30 6 2 24 17 19 5 34 18 33 26 40 21\n3 1 2 2 1 2 3 1 1 1 1 2 1 3 1 1 3 1 1 1 2 2 1 3 3 3 2 3 2 2 2 2 1 3 2 1 1 2 2 2",
            "output": "1\n120\n1\n143654893",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "注意\n第二個測試案例如下所示。 ![image](2.png) 第二個測試案例的重力排序。\n可以顯示出 $p$ 的排列會產生相同的結果，並且 $c$ 必須等於 $[1,1,1,1,1]$ （因為所有的沙子必須是相同顏色的），所以答案是 $5! = 120$。\n第三個測試案例在上述說明中顯示。可以證明沒有其他的數組 $p$ 和 $c$ 會產生相同的最終結果，因此答案是 $1$。",
    "Note Images": [
        "https://espresso.codeforces.com/0be3e1a1e38f8485a0af76fd4cafe659e8413522.png"
    ],
    "Language": "cn"
}