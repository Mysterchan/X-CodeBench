{
    "Title": "Specific Tasks",
    "Source": "codeforces",
    "Name": "E",
    "Time Limit": "unknown",
    "Memory Limit": "unknown",
    "Problem Statement": "Дано корневое дерево с $n+1$ вершинами, пронумерованными от $0$ до $n$, где корень — это вершина $0$, а его единственный ребенок — вершина $1$. Есть $m$ различных фишек, помеченных от $1$ до $m$, каждая из которых окрашена либо в черный, либо в белый цвет. Изначально они расположены на ребре $(0,1)$ сверху вниз в порядке возрастания номеров. ![image](1.png) Начальное положение фишек. Вершины дерева показаны синим. \nВы можете выполнять следующие операции любое количество раз (возможно, ноль) в любом порядке: - Выберите два ребра ($u,v$) и ($v,w$), такие что $u$ является родителем $v$, а $v$ является родителем $w$, где ребро ($u,v$) содержит хотя бы одну фишку. Переместите самую нижнюю фишку на ребре ($u,v$) в самый верх ребра ($v,w$), т.е. над всеми существующими фишками на ($v,w$). - Выберите два ребра ($u,v$) и ($v,w$), такие что $u$ является родителем $v$, а $v$ является родителем $w$, где ребро ($v,w$) содержит хотя бы одну фишку. Переместите самую верхнюю фишку на ребре ($v,w$) в самый низ ребра ($u,v$), т.е. под все фишки на ($u,v$). - Выберите две соседние фишки одного цвета на одном ребре и поменяйте их местами.  ![image](2.png) Разрешенные операции. \nКаждая фишка $i$ имеет диапазон движения, определяемый всеми ребрами на простом пути от корня до вершины $d_i$. Во время операций вы должны гарантировать, что ни одна фишка не перемещается на ребро вне своего диапазона движения.\nВ итоге вы должны вернуть все фишки обратно на ребро $(0,1)$. Порядок фишек может измениться. Вычислите количество достижимых перестановок фишек на ребре $(0,1)$ по модулю $998\\,244\\,353$.\nПерестановка фишек определяется как последовательность длины $m$, состоящая из номеров фишек в порядке сверху вниз.",
    "Statement Images": [
        "https://espresso.codeforces.com/f79beceda869b93708d99a9c5c675f8ce5e85bb0.png",
        "https://espresso.codeforces.com/a22e8f28ba353e1412a98f45d7ba447d6438a0ec.png"
    ],
    "Constraints": "Time limit: unknown\nMemory limit: unknown",
    "IO Styles": "Входные данные\nКаждый тест состоит из нескольких наборов входных данных. В первой строке находится одно целое число $t$ ($1 ≤ t ≤ 5000$) — количество наборов входных данных. Далее следует описание наборов входных данных. \nПервая строка каждого набора входных данных содержит два целых числа $n$ и $m$ ($1 ≤ n, m ≤ 5000$) — размер дерева минус один (т. е. дерево имеет $n+1$ вершину) и количество фишек.\nВторая строка содержит $n$ целых чисел $p_1, p_2, ..., p_n$ ($0 ≤ p_i < i$) — родительские вершины для вершин от $1$ до $n$. Гарантируется, что $p_i = 0$ тогда и только тогда, когда $i = 1$ (единственный ребенок корня — вершина $1$).\nТретья строка содержит $m$ целых чисел $c_1, c_2, ..., c_m$ ($c_i \\in \\{0, 1\\}$) — цвет каждой фишки ($0$ для черного, $1$ для белого).\nЧетвертая строка содержит $m$ целых чисел $d_1, d_2, ..., d_m$ ($1≤ d_i ≤ n$) — диапазон движения каждой фишки.\nГарантируется, что сумма $n$ не превышает $5000$, а сумма $m$ не превышает $5000$ по всем наборам входных данных.\nВыходные данные\nДля каждого набора входных данных выведите одно целое число — количество возможных перестановок по модулю $998\\,244\\,353$.",
    "Sample Detail": [
        {
            "input": "4\n3 2\n0 1 1\n0 1\n2 3\n4 4\n0 1 1 2\n0 0 1 1\n1 2 3 3\n6 6\n0 1 1 1 4 5\n0 0 0 0 1 1\n5 6 1 2 4 3\n16 15\n0 1 1 3 1 3 4 3 3 7 1 6 11 5 8 10\n1 0 1 1 0 1 1 1 1 0 1 1 0 0 0\n12 14 13 10 9 16 11 14 13 15 16 10 2 2 5",
            "output": "2\n8\n108\n328459046",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "Примечание\nВ первом наборе входных данных можно получить следующие $2$ перестановки: ($1,2$) и ($2,1$).\nВо втором наборе входных данных можно получить следующие $8$ перестановок: ($1,2,3,4$), ($1,2,4,3$), ($1,3,2,4$), ($1,3,4,2$), ($1,4,2,3$), ($1,4,3,2$), ($2,1,3,4$) и ($2,1,4,3$).",
    "Note Images": [],
    "Language": "ru"
}