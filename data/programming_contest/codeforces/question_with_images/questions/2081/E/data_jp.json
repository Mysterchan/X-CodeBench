{
    "Title": "Codeforces Round 1010 (Div. 1, Unrated)",
    "Source": "codeforces",
    "Name": "Quantifier",
    "Time Limit": "2.5 s",
    "Memory Limit": "1024 mb",
    "Problem Statement": "与えられたのは、$0$から$n$までのラベルが付けられた$n+1$ノードのルート付き木であり、ルートはノード$0$で、その唯一の子はノード$1$です。$1$から$m$までのラベルが付けられた$m$個の異なるチップがあり、それぞれは黒または白に色付けされています。最初に、それらはエッジ$(0,1)$上に上から下へラベルの昇順で配置されています。 ![image](1.png) チップの初期位置。木のノードは青で示されています。\n以下の操作を任意の回数（ゼロ回も可能）で、任意の順序で行うことができます：\n- 親子関係があるエッジ($u,v$)と($v,w$)を選択します。ここで、$u$は$v$の親であり、$v$は$w$の親であり、エッジ($u,v$)には少なくとも1つのチップが含まれています。エッジ($u,v$)の最も下にあるチップを、エッジ($v,w$)の最も上の位置に移動します。すなわち、($v,w$)上のすべての既存のチップの上に移動します。\n- エッジ($u,v$)と($v,w$)を選択します。ここで、$u$は$v$の親であり、$v$は$w$の親であり、エッジ($v,w$)には少なくとも1つのチップがあります。エッジ($v,w$)の最も上にあるチップを、エッジ($u,v$)の最も下の位置に移動します。すなわち、($u,v$)上のすべての既存のチップの下に移動します。\n- 同じエッジ上にある隣接する同じ色のチップを選択し、その位置を入れ替えます。 ![image](2.png) 許可された操作。\n各チップ$i$には移動範囲があり、これはルートからノード$d_i$までの単純なパス上のすべてのエッジとして定義されます。操作中は、いかなるチップもその移動範囲の外のエッジに移動されないようにする必要があります。\n最終的に、すべてのチップをエッジ$(0,1)$に戻さなければなりません。チップの順序は変わる可能性があることに注意してください。エッジ$(0,1)$での最終配置に対するチップの可能な順列の数を$998\\,244\\,353$で割った余りを計算してください。\nチップの順列は、上から下にチップのラベルで構成される長さ$m$のシーケンスとして定義されます。",
    "Statement Images": [
        "https://espresso.codeforces.com/f79beceda869b93708d99a9c5c675f8ce5e85bb0.png",
        "https://espresso.codeforces.com/a22e8f28ba353e1412a98f45d7ba447d6438a0ec.png"
    ],
    "Constraints": "Time limit: 2.5 s\nMemory limit: 1024 mb",
    "IO Styles": "入力\n各テストは複数のテストケースを含みます。最初の行にはテストケースの数 $t$ ($1 ≤ t ≤ 5000$) が含まれています。テストケースの説明が続きます。\n各テストケースの最初の行には2つの整数 $n$ と $m$ ($1 ≤ n, m ≤ 5000$) が含まれます。これは木のサイズから1を引いた値（すなわち、木には $n+1$ ノードがある）とチップの数です。\n2行目には $n$ 個の整数 $p_1, p_2, ..., p_n$ ($0 ≤ p_i < i$) が含まれます。これはノード1からノード$n$までの親ノードを表します。 $p_i = 0$ であるのは $i = 1$ のみであることが保証されています（根の唯一の子はノード1です）。\n3行目には $m$ 個の整数 $c_1, c_2, ..., c_m$ ($c_i \\in \\{0, 1\\}$) が含まれます。これは各チップの色を表し、$0$ が黒、$1$ が白です。\n4行目には $m$ 個の整数 $d_1, d_2, ..., d_m$ ($1≤ d_i ≤ n$) が含まれます。これは各チップの移動範囲を表します。\n全てのテストケースにおいて $n$ の合計は $5000$ を超えず、$m$ の合計も $5000$ を超えないことが保証されています。\n出力\n各テストケースごとに、チップの可能な順列の数を $998\\,244\\,353$ で割った余りとして出力してください。",
    "Sample Detail": [
        {
            "input": "4\n3 2\n0 1 1\n0 1\n2 3\n4 4\n0 1 1 2\n0 0 1 1\n1 2 3 3\n6 6\n0 1 1 1 4 5\n0 0 0 0 1 1\n5 6 1 2 4 3\n16 15\n0 1 1 3 1 3 4 3 3 7 1 6 11 5 8 10\n1 0 1 1 0 1 1 1 1 0 1 1 0 0 0\n12 14 13 10 9 16 11 14 13 15 16 10 2 2 5",
            "output": "2\n8\n108\n328459046",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "注意\n最初のテストケースでは、次の $2$ つの順列に到達できます: ($1,2$) と ($2,1$)。\n2 番目のテストケースでは、次の $8$ つの順列に到達できます: ($1,2,3,4$)、($1,2,4,3$)、($1,3,2,4$)、($1,3,4,2$)、($1,4,2,3$)、($1,4,3,2$)、($2,1,3,4$)、および ($2,1,4,3$)。",
    "Note Images": [],
    "Language": "jp"
}