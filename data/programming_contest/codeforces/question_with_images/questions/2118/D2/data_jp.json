{
    "Title": "Codeforces Round 1030 (Div. 2)",
    "Source": "codeforces",
    "Name": "Red Light, Green Light (Hard version)",
    "Time Limit": "4 s",
    "Memory Limit": "512 mb",
    "Problem Statement": "これは問題の難しいバージョンです。唯一の違いは、$k$ に対する制約と、すべてのテストケースにおける $n$ と $q$ の合計です。両方のバージョンの問題が解決された場合のみ、ハックを行うことができます。あなたは長さ $10^{15}$ のストリップと定数 $k$ が与えられます。正確に $n$ 個のセルに交通信号があり、それぞれの位置は $p_i$ で、初期遅延は $d_i$ であり、$d_i < k$ です。$i$ 番目の交通信号は以下のように動作します： \n- $l$ が整数の場合、$l \\cdot k + d_i$ 秒目に赤信号を表示し、\n- それ以外の時は緑信号を表示します。 \n秒数 $0$ の時点で、あなたはストリップ上の任意のセルに初期位置を持ち、正の方向を向いています。各秒ごとに、以下のアクションを順に実行します： \n- 現在のセルに赤信号がある場合、あなたは方向転換します。 \n- 現在向いている方向に1セル移動します。 \nあなたは $q$ 個の異なる初期位置が与えられています。それぞれに対して、$10^{100}$ 秒以内にストリップを離れることができるかどうかを判断してください。",
    "Statement Images": [],
    "Constraints": "Time limit: 4 s\nMemory limit: 512 mb",
    "IO Styles": "入力\n各テストには複数のテストケースがあります。最初の行にはテストケースの数 $t$ ($1 ≤ t ≤ 2\\cdot10^5$) が含まれています。テストケースの説明が続きます。\n各テストケースの最初の行には、2つの整数 $n$, $k$ ($\\mathbf{1 ≤ n ≤ 2\\cdot10^5}$ および $\\mathbf{1 ≤ k ≤ 10^{15}}$)  — 信号機の数と周期の長さが含まれています。\n各テストケースの第二行には $n$ 個の整数 $p_1, p_2, ... p_n$ ($1 ≤ p_1 < p_2 < ... < p_n ≤ 10^{15}$)  — 信号機の位置があります。\n第三行には各テストケースの $n$ 個の整数 $d_1, d_2, ... d_n$ ($0 ≤ d_i < k$)  — 信号機の遅延があります。\n第四行には1つの整数 $q$ ($\\mathbf{1 ≤ q ≤ 2\\cdot10^5}$)  — クエリの数があります。\n第五行には $q$ 個の整数 $a_1, a_2, ..., a_q$ ($1 ≤ a_i ≤ 10^{15}$)  — 開始位置があります。\n全てのテストケースにおいて、$n$ と $q$ の合計は $\\mathbf{2\\cdot10^5}$ を超えないことが保証されています。\n出力\n各テストケースに対して、$q$ 行を出力します。各行には、最終的にストリップを離れる場合は \"YES\" を、そうでない場合は \"NO\" を含めてください。回答はどのケースでも出力可能です（大文字または小文字）。例えば、\"yEs\"、\"yes\"、\"Yes\"、および \"YES\" の文字列は肯定的な応答として認識されます。",
    "Sample Detail": [
        {
            "input": "4\n2 2\n1 4\n1 0\n3\n1 2 3\n9 4\n1 2 3 4 5 6 7 8 9\n3 2 1 0 1 3 3 1 1\n5\n2 5 6 7 8\n4 2\n1 2 3 4\n0 0 0 0\n4\n1 2 3 4\n3 4\n1 2 3\n3 1 1\n3\n1 2 3",
            "output": "YES\nNO\nYES\nYES\nYES\nYES\nNO\nNO\nYES\nYES\nNO\nNO\nYES\nNO\nYES",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "注意\n最初のテストケースでは、開始位置 $1$, $2$, および $3$ で次のことが起こります:  ![image](1.png) \nそして、2番目のテストケースでは、開始位置 $2$ で次のことが起こります:  ![image](2.png)",
    "Note Images": [
        "https://espresso.codeforces.com/63db34c82cbed1e62971514d85a4a6bf71302a79.png",
        "https://espresso.codeforces.com/70971ec2952940a09246b1e55290386a0dec24a1.png"
    ],
    "Language": "jp"
}