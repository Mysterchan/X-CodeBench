{
    "Title": "Specific Tasks",
    "Source": "codeforces",
    "Name": "D2",
    "Time Limit": "unknown",
    "Memory Limit": "unknown",
    "Problem Statement": "Это сложная версия задачи. Отличие между версиями заключается в ограничении на $k$ и общую сумму $n$ и $q$ по всем наборам входных данных. Вы можете делать взломы только тогда, когда обе версии задачи решены.\nВам дан отрезок длиной $10^{15}$ и константа $k$. Существует ровно $n$ ячеек, которые содержат светофор; каждая имеет позицию $p_i$ и начальную задержку $d_i$, для которой $d_i < k$. $i$-й светофор работает следующим образом:  - он показывает красный свет на $l \\cdot k + d_i$-й секунде, где $l$ — целое число, - в противном случае он показывает зеленый свет. \nНа $0$ секунде вы изначально находитесь в какой-то ячейке на отрезке и смотрите в положительном направлении. Каждую секунду вы выполняете следующие действия по порядку:  - Если текущая ячейка содержит красный светофор, вы разворачиваетесь. - Вы перемещаетесь на одну ячейку в направлении, в котором вы сейчас смотрите. \nВам даны $q$ различных начальных позиций. Для каждой из них определите, покинете ли вы в конечном итоге отрезок в течение $10^{100}$ секунд.",
    "Statement Images": [],
    "Constraints": "Time limit: unknown\nMemory limit: unknown",
    "IO Styles": "Входные данные\nКаждый тест состоит из нескольких наборов входных данных. В первой строке находится одно целое число $t$ ($1 ≤ t ≤ 2\\cdot10^5$) — количество наборов входных данных. Далее следует описание наборов входных данных. \nПервая строка каждого набора входных данных содержит два целых числа $n$, $k$ ($\\mathbf{1 ≤ n ≤ 2\\cdot10^5}$ и $\\mathbf{1 ≤ k ≤ 10^{15}}$) — количество светофоров и длина периода.\nВторая строка каждого набора входных данных содержит $n$ целых чисел $p_1, p_2, ... p_n$ ($1 ≤ p_1 < p_2 < ... < p_n ≤ 10^{15}$) — позиции светофоров.\nТретья строка каждого набора входных данных содержит $n$ целых чисел $d_1, d_2, ... d_n$ ($0 ≤ d_i < k$) — задержки светофоров.\nЧетвёртая строка каждого набора входных данных содержит одно целое число $q$ ($\\mathbf{1 ≤ q ≤ 2\\cdot10^5}$) — количество запросов.\nПятая строка каждого набора входных данных содержит $q$ целых чисел $a_1, a_2, ..., a_q$ ($1 ≤ a_i ≤ 10^{15}$) — начальные позиции.\nГарантируется, что суммы $n$ и суммы $q$ по всем наборам входных данных не превосходят $\\mathbf{2\\cdot10^5}$.\nВыходные данные\nДля каждого набора входных данных выведите $q$ строк. Каждая строка должна содержать «YES», если вы в конечном итоге покинете отрезок, и «NO», если нет. Вы можете выводить каждую букву в любом регистре (строчную или заглавную). Например, строки «yEs», «yes», «Yes» и «YES» будут приняты как положительный ответ.",
    "Sample Detail": [
        {
            "input": "4\n2 2\n1 4\n1 0\n3\n1 2 3\n9 4\n1 2 3 4 5 6 7 8 9\n3 2 1 0 1 3 3 1 1\n5\n2 5 6 7 8\n4 2\n1 2 3 4\n0 0 0 0\n4\n1 2 3 4\n3 4\n1 2 3\n3 1 1\n3\n1 2 3",
            "output": "YES\nNO\nYES\nYES\nYES\nYES\nNO\nNO\nYES\nYES\nNO\nNO\nYES\nNO\nYES",
            "explanation": "",
            "images": []
        }
    ],
    "Notes": "Примечание\nВ первом наборе входных данных происходит следующее при начальных позициях $1$, $2$ и $3$:  ![image](1.png) \nА во втором наборе входных данных при начальной позиции $2$:  ![image](2.png)",
    "Note Images": [
        "https://espresso.codeforces.com/63db34c82cbed1e62971514d85a4a6bf71302a79.png",
        "https://espresso.codeforces.com/70971ec2952940a09246b1e55290386a0dec24a1.png"
    ],
    "Language": "ru"
}